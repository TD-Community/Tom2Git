Application Description: Tom2Git - Export TOM repository projects to GIT.
		
		GitHub:
		https://github.com/TD-Community/Tom2Git
		
		Version: 1.0.1
	Outline Version - 4.0.59
	Design-time Settings
.data DT_MAKERUNDLG
0000: 1800001000000000 FFFEFF132E005C00 5200650073006F00 7500720063006500
0020: 73005C0047006900 74002E0069006300 6F00FFFEFF0C5400 6F006D0054006F00
0040: 4700690074002E00 650078006500FFFE FF0F430068006500 63006B0073007500
0060: 6D006D0065007200 2E0064006C006C00 FFFEFF0F43006800 650063006B007300
0080: 75006D006D006500 72002E0061007000 6300000001010100 64000000FFFEFF00
00A0: FFFEFF00FFFEFF00 01000100010074E6 EB05FFFEFF0F4300 6800650063006B00
00C0: 730075006D006D00 650072002E006100 70006400FFFEFF0F 4300680065006300
00E0: 6B00730075006D00 6D00650072002E00 64006C006C00FFFE FF0F430068006500
0100: 63006B0073007500 6D006D0065007200 2E00610070006300 0000010101006400
0120: 0000FFFEFF0F4300 6800650063006B00 730075006D006D00 650072002E006100
0140: 70006C00FFFEFF0F 4300680065006300 6B00730075006D00 6D00650072002E00
0160: 64006C006C00FFFE FF0F430068006500 63006B0073007500 6D006D0065007200
0180: 2E00610070006300 0000010101006400 0000FFFEFF0F4300 6800650063006B00
01A0: 730075006D006D00 650072002E006500 78006500FFFEFF0F 4300680065006300
01C0: 6B00730075006D00 6D00650072002E00 64006C006C00FFFE FF0F430068006500
01E0: 63006B0073007500 6D006D0065007200 2E00610070006300 0000010101006400
0200: 0000FFFEFF0F4300 6800650063006B00 730075006D006D00 650072002E006400
0220: 6C006C00FFFEFF0F 4300680065006300 6B00730075006D00 6D00650072002E00
0240: 64006C006C00FFFE FF0F430068006500 63006B0073007500 6D006D0065007200
0260: 2E00610070006300 0000010101006400 0000FFFEFF0F4300 6800650063006B00
0280: 730075006D006D00 650072002E006400 6C006C00FFFEFF0F 4300680065006300
02A0: 6B00730075006D00 6D00650072002E00 64006C006C00FFFE FF0F430068006500
02C0: 63006B0073007500 6D006D0065007200 2E00610070006300 0000010101006400
02E0: 00000000000001FF FEFF0854006F006D 0054006F00470069 007400FFFEFF0B52
0300: 00610062006C0069 006E005100200049 0043005400FFFEFF 0531002E0030002E
0320: 003000FFFEFF0854 006F006D0054006F 00470069007400FF FEFF0C54006F006D
0340: 0054006F00470069 0074002E00650078 006500FFFEFF0531 002E0030002E0030
0360: 0000000000000000 00FFFEFF00FFFEFF 00FFFEFF1A450078 0070006F00720074
0380: 00200054004F004D 002000700072006F 006A006500630074 007300200074006F
03A0: 0020004700690074 0000000000000100 00000100000001FF FEFF000100000000
03C0: 000000FFFEFF0001 0000100000000000 0000000000000015 0015000000000001
03E0: 00000001000000FF FEFF00FFFEFF00FF FEFF00FFFEFF00FF FEFF00FFFEFF00FF
0400: FEFF00FFFEFF00FF FEFF000000000000 00000000000000FF FEFF000100000000
0420: 000000FFFEFF0000 000000FFFEFF0000 00FFFEFF00
.enddata
		Outline Window State: Normal
		Outline Window Location and Size
		Options Box Location
		Class Editor Location
		Tool Palette Location
		Fully Qualified External References? Yes
		Reject Multiple Window Instances? No
		Enable Runtime Checks Of External References? Yes
		Use Release 4.0 Scope Rules? No
		Edit Fields Read Only On Disable? No
		Assembly Symbol File:
	Libraries
		File Include: Callback.apl
		File Include: LibGit2TD.apl
		File Include: Microsoft ActiveX Data Objects 6.1 Library.apl
		File Include: TDAppTools.apl
		File Include: vtdos.apl
		File Include: vtfile.apl
		File Include: vttblwin.apl
		File Include: vtlbx.apl
		File Include: vtwin.apl
		File Include: vtarray.apl
	Global Declarations
		Window Defaults
			Tool Bar
				Display Style? Etched
				Font Name: Segoe UI
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Form Window
				Display Style? Etched
				Font Name: Segoe UI
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Dialog Box
				Display Style? Etched
				Font Name: Segoe UI
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Top Level Table Window
				Font Name: Segoe UI
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Top Level Grid Window
				Font Name: Segoe UI
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Data Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
				Flow Direction: Default
			Multiline Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
				Flow Direction: Default
			Spin Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Background Text
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
				Flow Direction: Default
			Pushbutton
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Radio Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
				Flow Direction: Default
			Check Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
				Flow Direction: Default
			Option Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Group Box
				GroupBox Style: Etched
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
				Line Color: Use Parent
				Flow Direction: Default
			Child Table Window
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			List Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
				Flow Direction: Default
			Combo Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
				Flow Direction: Default
			Line
				Line Color: Use Parent
			Frame
				Border Color: Use Parent
				Background Color: Use Parent
			Picture
				Border Color: Use Parent
				Background Color: Use Parent
			Date Time Picker
				Text Color: Use Parent
				Background Color: Use Parent
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Child Grid Window
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Rich Text Control
				Text Color: Use Parent
				Background Color: Use Parent
				Flow Direction: Default
			Date Picker
				Font Name: Use Parent
				Font Size: Use Parent
			Tree Control
				Font Name: Use Parent
				Font Size: Use Parent
				Flow Direction: Default
			Navigation Bar
				Text Color: Use Parent
				Background Color: Use Parent
				Flow Direction: Default
			Pane Separator
			Tab Bar
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Progress Bar
				Background Color: Use Parent
		Formats
			Number: 0'%'
			Number: #0
			Number: ###000
			Number: ###000;'($'###000')'
			Date/Time: hh:mm:ss AMPM
			Date/Time: M/d/yy
			Date/Time: MM-dd-yy
			Date/Time: dd-MMM-yyyy
			Date/Time: MMM d, yyyy
			Date/Time: MMM d, yyyy hh:mm AMPM
			Date/Time: MMMM d, yyyy hh:mm AMPM
			Date/Time: dd-MM-yy hhhh:mm:ss
			Date/Time: dd-MM-yyyy hhhh:mm:ss
			Date/Time: yyyy-MM-dd
			Date/Time: yyyy-MM-dd hh:mm:ss
			Date/Time: yyyy-MM-dd hhhh:mm:ss
			Input: 9999999999
		External Functions
			Library name: kernel32.dll
				ThreadSafe: No
				Function: GlobalFree
					Description:
					Export Ordinal: 0
					Returns
						Number: DWORD
					Parameters
						Number: DWORD
			Library name: user32.dll
				ThreadSafe: No
				Function: ScreenToClient
					Description:
					Export Ordinal: 0
					Returns
						Boolean: BOOL
					Parameters
						Window Handle: HWND
						structPointer
							Receive Number: LONG
							Receive Number: LONG
				Function: DisableProcessWindowsGhosting
					Description:
					Export Ordinal: 0
					Returns
					Parameters
			Library name: shell32.dll
				ThreadSafe: No
				Function: ShellExecuteA
					Description:
					Export Ordinal: 0
					Returns
						Number: HANDLE
					Parameters
						Window Handle: HWND
						String: LPCSTR
						String: LPCSTR
						String: LPCSTR
						String: LPCSTR
						Number: INT
				Function: SHBrowseForFolderA
					Description:
					Export Ordinal: 0
					Returns
						Number: LONG
					Parameters
						structPointer
							Window Handle: HWND
							Number: LPVOID
							Receive String: LPSTR
							String: LPSTR
							Number: UINT
							Number: LPVOID
							Number: LPARAM
							Receive Number: INT
				Function: SHGetPathFromIDListA
					Description:
					Export Ordinal: 0
					Returns
						Number: LONG
					Parameters
						Number: LPVOID
						Receive String: LPSTR
			Library name: shlwapi.dll
				ThreadSafe: No
				Function: StrFormatByteSizeW
					Description:
					Export Ordinal: 0
					Returns
						String: LPWSTR
					Parameters
						Number: LONGLONG
						Receive String: LPWSTR
						Number: UINT
				Function: PathAddBackslashW
					Description:
					Export Ordinal: 0
					Returns
						String: LPWSTR
					Parameters
						Receive String: LPWSTR
				Function: PathCompactPathExW
					Description:
					Export Ordinal: 0
					Returns
						Boolean: BOOL
					Parameters
						Receive String: LPWSTR
						String: LPCWSTR
						Number: UINT
						Number: DWORD
				Function: PathRemoveBackslashW
					Description:
					Export Ordinal: 0
					Returns
						Boolean: BOOL
					Parameters
						Receive String: LPWSTR
				Function: PathRemoveFileSpecW
					Description:
					Export Ordinal: 0
					Returns
						Boolean: BOOL
					Parameters
						Receive String: LPWSTR
			Library name: TmDfi75.dll
				ThreadSafe: No
				Function: DIF_Apply
					Description: Recreates a file based on the delta file and the master file.
							First param = full path to master file
							Second param = full path to delta file
							Third param = full path to target file (end result, new file)
					Export Ordinal: 0
					Returns
						Number: WORD
					Parameters
						String: LPWSTR
						String: LPWSTR
						String: LPWSTR
						Window Handle: HWND
						Number: WORD
		External Assemblies
		Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 0000000000000000 0000000000000000
0020: 0000000000000000
.enddata
.data CCSIZE
0000: 2800
.enddata
			System
				Number: SB_THUMBTRACK			= 5
				Number: WM_VSCROLL			= 0x0115
				Number: DBP_LONGBUFFER			= 5112
				Number: MAX_PATH			= 260
				Number: ES_PASSWORD			= 0x0020
				Number: BIF_NEWDIALOGSTYLE		= 0x0040
				Number: FILE_ATTRIBUTE_DIRECTORY	= 0x00000010
				Number: BFFM_SETSELECTION		= 0x400 + 102
				Number: BFFM_INITIALIZED			= 1
			User
				Number: ncTOM2GIT_DEST_MONO		= 0		! Export to one Git repo for all projects
				Number: ncTOM2GIT_DEST_POLY		= 1		! Export to multiple Git repos. One for each project
				!
				Number: ncTOM2GIT_ROOTMODE_CODE	= 0		! Use project code
				Number: ncTOM2GIT_ROOTMODE_NAME	= 1		! Use project name
				Number: ncTOM2GIT_ROOTMODE_CUSTOM	= 2		! Use custom name
				!
				Number: ncTOM2GIT_LOGMODE_FULL	= 0		! Full trace to log during exports
				Number: ncTOM2GIT_LOGMODE_ERRORS	= 1		! Only trace errors to log during exports
				!
				String: scTOM2GIT_VERSION		= "1.0.1"
				String: scREG_COMPANY		= "TDCommunity"
				String: scREG_APPLICATION		= "Tom2Git"
				String: scREG_KEY			= "Tom2Git"
				String: scINIFILE			= "Tom2Git.cfg"
				String: scNOTEMPLATE		= "- NO TEMPLATE -"
				!
				Number: ncINTERVAL_NONE	= 0
				Number: ncINTERVAL_SECONDS	= 1
				Number: ncINTERVAL_MINUTES	= 2
				Number: ncINTERVAL_HOURS	= 3
				Number: ncINTERVAL_DAYS		= 4
				Number: ncINTERVAL_WEEKS	= 5
				Number: ncINTERVAL_MONTHS	= 6
				Number: ncINTERVAL_YEARS	= 7
				!
				Number: PAM_Base		= SAM_User + 100
				Number: PAM_DisplayRevInfo	= PAM_Base + 1
				Number: PAM_ExtractRevision	= PAM_Base + 2
				Number: PAM_SetSnapshot	= PAM_Base + 3
				!
				String: scSPACE			= " "
				String: scTAB			= "	"
				String: scNEWLINE			= "
						"
				!
				Number: ncSIG_RESET_INIT		= 0
				Number: ncSIG_CODE2NAME		= 1
				Number: ncSIG_FORCE_EMAIL		= 2
				Number: ncSIG_CODE2EMAIL		= 3
				Number: ncSIG_NAME2EMAIL		= 4
			Enumerations
		Resources
		Variables
.data RESOURCE 0 0 1 1933526314
0000: 2200000022000000 0000000000000000 0000010000000C00 0000190000000001
0020: 4A10AD0000000000 6FEC489DC709F200 00000000
.enddata
			FunctionalVar: guGlobals
				Class: cfcTMGlobals
			FunctionalVar: guRepo
				Class: cfcTMRepository
		Internal Functions
			Function: PALStartupApplication
				Description: void PALStartupApplication( )
						Entry point for this application
						
						No Parameters
						No Return value
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					! Avoid the application GUI to ghost to appear it hangs. On time consuming actions Windows will normally ghost a non responding thread. The next call disables this
					Call DisableProcessWindowsGhosting(  )
					!
					Call SalCreateWindow( frmTom2Git, hWndNULL )
			Function: PALConvertBytesToStr
				Description:
				Returns
					String:
				Parameters
					Number: pnBytes
				Static Variables
				Local variables
					String: sBuf
				Actions
					Call SalStrSetBufferLength( sBuf, 512 )
					Call StrFormatByteSizeW( pnBytes, sBuf, 512 )
					Return sBuf
			Function: PALGetRuntimeDirectory
				Description:
				Returns
					String:
				Parameters
				Static Variables
				Local variables
					String: sDir
					String: sDummy
					String: sDrive
					String: sRuntimeDir
				Actions
					Call VisDosSplitPath( strArgArray[0], sDrive, sDir, sDummy, sDummy )
					Set sRuntimeDir = sDrive || sDir
					Call PALPathAddBackslash( sRuntimeDir )
					Return sRuntimeDir
			Function: PALGetTempDirectory
				Description: String PALGetTempDirectory( )
						Gets the Windows TEMP folder (incl trailing backslash)
						
						No Parameters
						
						Return value :
						String = TEMP folder
						
						Created by	Dave Rabelink       	25-06-2015
						Updated by
				Returns
					String:
				Parameters
				Static Variables
				Local variables
					String: sTempDir
				Actions
					Set sTempDir = VisDosGetEnvString( "TEMP" )
					If NOT sTempDir
						Set sTempDir = VisDosGetEnvString( "TMP" )
					If sTempDir
						! Always return backslash
						If SalStrRightX( sTempDir, 1 ) != "\\"
							Set sTempDir = sTempDir || "\\"
					Else
						! Fail over, take a folder
						Set sTempDir = "C:\\TEMP\\"
					Return sTempDir
			Function: PALGetDBBrandName
				Description:
				Returns
					String:
				Parameters
					Number: pnBrand
				Static Variables
				Local variables
				Actions
					Select Case pnBrand
						Case DBV_BRAND_ALLBASE
							Return "ALLBASE"
						Case DBV_BRAND_AS400
							Return "AS400"
						Case DBV_BRAND_CINCOMSUPRA
							Return "CINCOMSUPRA"
						Case DBV_BRAND_DB2
							Return "DB2"
						Case DBV_BRAND_EDASQL
							Return "EDASQL"
						Case DBV_BRAND_INFORMIX
							Return "INFORMIX"
						Case DBV_BRAND_INFORMIXONLINE
							Return "INFORMIXONLINE"
						Case DBV_BRAND_INGRES
							Return "INGRES"
						Case DBV_BRAND_MSSQL
							Return "MSSQL"
						Case DBV_BRAND_NETWARE
							Return "NETWARE"
						Case DBV_BRAND_NETWARESQL
							Return "NETWARESQL"
						Case DBV_BRAND_ODBC
							Return "ODBC"
						Case DBV_BRAND_OPENINGRES
							Return "OPENINGRES"
						Case DBV_BRAND_ORACLE
						Case DBV_BRAND_ORACLE7
						Case DBV_BRAND_ORACLE8
							Return "ORACLE"
						Case DBV_BRAND_OS2EE
							Return "OS2EE"
						Case DBV_BRAND_SQL
							Return "SQLBASE"
						Case DBV_BRAND_SYBASE
							Return "SYBASE"
						Case DBV_BRAND_SYSTEM10
							Return "SYSTEM10"
						Default
							Return "??"
			Function: PALNumberGetSignedInteger
				Description: Number PALNumberGetSignedInteger( nPUnsignedInteger )
						Converts a two's complement integer to a signed number.
						
						Parameter	Type	Description
						nPUnsignedInteger	Number	Two's complement integer
						
						Return value :
						Number = the signed number
				Returns
					Number:
				Parameters
					Number: nPUnsignedInteger
				Static Variables
				Local variables
				Actions
					If nPUnsignedInteger > 32767
						Set nPUnsignedInteger = nPUnsignedInteger - 65536
					Return nPUnsignedInteger
			Function: PALStrPrefix
				Description: String PALStrPrefix( psToPrefix, psPrefixCharacter, pnTotalLength )
						Creates a string having a fixed length which is pre-padded with a given character.
						This allows given string to be formatted in a fixed length having specifric characters filled up in front.
						The resulting string is always the given length even when the inpot string is larger.
						
						Example:
						
						Give string with length 10 having a dot pre-padded to "Hello":
						
						".....Hello"
						
						Parameter	Type	Description
						psToPrefix	String	String to be padded (prefix)
						psPrefixCharacter	String	The character to prefix
						pnTotalLength	Number	Total length of resulting string
						
						Return value :
						String = prefixed string
						
				Returns
					String:
				Parameters
					String: psToPrefix
					String: psPrefixCharacter
					Number: pnTotalLength
				Static Variables
				Local variables
					Number: nFieldLength
				Actions
					Set nFieldLength = SalStrLength( psToPrefix )
					!
					If nFieldLength < pnTotalLength
						Return SalStrRepeatX( SalStrLeftX( psPrefixCharacter, 1 ), pnTotalLength - nFieldLength ) || psToPrefix
					Else If nFieldLength = pnTotalLength
						Return psToPrefix
					Else
						! Length is larger than given so cut off the string
						Return SalStrLeftX( psToPrefix, pnTotalLength )
			Function: PALSqlGetDatabaseBrand
				Description: Number PALSqlGetDatabaseBrand( )
						Using the SQL connection handle, return the database brand.
						
						No Parameters
						
						Return value :
						Number = Database brand. See DBV_BRAND_* constants
						
				Returns
					Number:
				Parameters
				Static Variables
				Local variables
					String: sDummy
					Number: nBrand
				Actions
					If SqlGetParameter( guGlobals.GetSqlHandle(  ), DBP_BRAND, nBrand, sDummy )
						Return nBrand
					Else
						Return 0
			Function: PALSqlResetLongBuffer
				Description: void PALSqlResetLongBuffer( )
						Sets the longbuffer size to a fixed value
						
						No Parameters
						No Return value
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If PALSqlGetDatabaseBrand( ) != DBV_BRAND_SQL	! Do not reset when SQLBASE
						Call SqlSetParameterAll( guGlobals.GetSqlHandle( ), DBP_LONGBUFFER, 40000, "", TRUE )
					Call SqlClearLongBindDatatype( )
			Function: PALSqlSetLongBuffer
				Description: Boolean PALSqlSetLongBuffer( pnBufferSize )
						Sets the long buffer size to given value.
						
						Parameter	Type	Description
						pnBufferSize	Number	Buffer size
						
						Return value :
						Boolean = TRUE if the function was ok, FALSE otherwise
				Returns
					Boolean:
				Parameters
					Number: pnBufferSize
				Static Variables
				Local variables
					Number: nActualSize
					String: sDummy
				Actions
					If PALSqlGetDatabaseBrand( ) != DBV_BRAND_SQL		! Do not set longbuffer on SQLBASE
						If pnBufferSize > 30000
							Set pnBufferSize = pnBufferSize + 10000
						Else
							Set pnBufferSize = 40000
						If SqlSetParameterAll( guGlobals.GetSqlHandle( ), DBP_LONGBUFFER, pnBufferSize, "", TRUE )
							If SqlGetParameterAll( guGlobals.GetSqlHandle( ), DBP_LONGBUFFER, nActualSize, sDummy, TRUE )
								If nActualSize + 2 < pnBufferSize
									Return FALSE
								Else
									Return TRUE
						Return FALSE
					Else
						Return TRUE
			Function: PALPathAddBackslash
				Description: void PALPathAddBackslash( rpsPath )
						Adds a backslash to given path when it doesn't have one yet.
						
						Parameter		Type		Description
						rpsPath		Receive String	IN/OUT: Path
						
						No Return value
				Returns
				Parameters
					Receive String: rpsPath
				Static Variables
				Local variables
					String: sPath
				Actions
					Set sPath = rpsPath
					!
					Call SalStrSetBufferLength( sPath, MAX_PATH )	! The size of this buffer should be set to MAX_PATH to ensure that it is large enough to hold the returned string
					Call PathAddBackslashW( sPath )		! Call the WinApi function
					Set rpsPath = sPath
			Function: PALPathCompactPathEx
				Description: String PALPathCompactPathEx( psPath, pnMax )
						Returns a compacted visualisation string for the given path.
						This is used to display a long path where the total size to be displayed is forced to fit a certain amount of characters.
						When the path character length does not fit the given max length, this function will replace part of the path string with dots (...)
						
						Parameter	Type	Description
						psPath		String	Path to compact
						pnMax		Number	Max length of the resulting compacted path
						
						Return value :
						String = compacted path
				Returns
					String:
				Parameters
					String: psPath
					Number: pnMax
				Static Variables
				Local variables
					String: sPath
				Actions
					Call SalStrSetBufferLength( sPath, MAX_PATH )		! The size of this buffer should be set to MAX_PATH to ensure that it is large enough to hold the returned string
					Call PathCompactPathExW( sPath, psPath, pnMax, 0 )	! Call the WinApi function
					Return sPath
			Function: PALPathRemoveBackslash
				Description: void PALPathRemoveBackslash( rpsPath )
						Removes backslash from path
						
						Parameter		Type		Description
						rpsPath		Receive String	IN/OUT:
						
						No Return value
						
				Returns
				Parameters
					Receive String: rpsPath
				Static Variables
				Local variables
					String: sPath
				Actions
					Set sPath = rpsPath
					!
					Call SalStrSetBufferLength( sPath, MAX_PATH )	! The size of this buffer should be set to MAX_PATH to ensure that it is large enough to hold the returned string
					Call PathRemoveBackslashW( sPath )			! Here call WinAPI
					Set rpsPath = sPath
		Named Exceptions
		Named Toolbars
		Named Menus
		Class Definitions
.data RESOURCE 0 0 1 4262418261
0000: 2E010000E0000000 0000000000000000 0200000200FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F19003C00 00FFFE00FF0C6300
0040: 66006300004C0069 0062004700026974 0032005400004400 2200000001003C00
0060: 0019000500014A10 AD000C00006FEC08 9EC0C70905000000 0001807D00000001
0080: 001900FF0D630080 5200610064006938 6F004C7300227442 006F7800409A0000
00A0: 000500006F190079 014A00F36FECB006 0000001959001900 01DF003E6F07002C
00C0: 0000320000D61900 01B7006F0F080000 00834B00000019F5 0001ED006FC30900
00E0: 0000626400001900 7D0100FB6F300A00 0000
.enddata
			Functional Class: cfcTMGlobals
				Description: Global singleton class to hold general data and settings
				Derived From
				Class Variables
				Instance Variables
					FunctionalVar: uivSettings
						Class: cfcTMSettings
					Window Handle: hWndivStatusBar
					Window Handle: hWndivProgress
					Boolean: bivActionIsBusy
					Boolean: bivActionContinue
					Number: nivStatusTextPane
					Number: nivStatusTextPane2
					!
					Boolean: bivConnected		! TRUE when the application is connected to TOM database
					Sql Handle: hSqlivGlobal		! Holds connection handle
					Boolean: bivDryRun		! TRUE when the application is connected to TOM database
					File Handle: hFileivLog
				Constructor/Destructor
				Functions
					Function: Init
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Set bivConnected = FALSE
							Set bivActionIsBusy = FALSE
							Call uivSettings.Init(  )
					Function: Connect
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
						Actions
							If bivConnected AND hSqlivGlobal
								Return TRUE
							Set bivConnected = FALSE
							If SqlConnect( hSqlivGlobal )
								Set bivConnected = TRUE
							Return bivConnected
					Function: Disconnect
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							If bivConnected AND hSqlivGlobal
								Call SqlDisconnect( hSqlivGlobal )
								Set hSqlivGlobal = hWndNULL
								Set bivConnected = FALSE
					Function: GetSqlHandle
						Description:
						Returns
							Sql Handle:
						Parameters
						Static Variables
						Local variables
						Actions
							Return hSqlivGlobal
					Function: SetStatusTextSection
						Description:
						Returns
						Parameters
							String: psText
						Static Variables
						Local variables
						Actions
							If hWndivStatusBar
								! Call SalStatusSetText( hWndivStatusBar, psText )
								Call SalStatusSetPaneText( hWndivStatusBar, nivStatusTextPane, psText )
					Function: SetStatusTextDetail
						Description:
						Returns
						Parameters
							String: psText
						Static Variables
						Local variables
						Actions
							If hWndivStatusBar
								Call SalStatusSetPaneText( hWndivStatusBar, nivStatusTextPane2, psText )
					Function: SetStatusTextDetailPrefix
						Description:
						Returns
						Parameters
							String: psPrefix
							String: psText
						Static Variables
						Local variables
						Actions
							If hWndivStatusBar
								Call SalStatusSetPaneText( hWndivStatusBar, nivStatusTextPane2, "[" || psPrefix || "] " ||  psText )
					Function: SetStatusTextFinished
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Call SetStatusTextSection( "Finished" )
							Call SetStatusTextDetail( "" )
					Function: StepProgress
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Call SalMeterStepUp( hWndivProgress )
					Function: StartProgress
						Description:
						Returns
						Parameters
							Number: pnMaxSteps
						Static Variables
						Local variables
						Actions
							Call SalMeterSetRange( hWndivProgress, 0, pnMaxSteps )
							Call SalMeterSetStepSize( hWndivProgress, 1 )
							Call SalMeterShowPercent( hWndivProgress, TRUE )
					Function: StopProgress
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Call SalMeterShowPercent( hWndivProgress, FALSE )
							Call SalMeterSetStepSize( hWndivProgress, 1 )
							Call SalMeterSetRange( hWndivProgress, 0, 1 )
							Call SalMeterStepDown( hWndivProgress )
					Function: DoContinue
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
						Actions
							If bivActionIsBusy
								Return bivActionContinue
							Else
								Return TRUE
					Function: StartAction
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Set bivActionIsBusy = TRUE
							Set bivActionContinue = TRUE
					Function: StopAction
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Set bivActionIsBusy = FALSE
							Set bivActionContinue = FALSE
					Function: ActionIsOngoing
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
						Actions
							Return bivActionIsBusy
					Function: CancelAction
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Set bivActionContinue = FALSE
					Function: GetWorkFolder
						Description:
						Returns
							String:
						Parameters
						Static Variables
						Local variables
						Actions
							Return uivSettings.GetWorkFolder( )
					Function: GetTemplatesFolder
						Description:
						Returns
							String:
						Parameters
						Static Variables
						Local variables
						Actions
							Return PALGetRuntimeDirectory(  ) || "TEMPLATES\\"
					Function: SetWorkFolder
						Description:
						Returns
						Parameters
							String: psWorkFolder
						Static Variables
						Local variables
						Actions
							Call uivSettings.SetWorkFolder( psWorkFolder )
					Function: GetEmailBase
						Description:
						Returns
							String:
						Parameters
						Static Variables
						Local variables
						Actions
							Return uivSettings.GetEmailBase(  )
					Function: SetEmailBase
						Description:
						Returns
						Parameters
							String: psEmailBase
						Static Variables
						Local variables
						Actions
							Call uivSettings.SetEmailBase( psEmailBase )
					Function: GetTempTomFile
						Description:
						Returns
							String:
						Parameters
						Static Variables
						Local variables
							String: sWorkFolder
						Actions
							Set sWorkFolder = guGlobals.GetTom2GitTempFolder(  )
							Call PALPathAddBackslash( sWorkFolder )
							Return sWorkFolder || "TomTempFile.dat"
					Function: SetDestination
						Description:
						Returns
						Parameters
							Number: pnDestination
						Static Variables
						Local variables
						Actions
							Call uivSettings.SetDestination( pnDestination )
					Function: SetLogMode
						Description:
						Returns
						Parameters
							Number: pnLogMode
						Static Variables
						Local variables
						Actions
							Call uivSettings.SetLogMode( pnLogMode )
					Function: SetAbortOnError
						Description:
						Returns
						Parameters
							Boolean: pbAbortOnError
						Static Variables
						Local variables
						Actions
							Call uivSettings.SetAbortOnError( pbAbortOnError )
					Function: GetDestination
						Description:
						Returns
							Number:
						Parameters
						Static Variables
						Local variables
						Actions
							Return uivSettings.GetDestination(  )
					Function: GetSettings
						Description:
						Returns
						Parameters
							FunctionalVar: rpuSettings
								Class: cfcTMSettings
						Static Variables
						Local variables
						Actions
							Set rpuSettings = uivSettings
					Function: Trace
						Description:
						Returns
							Boolean:
						Parameters
							Number: pnSeverity
							String: psTraceMsg
						Static Variables
						Local variables
							Date/Time: dtDateCurrent
							String: sDateCurrent
							String: sLine
						Actions
							If uivSettings.nivLogMode = ncTOM2GIT_LOGMODE_FULL OR ( uivSettings.nivLogMode = ncTOM2GIT_LOGMODE_ERRORS AND pnSeverity = EVENT_ERROR ) AND hFileivLog
								Set dtDateCurrent = SalDateCurrent(  )
								Set sDateCurrent =  SalFmtFormatDateTime ( dtDateCurrent, "dd-MM-yyyy" ) || scSPACE ||
											VisStrChoose( SalStrLength( SalFmtFormatDateTime ( dtDateCurrent, "hhhh:mm:ss" ) ) = 8, "", "0" ) ||
											SalFmtFormatDateTime ( dtDateCurrent, "hhhh:mm:ss" )
								Set sLine = sDateCurrent || scTAB
								If pnSeverity = EVENT_ERROR
									Call SalFilePutStr( hFileivLog, sLine || "ERROR: " || psTraceMsg )
								Else
									Call SalFilePutStr( hFileivLog, sLine || psTraceMsg )
					Function: TraceStop
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							If hFileivLog
								Call Trace( EVENT_INFORMATION, "Trace ended" )
								Call SalFileClose( hFileivLog )
					Function: TraceStart
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
							Boolean: bOk
							Date/Time: dtDateCurrent
							String: sDateCurrent
						Actions
							If hFileivLog
								Set bOk = TRUE
							Else
								If NOT CreateTom2GitTempFolder( )
									Return FALSE
								Set dtDateCurrent = SalDateCurrent(  )
								Set sDateCurrent =  SalFmtFormatDateTime ( dtDateCurrent, "dd-MM-yyyy" ) || "_" ||
											VisStrChoose( SalStrLength( SalFmtFormatDateTime ( dtDateCurrent, "hhhh.mm.ss" ) ) = 8, "", "0" ) ||
											SalFmtFormatDateTime ( dtDateCurrent, "hhhh.mm.ss" )
								Set bOk = SalFileOpen( hFileivLog, GetTom2GitTempFolder(  ) || "TomToGit_" || sDateCurrent || ".log", OF_Text | OF_Write | OF_Create )
							Return bOk
					Function: CreateTom2GitTempFolder
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
							String: sTempFolder
						Actions
							Set sTempFolder = GetTom2GitTempFolder( )
							If VisDosExist( sTempFolder )
								Return TRUE
							Else
								If VisDosMakeAllDir( sTempFolder ) > -1
									Return TRUE
								Else
									Return FALSE
					Function: GetTom2GitTempFolder
						Description:
						Returns
							String:
						Parameters
						Static Variables
						Local variables
						Actions
							Return PALGetTempDirectory(  ) || "Tom2Git\\"
			!
			Functional Class: cfcTMRepository
				Description: Holds TOM projects
				Derived From
				Class Variables
				Instance Variables
					FunctionalVar: uaivProject[*]
						Class: cfcTMProject
					Number: nivTotalProjects
					FunctionalVar: uaivStaffMember[*]
						Class: cfcTMStaffMember
					Number: nivTotalStaff
					Boolean: bivProjectsLoaded
					FunctionalVar: uivHistorySort
						Class: cfcTMHistorySortADODB
				Constructor/Destructor
				Functions
					Function: Clear
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Call SalArraySetUpperBound( uaivProject, 1, -1 )
							Set nivTotalProjects = 0
							Call SalArraySetUpperBound( uaivStaffMember, 1, -1 )
							Set nivTotalStaff = 0
							Set bivProjectsLoaded = FALSE
							Call ClearHistorySort( )
					Function: ClearHistorySort
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Set uivHistorySort = new cfcTMHistorySortADODB( )
					Function: ExportTomRepoToGit
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
							FunctionalVar: uGit
								Class: cfcLibGit2TDExt
							FunctionalVar: uSettings
								Class: cfcTMSettings
							String: sGitRepoPath
							Number: nCount
							Number: nCountRevision
							Number: nRepoPtr
							Number: nRet
							Number: nProjectIndex
							Number: nRevisionIndex
							Number: nProjectIndexNext
							Number: nRevisionIndexNext
							Boolean: bNeedsCommit
							Boolean: bOk
							Boolean: bHasErrors
							Boolean: bIsExistingRepo
						Actions
							Call guGlobals.TraceStart( )
							Call guGlobals.Trace( EVENT_INFORMATION, "Start Export TOM to GIT" )
							Call __ResetSnapshots( )
							!
							Set bOk = guGlobals.bivDryRun OR uGit.GIT_libgit2_init( nRet )
							If bOk
								If guGlobals.bivDryRun
									Call guGlobals.Trace( EVENT_INFORMATION, "Doing a dry run..." )
								Else
									Call guGlobals.Trace( EVENT_INFORMATION, "LibGit2TD library initialised" )
								Call guGlobals.GetSettings( uSettings )
								If guGlobals.GetDestination(  ) = ncTOM2GIT_DEST_MONO
									Call guGlobals.Trace( EVENT_INFORMATION, "Destination: MONOREPO" )
									Call CreateSortObject(  )
									Call guGlobals.StartProgress( uivHistorySort.nivTotal )
									Set sGitRepoPath = guGlobals.GetWorkFolder(  )
									Call PALPathRemoveBackslash( sGitRepoPath )
									Call guGlobals.Trace( EVENT_INFORMATION, "Workfolder Repo path = " || sGitRepoPath )
									If guGlobals.bivDryRun
										Call guGlobals.Trace( EVENT_INFORMATION, "Dry run selected" )
										Set bOk = TRUE
									Else
										Set bIsExistingRepo = uGit.TD_IsRepositoryRoot( sGitRepoPath, FALSE )
										If bIsExistingRepo
											Call guGlobals.SetStatusTextDetail( "Opening existing GIT repository..." )
											Call guGlobals.Trace( EVENT_INFORMATION, "Opening existing GIT repository..." )
											Set bOk = uGit.GIT_repository_open( sGitRepoPath, nRepoPtr, nRet )
											If bOk
												Call guGlobals.Trace( EVENT_INFORMATION, "(GIT_repository_open) Existing GIT repository opened" )
											Else
												Call guGlobals.Trace( EVENT_ERROR, "(GIT_repository_open) Existing GIT repository failed to open" )
										Else
											Call guGlobals.SetStatusTextDetail( "Creating initial GIT repository, branch=" || uSettings.sivBranchName || "..." )
											Call guGlobals.Trace( EVENT_INFORMATION, "Creating initial GIT repository, branch=" || uSettings.sivBranchName || "..." )
											Set bOk = uGit.TD_RepoInitExt( sGitRepoPath, uSettings.sivBranchName, nRepoPtr, nRet )
											If bOk
												Call guGlobals.Trace( EVENT_INFORMATION, "(TD_RepoInitExt) New GIT repository initialised" )
											Else
												Call guGlobals.Trace( EVENT_ERROR, "(TD_RepoInitExt) New GIT repository failed to initialise" )
									If bOk
										! Copy templates, only on new repo's
										If NOT bIsExistingRepo
											Call __CopyGitDotTemplates( sGitRepoPath )
										If uSettings.bivPauseOnInit
											Call SalMessageBox( "Git repositony is about to be committed for the first time.
													Check this repository and make manual changes when needed.
													
													Location:
													" || sGitRepoPath || "
													
													Press OK to continue exporting to the repository", "Pause after GIT INIT", MB_Ok | MB_IconInformation )
										Call uSettings.LoadMessageText( )
										Call PALPathAddBackslash( sGitRepoPath )
										!
										Set nCount = 0
										While nCount < uivHistorySort.nivTotal AND guGlobals.DoContinue(  )
											Call uivHistorySort.GetRevInfo( nCount, nProjectIndex, nRevisionIndex )
											If uaivProject[nProjectIndex].dtivSnapshotDate AND uaivProject[nProjectIndex].bivSnapshotModeEnabled
												If NOT uaivProject[nProjectIndex].CreateSnapshot( sGitRepoPath, TRUE )
													Set bHasErrors = TRUE
													If uSettings.bivAbortOnError
														Call guGlobals.Trace( EVENT_ERROR, "Abort export due to error" )
														Break
											!
											If uSettings.nivIntervalMode = ncINTERVAL_NONE
												Set bNeedsCommit = TRUE
											Else
												If uivHistorySort.GetRevInfo( nCount + 1, nProjectIndexNext, nRevisionIndexNext )
													Set bNeedsCommit = __NeedsCommit( nProjectIndex, nRevisionIndex, nProjectIndexNext, nRevisionIndexNext )
												Else
													Set bNeedsCommit = TRUE
											If NOT uaivProject[nProjectIndex].ExportRevisionToGit( nRepoPtr, sGitRepoPath, nRevisionIndex, bNeedsCommit )
												Set bHasErrors = TRUE
												If uSettings.bivAbortOnError
													Call guGlobals.Trace( EVENT_ERROR, "Abort export due to error" )
													Break
											Call guGlobals.StepProgress(  )
											Set nCount = nCount + 1
										Call VisFileDelete( guGlobals.GetTempTomFile(  ) )
										If NOT guGlobals.bivDryRun
											Call uGit.GIT_repository_free( nRepoPtr )
									Else
										Set bHasErrors = TRUE
								Else
									Call guGlobals.Trace( EVENT_INFORMATION, "Destination: POLYREPO" )
									Call guGlobals.StartProgress( GetSelectedProjectsRevisions(  ) )
									!
									Set nCount = 0
									While nCount < nivTotalProjects AND guGlobals.DoContinue(  )
										If uaivProject[nCount].bivIsSelected
											Set sGitRepoPath = uaivProject[nCount].GetGitRepoPath( FALSE )
											Call PALPathRemoveBackslash( sGitRepoPath )
											If guGlobals.bivDryRun
												Call guGlobals.Trace( EVENT_INFORMATION, "Dry run selected" )
												Set bOk = TRUE
											Else
												Call guGlobals.SetStatusTextDetail( "Creating initial GIT repository..." )
												Call guGlobals.Trace( EVENT_INFORMATION, "Repo path = " || sGitRepoPath )
												Call guGlobals.Trace( EVENT_INFORMATION, "Creating initial GIT repository, branch=" || uSettings.sivBranchName || "..." )
												Set bOk = guGlobals.bivDryRun OR uGit.TD_RepoInitExt( sGitRepoPath, uSettings.sivBranchName, nRepoPtr, nRet )
												If bOk
													Call guGlobals.Trace( EVENT_INFORMATION, "(TD_RepoInitExt) New GIT repository initialised" )
												Else
													Call guGlobals.Trace( EVENT_ERROR, "(TD_RepoInitExt) New GIT repository failed to initialise" )
											If bOk
												! Copy templates
												Call __CopyGitDotTemplates( sGitRepoPath )
												If uSettings.bivPauseOnInit
													Call SalMessageBox( "Git repositony is about to be committed for the first time.
															Check this repository and make manual changes when needed.
															
															Location:
															" || sGitRepoPath || "
															
															Press OK to continue exporting to the repository", "Pause after GIT INIT", MB_Ok | MB_IconInformation )
												Call uSettings.LoadMessageText( )
												Call PALPathAddBackslash( sGitRepoPath )
												!
												Set nCountRevision = 0
												While nCountRevision < uaivProject[nCount].nivTotalRevisions AND guGlobals.DoContinue(  )
													If uaivProject[nCount].dtivSnapshotDate AND uaivProject[nCount].bivSnapshotModeEnabled
														If NOT uaivProject[nCount].CreateSnapshot( sGitRepoPath, TRUE )
															Set bHasErrors = TRUE
															If uSettings.bivAbortOnError
																Call guGlobals.Trace( EVENT_ERROR, "Abort export due to error" )
																Break
													If uSettings.nivIntervalMode = ncINTERVAL_NONE
														Set bNeedsCommit = TRUE
													Else
														If nCountRevision = uaivProject[nCount].nivTotalRevisions - 1
															Set bNeedsCommit = TRUE
														Else
															Set bNeedsCommit = __NeedsCommit( nCount, nCountRevision, nProjectIndexNext, nRevisionIndexNext )
													If NOT uaivProject[nCount].ExportRevisionToGit( nRepoPtr, sGitRepoPath, nCountRevision, bNeedsCommit )
														Set bHasErrors = TRUE
														If uSettings.bivAbortOnError
															Call guGlobals.Trace( EVENT_ERROR, "Abort export due to error" )
															Break
													Call guGlobals.StepProgress(  )
													Set nCountRevision = nCountRevision + 1
												If NOT guGlobals.bivDryRun
													Call uGit.GIT_repository_free( nRepoPtr )
											Else
												Set bHasErrors = TRUE
												If guGlobals.bivDryRun
													Call guGlobals.Trace( EVENT_ERROR, "Doing a dry run failed" )
												Else
													Call guGlobals.Trace( EVENT_ERROR, "(TD_RepoInitExt) Git repository failed to initialise: " || sGitRepoPath )
										Set nCount = nCount + 1
									Call VisFileDelete( guGlobals.GetTempTomFile(  ) )
								If NOT guGlobals.bivDryRun
									Call uGit.GIT_libgit2_shutdown(  )
							Else
								Set bHasErrors = TRUE
								If guGlobals.bivDryRun
									Call guGlobals.Trace( EVENT_ERROR, "Doing a dry run failed" )
								Else
									Call guGlobals.Trace( EVENT_ERROR, "LibGit2TD library not initialised" )
							Call guGlobals.StopProgress(  )
							Call guGlobals.SetStatusTextFinished(  )
							Call guGlobals.TraceStop(  )
							If bHasErrors
								Call SalMessageBox( "Export finished with errors!
										See log for details.", "Export - FAILED", MB_Ok | MB_IconExclamation )
							Else
								Call SalMessageBox( "Export finished without errors!
										See log for details.", "Export - OK", MB_Ok | MB_IconInformation )
					Function: CreateSnapshot
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
							Number: nCount
							Number: nProjectIndex
							Number: nRevisionIndex
							String: sGitRepoPath
							FunctionalVar: uSettings
								Class: cfcTMSettings
							Boolean: bHasErrors
						Actions
							Call guGlobals.TraceStart( )
							Call guGlobals.Trace( EVENT_INFORMATION, "Start creating snapshot" )
							Call __ResetSnapshots( )
							!
							Call guGlobals.GetSettings( uSettings )
							If guGlobals.GetDestination(  ) = ncTOM2GIT_DEST_MONO
								Call CreateSortObject(  )
								Set sGitRepoPath = guGlobals.GetWorkFolder(  )
								Call PALPathAddBackslash( sGitRepoPath )
								!
								Set nCount = 0
								While nCount < uivHistorySort.nivTotal AND guGlobals.DoContinue(  )
									Call uivHistorySort.GetRevInfo( nCount, nProjectIndex, nRevisionIndex )
									If NOT uaivProject[nProjectIndex].CreateSnapshot( sGitRepoPath, FALSE )
										Set bHasErrors = TRUE
										If uSettings.bivAbortOnError
											Call guGlobals.Trace( EVENT_ERROR, "Abort creating snapshot due to error" )
											Break
									Call guGlobals.StepProgress(  )
									Set nCount = nCount + 1
								Call VisFileDelete( guGlobals.GetTempTomFile(  ) )
							Else
								Set nCount = 0
								While nCount < nivTotalProjects AND guGlobals.DoContinue(  )
									If uaivProject[nCount].bivIsSelected
										Set sGitRepoPath = uaivProject[nCount].GetGitRepoPath( FALSE )
										Call PALPathRemoveBackslash( sGitRepoPath )
										Call PALPathAddBackslash( sGitRepoPath )
										If NOT uaivProject[nCount].CreateSnapshot( sGitRepoPath, FALSE )
											Set bHasErrors = TRUE
											If uSettings.bivAbortOnError
												Call guGlobals.Trace( EVENT_ERROR, "Abort creating snapshot due to error" )
												Break
										Call guGlobals.StepProgress(  )
									Set nCount = nCount + 1
								Call VisFileDelete( guGlobals.GetTempTomFile(  ) )
							Call guGlobals.StopProgress(  )
							Call guGlobals.SetStatusTextFinished( )
							Call guGlobals.TraceStop(  )
							If bHasErrors
								Call SalMessageBox( "Snapshot finished with errors!
										See log for details.", "Snapshot - FAILED", MB_Ok | MB_IconExclamation )
							Else
								Call SalMessageBox( "Snapshot finished without errors!
										See log for details.", "Snapshot - OK", MB_Ok | MB_IconInformation )
					Function: ValidateExport
						Description:
						Returns
							Boolean:
						Parameters
							Boolean: pbForGitExport
						Static Variables
						Local variables
							FunctionalVar: uGit
								Class: cfcLibGit2TDExt
							Number: nRet
							Number: nCount
							Number: nDummy
							String: sExistsFolderErrMsg
							Number: nItems
							String: sMsgText
							String: sSignatureMsg
							String: saItems[*]
							String: sGitRepoFolder
							Boolean: bDoCheckFolders
							Boolean: bWorkFolderIsGitRoot
							Boolean: bWorkFolderIsGitSubfolder
							Boolean: bUseExistingRepo
						Actions
							! Workfolder check >>>
							If (NOT guGlobals.GetWorkFolder(  )) OR NOT VisDosExist( guGlobals.GetWorkFolder(  ) )
								Set sMsgText = sMsgText || "# Workfolder is invalid. Select a valid folder for Tom2Git export." || "
										
										"
							!
							! Temp check >>>
							If NOT guGlobals.CreateTom2GitTempFolder(  )
								Set sMsgText = sMsgText || "# Temp folder is invalid. Check existence of TEMP or TMP environment variable." || "
										
										"
							!
							! LibGit2TD check >>>
							If pbForGitExport
								If uGit.GIT_libgit2_init( nRet )
									If NOT uGit.GIT_libgit2_version( nDummy, nDummy, nDummy, nRet )
										Call uGit.GIT_libgit2_shutdown(  )
										Set sMsgText = sMsgText || "# LibGit2TD error. Unable to initialise the library." || "
												
												"
									! Check if workfolder is subfolder of existing repo
									Set bWorkFolderIsGitRoot = uGit.TD_IsRepositoryRoot( guGlobals.GetWorkFolder(  ), FALSE )
									Set bWorkFolderIsGitSubfolder = uGit.TD_IsRepositoryFolder( guGlobals.GetWorkFolder(  ), FALSE )
									!
									Call uGit.GIT_libgit2_shutdown(  )
								Else
									Set sMsgText = sMsgText || "# LibGit2TD error. Unable to initialise the library." || "
											
											"
									Return FALSE
							!
							! Validate monorepo folder
							If guGlobals.GetDestination(  ) = ncTOM2GIT_DEST_MONO
								If bWorkFolderIsGitRoot
									Set bUseExistingRepo = SalMessageBox( "The workfolder is an existing Git repository:
											
											" || guGlobals.GetWorkFolder(  ) || ".
											
											Do you want to export into that repository?" , "Use existing repository", MB_YesNo ) = IDYES
									Set bDoCheckFolders = FALSE
									If NOT bUseExistingRepo
										Set sMsgText = sMsgText || "# Selected workfolder is an existing repository. Export canceled by user." || "
												
												"
								Else If bWorkFolderIsGitSubfolder
									Set sMsgText = sMsgText || "# Selected workfolder is a subfolder of an existing repository. Not allowed for exports." || "
											Select an empty folder or select the root folder of the Git repository.
											
											"
									Set bDoCheckFolders = FALSE
								Else
									Set sGitRepoFolder = guGlobals.GetWorkFolder(  )
									If VisDosExist( sGitRepoFolder )
										Set nItems = VisDosEnumDirs( sGitRepoFolder || "*", saItems )
										Set nItems = nItems + VisDosEnumFiles( sGitRepoFolder || "*", FA_Standard, saItems )
										If nItems > 0
											Set sMsgText = sMsgText || "#  The Git monorepo folder is not empty. Delete contents before export:
													" || sGitRepoFolder || "
													
													"
							Else
								! Validate repo folders
								If bWorkFolderIsGitRoot
									Set sMsgText = sMsgText || "# Selected workfolder is an existing repository. Not allowed using PolyRepo exports." || "
											
											"
								Else If bWorkFolderIsGitSubfolder
									Set sMsgText = sMsgText || "# Selected workfolder is a subfolder of an existing repository. Not allowed for exports." || "
											
											"
								Else
									Set sExistsFolderErrMsg = ""
									Set nCount = 0
									While nCount < nivTotalProjects
										If uaivProject[nCount].bivIsSelected
											Set sGitRepoFolder = uaivProject[nCount].GetGitRepoPath( FALSE )
											If VisDosExist( sGitRepoFolder )
												Set sExistsFolderErrMsg = sExistsFolderErrMsg || uaivProject[nCount].sivProjectCode || " -> " || sGitRepoFolder || "
														"
										Set nCount = nCount + 1
									If sExistsFolderErrMsg
										Set sMsgText = sMsgText || "#  The following Git polyrepo folders already exist. Delete them before export:
												" || sExistsFolderErrMsg || "
												
												"
							!
							! Check signatures >>>
							If pbForGitExport
								Set sSignatureMsg = GetStaffMembersValidateMsg( )
								If sSignatureMsg
									Set sMsgText = sMsgText || "#  Signature errors. The following staff menbers are missing name and/or email:
											" || sSignatureMsg || "
											"
							!
							! Display errors when present
							If sMsgText
								Call SalModalDialog( dlgMessageBox, hWndForm, "Validation issues found !!", sMsgText )
								Return FALSE
							Else
								Return TRUE
					Function: LoadRepository
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
							String: sSql
							String: sSqlLower
							Boolean: bReturn
							Number: nRet
						Actions
							Call Clear(  )
							If guGlobals.GetSqlHandle(  )
								If PALSqlGetDatabaseBrand( ) = DBV_BRAND_SQL
									Set sSqlLower = " @LOWER(PROJECT_CODE) "
								Else
									Set sSqlLower = " LOWER(PROJECT_CODE) "
								Set sSql = "
										SELECT	PROJECT_CODE,PROJECT_NAME,STORAGE_METHOD,PROJECT_PATH,
											PRESERVE_FOLDER, DESCRIPTION, IS_FROZEN
										FROM	TMADM.PROJECT
										INTO	:uaivProject[nivTotalProjects].sivProjectCode,
											:uaivProject[nivTotalProjects].sivProjectName,
											:uaivProject[nivTotalProjects].sivStorageMethod,
											:uaivProject[nivTotalProjects].sivProjectPath,
											:uaivProject[nivTotalProjects].bivPreserveFolderStruct,
											:uaivProject[nivTotalProjects].sivProjectDescription,
											:uaivProject[nivTotalProjects].bivIsFrozen
										WHERE	"  || sSqlLower || " <> '#starter'
										ORDER BY PROJECT_CODE
										"
								Call guGlobals.SetStatusTextDetail( "Retrieving list of projects..." )
								If SqlPrepareAndExecute( guGlobals.GetSqlHandle(  ), sSql )
									While SqlFetchNext( guGlobals.GetSqlHandle(  ), nRet )
										Call uaivProject[nivTotalProjects].uivRootModeSettings.SetRootMode( ncTOM2GIT_ROOTMODE_CODE )
										Set nivTotalProjects = nivTotalProjects + 1
									Set bivProjectsLoaded = TRUE
									Set bReturn = TRUE
								If bReturn
									Call guGlobals.SetStatusTextDetail( "Retrieving staff..." )
									Set bReturn = __LoadStaff( )
								If bReturn
									Set bReturn = __LoadAllModulesAndFolders( )
							Call guGlobals.SetStatusTextFinished( )
							Return bReturn
					Function: CreateSortObject
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							Number: nCount
							Boolean: bUseADODB
							FunctionalVar: uSettings
								Class: cfcTMSettings
						Actions
							Call guGlobals.Trace( EVENT_INFORMATION, "Sorting revisions" )
							Call guGlobals.SetStatusTextSection( "Revision history" )
							Call guGlobals.SetStatusTextDetail( "Sorting repo revisions..." )
							Call guGlobals.GetSettings( uSettings )
							Call ClearHistorySort( )
							Set bUseADODB = ( guGlobals.GetDestination(  ) = ncTOM2GIT_DEST_MONO )
							If bUseADODB
								If NOT uivHistorySort.CreateADODBRecordSet(  )
									Call guGlobals.Trace( EVENT_ERROR, "CreateADODBRecordSet failed" )
									Return FALSE
							Set nCount = 0
							While nCount < nivTotalProjects
								If uSettings.bivShowFrozenProjects OR NOT uaivProject[nCount].bivIsFrozen
									If uaivProject[nCount].bivIsSelected
										Call uaivProject[nCount].FillSortObject( nCount, uivHistorySort, bUseADODB )
								Set nCount = nCount + 1
							!
							If bUseADODB
								Call uivHistorySort.SortADODBRecordSet(  )
								Call uivHistorySort.CloseADODBRecordSet(  )
							!
							Call guGlobals.SetStatusTextFinished( )
					Function: SelectAllRepoRevisions
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							Number: nCount
							FunctionalVar: uSettings
								Class: cfcTMSettings
						Actions
							Call guGlobals.StartProgress( nivTotalProjects )
							Call guGlobals.GetSettings( uSettings )
							Set nCount = 0
							Call guGlobals.SetStatusTextSection( "Retrieving revisions" )
							While nCount < nivTotalProjects AND guGlobals.DoContinue(  )
								If uSettings.bivShowFrozenProjects OR NOT uaivProject[nCount].bivIsFrozen
									If uaivProject[nCount].LoadProjectRevisions( FALSE )
										Set uaivProject[nCount].bivIsSelected = TRUE
								Call guGlobals.StepProgress(  )
								Set nCount = nCount + 1
							Call guGlobals.StopProgress(  )
					Function: UnselectAllProjects
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							Number: nCount
						Actions
							Set nCount = 0
							While nCount < nivTotalProjects
								Set uaivProject[nCount].bivIsSelected = FALSE
								Set nCount = nCount + 1
					Function: GetProjectOnIndex
						Description:
						Returns
							Boolean:
						Parameters
							Number: pnIndex
							FunctionalVar: rpuProject
								Class: cfcTMProject
						Static Variables
						Local variables
						Actions
							If pnIndex > -1 AND pnIndex < nivTotalProjects
								Set rpuProject = uaivProject[pnIndex]
								Return TRUE
							Else
								Return FALSE
					Function: GetProjectOnCode
						Description:
						Returns
							Boolean:
						Parameters
							String: psProjectCode
							FunctionalVar: rpuProject
								Class: cfcTMProject
						Static Variables
						Local variables
							Number: nCount
						Actions
							Set nCount = 0
							While nCount < nivTotalProjects
								If uaivProject[nCount].sivProjectCode = psProjectCode
									Set rpuProject = uaivProject[nCount]
									Return TRUE
								Set nCount = nCount + 1
							Return FALSE
					Function: GetStaffMemberNameOnCode
						Description:
						Returns
							String:
						Parameters
							String: psStaffCode
						Static Variables
						Local variables
							Number: nCount
						Actions
							Set nCount = 0
							While nCount < nivTotalStaff
								If uaivStaffMember[nCount].sivStaffCode = psStaffCode
									Return uaivStaffMember[nCount].sivFullName
								Set nCount = nCount + 1
							Return ""
					Function: GetStaffMember
						Description:
						Returns
							Boolean:
						Parameters
							String: psStaffCode
							FunctionalVar: rpuStaffMember
								Class: cfcTMStaffMember
						Static Variables
						Local variables
							Number: nCount
						Actions
							Set nCount = 0
							While nCount < nivTotalStaff
								If uaivStaffMember[nCount].sivStaffCode = psStaffCode
									Set rpuStaffMember = uaivStaffMember[nCount]
									Return TRUE
								Set nCount = nCount + 1
							Return FALSE
					Function: GetStaffMembersValidateMsg
						Description:
						Returns
							String:
						Parameters
						Static Variables
						Local variables
							String: sMsg
							String: sReturnMsg
							Number: nCount
						Actions
							Set nCount = 0
							While nCount < nivTotalStaff
								Set sMsg = uaivStaffMember[nCount].GetValidationMsg(  )
								If sMsg
									Set sReturnMsg = sReturnMsg || sMsg || "
											"
								Set nCount = nCount + 1
							Return sReturnMsg
					Function: GetSelectedProjects
						Description:
						Returns
							Number:
						Parameters
						Static Variables
						Local variables
							Number: nCount
							Number: nTotal
						Actions
							Set nCount = 0
							While nCount < nivTotalProjects
								If uaivProject[nCount].bivIsSelected
									Set nTotal = nTotal + 1
								Set nCount = nCount + 1
							Return nTotal
					Function: GetSelectedProjectsRevisions
						Description:
						Returns
							Number:
						Parameters
						Static Variables
						Local variables
							Number: nCount
							Number: nTotal
						Actions
							Set nCount = 0
							While nCount < nivTotalProjects
								If uaivProject[nCount].bivIsSelected
									Set nTotal = nTotal + uaivProject[nCount].nivTotalRevisions
								Set nCount = nCount + 1
							Return nTotal
					Function: HasSelection
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
							Number: nCount
						Actions
							Set nCount = 0
							While nCount < nivTotalProjects
								If uaivProject[nCount].bivIsSelected
									Return TRUE
								Set nCount = nCount + 1
							Return FALSE
					Function: SetShowFrozenProjects
						Description:
						Returns
						Parameters
							Boolean: pbShow
						Static Variables
						Local variables
							Number: nCount
							FunctionalVar: uSettings
								Class: cfcTMSettings
						Actions
							Call guGlobals.GetSettings( uSettings )
							Set uSettings.bivShowFrozenProjects = pbShow
							If uSettings.bivShowFrozenProjects
								If bivProjectsLoaded
									Call __LoadAllModulesAndFolders( )
							Else
								Set nCount = 0
								While nCount < nivTotalProjects
									If uaivProject[nCount].bivIsFrozen AND uaivProject[nCount].bivIsSelected
										Set uaivProject[nCount].bivIsSelected = FALSE
									Set nCount = nCount + 1
					Function: SetProcessDeltaFiles
						Description:
						Returns
						Parameters
							Boolean: pbProcess
						Static Variables
						Local variables
							Number: nCount
							FunctionalVar: uSettings
								Class: cfcTMSettings
						Actions
							Call guGlobals.GetSettings( uSettings )
							Set uSettings.bivProcessDeltaFiles = pbProcess
							Set nCount = 0
							While nCount < nivTotalProjects
								If uaivProject[nCount].bivRevisionsLoaded
									Call uaivProject[nCount].LoadProjectRevisions( TRUE )
								Set nCount = nCount + 1
					Function: AppyGitExportSettingsToAll
						Description:
						Returns
						Parameters
							Number: pnRootMode
						Static Variables
						Local variables
							Number: nCount
						Actions
							Set nCount = 0
							While nCount < nivTotalProjects
								Call uaivProject[nCount].uivRootModeSettings.SetRootMode( pnRootMode )
								Set nCount = nCount + 1
					Function: SetStaffMembersSignature
						Description:
						Returns
						Parameters
							Number: pnMode
							String: psBaseEmail
						Static Variables
						Local variables
							Number: nCount
						Actions
							Set nCount = 0
							While nCount < nivTotalStaff
								Call uaivStaffMember[nCount].SetSignature( pnMode, psBaseEmail )
								Set nCount = nCount + 1
					Function: SaveStaffMembersToTemplate
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							String: sMembersFile
							FunctionalVar: uSettings
								Class: cfcTMSettings
							Number: nCount
						Actions
							Call guGlobals.GetSettings( uSettings )
							Set sMembersFile = guGlobals.GetTemplatesFolder(  ) || uSettings.sivTeamMembersTemplate
							Set nCount = 0
							While nCount < nivTotalStaff
								Call SalSetProfileString( "NAME", uaivStaffMember[nCount].sivStaffCode, uaivStaffMember[nCount].sivExportName, sMembersFile )
								Call SalSetProfileString( "EMAIL", uaivStaffMember[nCount].sivStaffCode, uaivStaffMember[nCount].sivExportEmail, sMembersFile )
								Set nCount = nCount + 1
					Function: LoadStaffMembersFromTemplate
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							String: sMembersFile
							FunctionalVar: uSettings
								Class: cfcTMSettings
							Number: nCount
						Actions
							Call guGlobals.GetSettings( uSettings )
							Set sMembersFile = guGlobals.GetTemplatesFolder(  ) || uSettings.sivTeamMembersTemplate
							If VisDosExist( sMembersFile )
								Set nCount = 0
								While nCount < nivTotalStaff
									Call SalGetProfileString( "NAME", uaivStaffMember[nCount].sivStaffCode, uaivStaffMember[nCount].sivExportName, uaivStaffMember[nCount].sivExportName, sMembersFile )
									Call SalGetProfileString( "EMAIL", uaivStaffMember[nCount].sivStaffCode, uaivStaffMember[nCount].sivExportEmail, uaivStaffMember[nCount].sivExportEmail, sMembersFile )
									Set nCount = nCount + 1
					Function: __CopyGitDotTemplates
						Description:
						Returns
						Parameters
							String: psGitRepoPath
						Static Variables
						Local variables
							FunctionalVar: uSettings
								Class: cfcTMSettings
							Number: nRet
						Actions
							If VisDosExist( psGitRepoPath )
								Call guGlobals.GetSettings( uSettings )
								!
								If uSettings.sivGitAttributesTemplate AND VisDosExist( guGlobals.GetTemplatesFolder(  ) || uSettings.sivGitAttributesTemplate )
									Set nRet = VisFileCopy( guGlobals.GetTemplatesFolder(  ) || uSettings.sivGitAttributesTemplate, psGitRepoPath )
									If nRet > -1
										Call guGlobals.Trace( EVENT_INFORMATION, "Copied Git attributes-template to repo path : " ||  guGlobals.GetTemplatesFolder(  ) || uSettings.sivGitAttributesTemplate )
									Else
										Call guGlobals.Trace( EVENT_ERROR, "Copy Git attributes-template to repo path failed : " ||  guGlobals.GetTemplatesFolder(  ) || uSettings.sivGitAttributesTemplate )
								If uSettings.sivGitIgnoreTemplate AND VisDosExist( guGlobals.GetTemplatesFolder(  ) || uSettings.sivGitIgnoreTemplate )
									Set nRet =  VisFileCopy( guGlobals.GetTemplatesFolder(  ) || uSettings.sivGitIgnoreTemplate, psGitRepoPath )
									If nRet > -1
										Call guGlobals.Trace( EVENT_INFORMATION, "Copied Git ignore-template to repo path : " ||  guGlobals.GetTemplatesFolder(  ) || uSettings.sivGitIgnoreTemplate )
									Else
										Call guGlobals.Trace( EVENT_ERROR, "Copy Git ignore-template to repo path failed : " ||  guGlobals.GetTemplatesFolder(  ) || uSettings.sivGitIgnoreTemplate )
					Function: __LoadAllModulesAndFolders
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
							Number: nCount
							Boolean: bError
							FunctionalVar: uSettings
								Class: cfcTMSettings
						Actions
							Call guGlobals.SetStatusTextSection( "Retrieving modules/folders" )
							Call guGlobals.GetSettings( uSettings )
							Set bError = FALSE
							Call guGlobals.StartProgress( nivTotalProjects )
							Set nCount = 0
							While nCount < nivTotalProjects
								If uSettings.bivShowFrozenProjects OR NOT uaivProject[nCount].bivIsFrozen
									If NOT uaivProject[nCount].LoadProjectModulesAndFolders(  )
										Set bError = TRUE
								Call guGlobals.StepProgress(  )
								Set nCount = nCount + 1
							Call guGlobals.StopProgress(  )
							Return NOT bError
					Function: __LoadStaff
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
							String: sSql
							Boolean: bReturn
							Number: nRet
						Actions
							Call SalArraySetUpperBound( uaivStaffMember, 1, -1 )
							Set nivTotalStaff = 0
							If guGlobals.GetSqlHandle(  )
								Set sSql = "
										SELECT	STAFF_CODE ,FIRST_NAME, SURNAME, 1
										FROM	TMADM.STAFF
										INTO	:uaivStaffMember[nivTotalStaff].sivStaffCode,
											:uaivStaffMember[nivTotalStaff].sivFirstname,
											:uaivStaffMember[nivTotalStaff].sivSurname,
											:uaivStaffMember[nivTotalStaff].bivActive
										"
								If SqlPrepareAndExecute( guGlobals.GetSqlHandle(  ), sSql )
									While SqlFetchNext( guGlobals.GetSqlHandle(  ), nRet )
										Set uaivStaffMember[nivTotalStaff].sivFullName = uaivStaffMember[nivTotalStaff].sivFirstname || " " || uaivStaffMember[nivTotalStaff].sivSurname
										Set nivTotalStaff = nivTotalStaff + 1
								Set sSql = "
										SELECT	DISTINCT MODIFIED_BY
										FROM	TMADM.MODULE_REVISION
										WHERE	MODIFIED_BY NOT IN ( SELECT STAFF_CODE FROM TMADM.STAFF)
										ORDER BY MODIFIED_BY
										INTO	:uaivStaffMember[nivTotalStaff].sivStaffCode
										"
								If SqlPrepareAndExecute( guGlobals.GetSqlHandle(  ), sSql )
									While SqlFetchNext( guGlobals.GetSqlHandle(  ), nRet )
										Set nivTotalStaff = nivTotalStaff + 1
									Call SetStaffMembersSignature( ncSIG_RESET_INIT, "" )
									Set bReturn = TRUE
								Call LoadStaffMembersFromTemplate(  )
							Return bReturn
					Function: __NeedsCommit
						Description:
						Returns
							Boolean:
						Parameters
							Number: pnProjectIndex
							Number: pnRevisionIndex
							Number: pnProjectIndexNext
							Number: pnRevisionIndexNext
						Static Variables
						Local variables
							FunctionalVar: uCurrentRev
								Class: cfcTMProjectModuleRevision
							FunctionalVar: uNextRev
								Class: cfcTMProjectModuleRevision
							Number: nDiffInSeconds
							Number: nIntervalInSeconds
							FunctionalVar: uSettings
								Class: cfcTMSettings
						Actions
							Call guGlobals.GetSettings( uSettings )
							Set uCurrentRev = uaivProject[pnProjectIndex].uaivRevision[pnRevisionIndex]
							Set uNextRev = uaivProject[pnProjectIndexNext].uaivRevision[pnRevisionIndexNext]
							Set nDiffInSeconds = (uNextRev.dtivRevisionDateTime - uCurrentRev.dtivRevisionDateTime ) * 86400
							Set nDiffInSeconds = SalNumberTruncate( nDiffInSeconds, 10, 3 )
							Select Case uSettings.nivIntervalMode
								Case ncINTERVAL_NONE
									Return TRUE
									Break
								Case ncINTERVAL_SECONDS
									Set nIntervalInSeconds = uSettings.nivIntervalValue
									Break
								Case ncINTERVAL_MINUTES
									Set nIntervalInSeconds = uSettings.nivIntervalValue * 60
									Break
								Case ncINTERVAL_HOURS
									Set nIntervalInSeconds = uSettings.nivIntervalValue * 3600
									Break
								Case ncINTERVAL_DAYS
									Set nIntervalInSeconds = uSettings.nivIntervalValue * 86400
									Break
								Case ncINTERVAL_WEEKS
									Set nIntervalInSeconds = uSettings.nivIntervalValue * 604800
									Break
								Case ncINTERVAL_MONTHS
									Set nIntervalInSeconds = uSettings.nivIntervalValue * 2628288
									Break
								Case ncINTERVAL_YEARS
									Set nIntervalInSeconds = uSettings.nivIntervalValue * 31536000
									Break
							If nDiffInSeconds >= nIntervalInSeconds
								Return TRUE
							Else
								Return FALSE
					Function: __ResetSnapshots
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							Number: nCount
						Actions
							Set nCount = 0
							While nCount < nivTotalProjects
								Call uaivProject[nCount].ResetSnapshots( )
								Set nCount = nCount + 1
			Functional Class: cfcTMProject
				Description:
				Derived From
				Class Variables
				Instance Variables
					Boolean: bivIsSelected
					String: sivProjectCode
					String: sivProjectName
					String: sivProjectDescription
					String: sivStorageMethod		! F or D
					String: sivProjectPath
					Boolean: bivIsFrozen
					Boolean: bivUseProjectPath
					Boolean: bivPreserveFolderStruct
					FunctionalVar: uaivModule[*]
						Class: cfcTMModule
					Number: nivTotalModules
					FunctionalVar: uaivFolder[*]
						Class: cfcTMProjectFolder
					Number: nivTotalFolders
					FunctionalVar: uaivRevision[*]
						Class: cfcTMProjectModuleRevision
					Number: nivTotalRevisions
					Boolean: bivRevisionsLoaded
					Number: nivTotalSize
					Boolean: bivModulesAndFoldersLoaded
					FunctionalVar: uivRootModeSettings
						Class: cfcTMRootModeSettings
					!
					Date/Time: dtivStartDateCommits		! Manual set in project revisions tab
					Date/Time: dtivSnapshotDate			! Set by the snapshot dialog
					Boolean: bivSnapshotIsCreated			! Snapshot already done for this project?
					Boolean: bivSnapshotModeEnabled		! Snapshot already done for this project?
				Constructor/Destructor
				Functions
					Function: ExportRevisionToGit
						Description:
						Returns
							Boolean:
						Parameters
							Number: pnRepoPtr
							String: psGitRepoPath
							Number: pnRevisionIndex
							Boolean: pbNeedsCommit
						Static Variables
						Local variables
							FunctionalVar: uPreviousRevision
								Class: cfcTMProjectModuleRevision
							Boolean: bHasPreviousRevision
							String: sRootModePath
							String: sGitRepoRootModePath
							Boolean: bDoCommit
						Actions
							If pnRevisionIndex > -1 AND pnRevisionIndex < nivTotalRevisions
								Call guGlobals.Trace( EVENT_INFORMATION, "(ExportRevisionToGit) Start processing revision " || SalNumberToStrX( uaivRevision[pnRevisionIndex].nivRevisionNo, 0 ) || " for  file " || uaivRevision[pnRevisionIndex].sivFileName )
								Call guGlobals.SetStatusTextSection( "Project: " || sivProjectCode )
								Set bHasPreviousRevision = GetPreviousRevision( uaivRevision[pnRevisionIndex].nivModuleID, pnRevisionIndex, uPreviousRevision )
								If guGlobals.DoContinue(  )
									Select Case uivRootModeSettings.GetRootMode(  )
										Case ncTOM2GIT_ROOTMODE_CODE
											Set sRootModePath = sivProjectCode
											Break
										Case ncTOM2GIT_ROOTMODE_NAME
											Set sRootModePath = sivProjectName
											Break
										Case ncTOM2GIT_ROOTMODE_CUSTOM
											Set sRootModePath = uivRootModeSettings.GetCustomFolder(  )
											Break
									Set sGitRepoRootModePath = psGitRepoPath || sRootModePath
									Call PALPathAddBackslash( sGitRepoRootModePath )
									If dtivSnapshotDate
										If uaivRevision[pnRevisionIndex].dtivRevisionDateTime >= dtivSnapshotDate
											Set bDoCommit = TRUE
										Else
											Set bDoCommit = FALSE
									Else
										Set bDoCommit = TRUE
									If bDoCommit
										If uaivRevision[pnRevisionIndex].bivIsDelta
											Call __ConstructDeltaMasterFile( pnRevisionIndex, uaivRevision[pnRevisionIndex] )
										Return uaivRevision[pnRevisionIndex].ExportToGit( this, pnRepoPtr, sGitRepoRootModePath, bHasPreviousRevision, uPreviousRevision, pbNeedsCommit )
									Else
										Return TRUE
								Else
									Return FALSE
							Else
								Return FALSE
					Function: CreateSnapshot
						Description:
						Returns
							Boolean:
						Parameters
							String: psGitRepoPath
							Boolean: pbInExportToGitProcess
						Static Variables
						Local variables
							Number: nStartIndex
							Number: nCount
							Boolean: bHasPreviousRevision
							FunctionalVar: uPreviousRevision
								Class: cfcTMProjectModuleRevision
							String: sRootModePath
							String: sGitRepoRootModePath
						Actions
							If nivTotalRevisions > 0
								Call guGlobals.SetStatusTextSection( "Project: " || sivProjectCode )
								If bivSnapshotIsCreated
									! Hmmm, too much spam in log? Disable this trace
									! Call guGlobals.Trace( EVENT_INFORMATION, "Snapshot already created for project: " || sivProjectCode )
									Return TRUE
								Else
									Call guGlobals.Trace( EVENT_INFORMATION, "Start creating snapshot for project: " || sivProjectCode )
									Set nStartIndex = -1
									Set nCount = 0
									While nCount < nivTotalRevisions
										If uaivRevision[nCount].dtivRevisionDateTime >= dtivSnapshotDate
											Set nStartIndex = nCount
											Break
										Set nCount = nCount + 1
									!
									If nStartIndex > -1
										If NOT pbInExportToGitProcess
											Call guGlobals.StartProgress( nStartIndex )
										Set nCount = nStartIndex
										While nCount > -1
											Call guGlobals.Trace( EVENT_INFORMATION, "(CreateSnapshot) Start processing revision " || SalNumberToStrX( uaivRevision[nCount].nivRevisionNo, 0 ) || " for  file " || uaivRevision[nCount].sivFileName )
											Set bHasPreviousRevision = GetPreviousRevision( uaivRevision[nCount].nivModuleID, nCount, uPreviousRevision )
											Select Case uivRootModeSettings.GetRootMode(  )
												Case ncTOM2GIT_ROOTMODE_CODE
													Set sRootModePath = sivProjectCode
													Break
												Case ncTOM2GIT_ROOTMODE_NAME
													Set sRootModePath = sivProjectName
													Break
												Case ncTOM2GIT_ROOTMODE_CUSTOM
													Set sRootModePath = uivRootModeSettings.GetCustomFolder(  )
													Break
											Set sGitRepoRootModePath = psGitRepoPath || sRootModePath
											Call PALPathAddBackslash( sGitRepoRootModePath )
											If uaivRevision[nCount].bivIsDelta AND NOT uaivRevision[nCount].bivDoNotExport
												Call __ConstructDeltaMasterFile( nCount, uaivRevision[nCount] )
											If NOT uaivRevision[nCount].Snapshot( this, 0, sGitRepoRootModePath, bHasPreviousRevision, uPreviousRevision, TRUE )
												Return FALSE
											If NOT pbInExportToGitProcess
												Call guGlobals.StepProgress(  )
											Set nCount = nCount - 1
										Set bivSnapshotIsCreated = TRUE
										If NOT pbInExportToGitProcess
											Call guGlobals.StopProgress(  )
										Return TRUE
									Else
										Return FALSE
							Else
								Return TRUE
					Function: ExtractRevision
						Description:
						Returns
							Boolean:
						Parameters
							FunctionalVar: puRevision
								Class: cfcTMProjectModuleRevision
							String: psDestinationFile
							Receive String: rpsError
						Static Variables
						Local variables
							Boolean: bOk
							Number: nRevisionIndex
						Actions
							Set nRevisionIndex = GetRevisionIndex( puRevision )
							If nRevisionIndex > -1
								Call guGlobals.SetStatusTextSection( "Project: " || sivProjectCode )
								If uaivRevision[nRevisionIndex].bivIsDelta
									Call __ConstructDeltaMasterFile( nRevisionIndex, uaivRevision[nRevisionIndex] )
								Set bOk = uaivRevision[nRevisionIndex].ExportTomToTempFile( psDestinationFile, rpsError )
								Call guGlobals.SetStatusTextFinished(  )
								Return bOk
							Else
								Set rpsError = "(ExtractRevision) Revision not found in list"
								Call guGlobals.Trace( EVENT_ERROR, rpsError )
								Return FALSE
					Function: LoadProjectModulesAndFolders
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
						Actions
							If bivModulesAndFoldersLoaded
								Return TRUE
							Else
								Call guGlobals.SetStatusTextSection( "Retrieving modules/folders" )
								Call guGlobals.SetStatusTextDetail( "Project " || sivProjectCode )
								Set bivModulesAndFoldersLoaded = __LoadProjectModules( )
								Set bivModulesAndFoldersLoaded = bivModulesAndFoldersLoaded AND __LoadProjectFolders( )
								Return bivModulesAndFoldersLoaded
					Function: LoadProjectRevisions
						Description: Filename = 00055898._pf
								
								
						Returns
						Parameters
							Boolean: pbRefresh
						Static Variables
						Local variables
							String: sSql
							Number: nRet
							String: sPreviousStaffCode
							String: sPreviousStaffMember
							String: sPath
							String: sDelta
							FunctionalVar: uSettings
								Class: cfcTMSettings
						Actions
							If pbRefresh
								Call SalArraySetUpperBound( uaivRevision, 1, -1 )
								Set nivTotalRevisions = 0
								Set bivRevisionsLoaded = 0
								Set nivTotalSize = 0
							If bivRevisionsLoaded
								Return TRUE
							!
							If guGlobals.GetSqlHandle(  )
								Call guGlobals.GetSettings( uSettings )
								If uSettings.bivProcessDeltaFiles
									Set sDelta = ""
								Else
									Set sDelta = "MR.IS_DELTA=0 AND"
								Call guGlobals.SetStatusTextSection( "Retrieving revisions" )
								Call guGlobals.SetStatusTextDetail( "Project " || sivProjectCode || "..." )
								Set sSql = "
										SELECT	MR.REVISION_NO,  MR.MODULE_ID,  MR.REVISION_LABEL,  MR.FILENAME,
											MR.RELATIVE_PATH, PM.FOLDER_ID, MR.DESCRIPTION,MR.SOURCE_ID,MR.IS_DELETED,MR.IS_DELTA,MR.MODIFIED_BY,
											MR.REVISION_DATE,
											S.IS_COMPRESSED, S.UNCOMPRESSED_SIZE, S.COMPRESSED_SIZE, S.SOURCE_DATETIME, S.BLOB_ID, S.STORAGE_METHOD
										FROM	TMADM.MODULE_REVISION MR,
											TMADM.PROJECT_MODULES PM,
											TMADM.MODULE M,
											TMADM.SOURCE S
										WHERE	PM.PROJECT_CODE = :sivProjectCode  AND
											PM.MODULE_ID = MR.MODULE_ID AND
											MR.MODULE_ID = M.MODULE_ID AND
											M.IS_MODEL = 0 AND M.IS_STARTER = 0 AND " || sDelta || "
											MR.SOURCE_ID = S.SOURCE_ID
										ORDER BY MR.REVISION_DATE ASC
										INTO	:uaivRevision[nivTotalRevisions].nivRevisionNo,
											:uaivRevision[nivTotalRevisions].nivModuleID,
											:uaivRevision[nivTotalRevisions].sivRevisionLabel,
											:uaivRevision[nivTotalRevisions].sivFileName,
											:uaivRevision[nivTotalRevisions].sivRelativePath,
											:uaivRevision[nivTotalRevisions].nivFolderID,
											:uaivRevision[nivTotalRevisions].sivDescription,
											:uaivRevision[nivTotalRevisions].nivSourceID,
											:uaivRevision[nivTotalRevisions].bivIsDeleted,
											:uaivRevision[nivTotalRevisions].bivIsDelta,
											:uaivRevision[nivTotalRevisions].sivModifiedBy,
											:uaivRevision[nivTotalRevisions].dtivRevisionDateTime,
											:uaivRevision[nivTotalRevisions].bivIsCompressed,
											:uaivRevision[nivTotalRevisions].nivUncompressedSize,
											:uaivRevision[nivTotalRevisions].nivCompressedSize,
											:uaivRevision[nivTotalRevisions].dtivSourceDateTime,
											:uaivRevision[nivTotalRevisions].nivBlobID,
											:uaivRevision[nivTotalRevisions].sivStorageMethod
										"
								If SqlPrepareAndExecute( guGlobals.GetSqlHandle(  ), sSql )
									While SqlFetchNext( guGlobals.GetSqlHandle(  ), nRet ) AND guGlobals.DoContinue(  )
										Set nivTotalSize = nivTotalSize + uaivRevision[nivTotalRevisions].nivUncompressedSize
										If sPreviousStaffCode = uaivRevision[nivTotalRevisions].sivModifiedBy
											Set uaivRevision[nivTotalRevisions].sivStaffMember = sPreviousStaffMember
										Else
											Set sPreviousStaffCode = uaivRevision[nivTotalRevisions].sivModifiedBy
											Set sPreviousStaffMember = guRepo.GetStaffMemberNameOnCode( sPreviousStaffCode )
											Set uaivRevision[nivTotalRevisions].sivStaffMember = sPreviousStaffMember
										Set uaivRevision[nivTotalRevisions].sivRelativePath = SalStrTrimX( uaivRevision[nivTotalRevisions].sivRelativePath )
										If uaivRevision[nivTotalRevisions].sivRelativePath AND SalStrLeftX( uaivRevision[nivTotalRevisions].sivRelativePath, 1 ) = "\\"
											Set uaivRevision[nivTotalRevisions].sivRelativePath = GetFullPathOnFolderID( uaivRevision[nivTotalRevisions].nivFolderID )
											Set sPath = uaivRevision[nivTotalRevisions].sivRelativePath
										Else
											Set sPath = GetFullPath( uaivRevision[nivTotalRevisions].sivRelativePath )
										Set uaivRevision[nivTotalRevisions].sivFullPath = sPath	! Set this value in object so later can be checked
										Set uaivRevision[nivTotalRevisions].sivFullFilePath = sPath || "\\" || uaivRevision[nivTotalRevisions].sivFileName
										Set uaivRevision[nivTotalRevisions].sivProjectFileLocation = sivProjectPath
										Set nivTotalRevisions = nivTotalRevisions + 1
									If nivTotalRevisions > 0
										Set uaivRevision[nivTotalRevisions-1].bivIsLastRevision = TRUE
									If guGlobals.DoContinue(  )
										Set bivRevisionsLoaded = TRUE
									Else
										Call __ClearRevisions(  )
								Call guGlobals.SetStatusTextFinished( )
							Return bivRevisionsLoaded
					Function: GetGitRepoPath
						Description:
						Returns
							String:
						Parameters
							Boolean: pbIncludeRootMode
						Static Variables
						Local variables
							String: sFolder
						Actions
							If guGlobals.GetDestination(  ) = ncTOM2GIT_DEST_MONO
								Set sFolder = guGlobals.GetWorkFolder(  )
							Else
								Set sFolder = guGlobals.GetWorkFolder(  ) || sivProjectCode
							Set sFolder = sFolder || "\\"
							If pbIncludeRootMode
								Select Case uivRootModeSettings.GetRootMode(  )
									Case ncTOM2GIT_ROOTMODE_CODE
										Set sFolder = sFolder || sivProjectCode
										Break
									Case ncTOM2GIT_ROOTMODE_NAME
										Set sFolder = sFolder || sivProjectName
										Break
									Case ncTOM2GIT_ROOTMODE_CUSTOM
										Set sFolder = sFolder || uivRootModeSettings.GetCustomFolder(  )
										Break
							Return sFolder
					Function: GetStorageMethodDescription
						Description:
						Returns
							String:
						Parameters
						Static Variables
						Local variables
						Actions
							If sivStorageMethod = "F"
								Return "File"
							Else If sivStorageMethod = "D"
								Return "Database"
							Else
								Return "?"
					Function: GetProjectSize
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							Number: nCount
							Number: nTotalSize
						Actions
							Set nCount = 0
							While nCount < nivTotalRevisions
								Set nTotalSize = nTotalSize + uaivRevision[nCount].nivUncompressedSize
								Set nCount = nCount + 1
							Return nTotalSize
					Function: GetModule
						Description:
						Returns
							Boolean:
						Parameters
							Number: pnModuleID
							FunctionalVar: rpuModule
								Class: cfcTMModule
						Static Variables
						Local variables
							Number: nCount
						Actions
							Set nCount = 0
							While nCount < nivTotalModules
								If uaivModule[nCount].nivModuleID = pnModuleID
									Set rpuModule = uaivModule[nCount]
									Return TRUE
								Set nCount = nCount + 1
							Return FALSE
					Function: GetFullPath
						Description:
						Returns
							String:
						Parameters
							String: psFolder
						Static Variables
						Local variables
							FunctionalVar: uFolder
								Class: cfcTMProjectFolder
							String: sFolder
						Actions
							Set psFolder = VisStrSubstitute( psFolder, "\\", "" )
							If __GetFolderOnName( psFolder, uFolder )
								Set sFolder = psFolder
								While uFolder.nivParentFolderID > 0
									Call __GetFolderOnID( uFolder.nivParentFolderID, uFolder )
									Set sFolder = uFolder.sivFolderName || "\\" || sFolder
								Return sFolder
							Else
								Return psFolder
					Function: GetFullPathOnFolderID
						Description:
						Returns
							String:
						Parameters
							Number: pnFolderID
						Static Variables
						Local variables
							FunctionalVar: uFolder
								Class: cfcTMProjectFolder
							String: sFolder
						Actions
							If __GetFolderOnID( pnFolderID, uFolder )
								Set sFolder = uFolder.sivFolderName
								While uFolder.nivParentFolderID > 0
									Call __GetFolderOnID( uFolder.nivParentFolderID, uFolder )
									Set sFolder = uFolder.sivFolderName || "\\" || sFolder
								Return sFolder
							Else
								Return ""
					Function: GetPreviousRevision
						Description:
						Returns
							Boolean:
						Parameters
							Number: pnModuleID
							Number: pnCurrentIndex
							FunctionalVar: rpuRevision
								Class: cfcTMProjectModuleRevision
						Static Variables
						Local variables
							Number: nCount
						Actions
							Set nCount = pnCurrentIndex - 1
							While nCount > -1
								If uaivRevision[nCount].nivModuleID = pnModuleID
									Set rpuRevision = uaivRevision[nCount]
									Return TRUE
								Set nCount = nCount - 1
							Return FALSE
					Function: GetPreviousRevisionByRevisionNr
						Description:
						Returns
							Boolean:
						Parameters
							FunctionalVar: puRevision
								Class: cfcTMProjectModuleRevision
							FunctionalVar: rpuRevisionPrev
								Class: cfcTMProjectModuleRevision
						Static Variables
						Local variables
							Number: nCount
						Actions
							Set nCount = nivTotalRevisions - 1
							While nCount > -1
								If uaivRevision[nCount].nivModuleID = puRevision.nivModuleID AND uaivRevision[nCount].nivRevisionNo < puRevision.nivRevisionNo
									Set rpuRevisionPrev = uaivRevision[nCount]
									Return TRUE
								Set nCount = nCount - 1
							Return FALSE
					Function: GetLatestRevision
						Description:
						Returns
							Boolean:
						Parameters
							FunctionalVar: rpuRevision
								Class: cfcTMProjectModuleRevision
						Static Variables
						Local variables
						Actions
							If nivTotalRevisions > 0
								Set rpuRevision = uaivRevision[nivTotalRevisions-1]
								Return TRUE
							Else
								Return FALSE
					Function: GetLatestRevisionForModule
						Description:
						Returns
							Boolean:
						Parameters
							Number: pnModuleID
							FunctionalVar: rpuRevision
								Class: cfcTMProjectModuleRevision
						Static Variables
						Local variables
							Number: nCount
						Actions
							Set nCount = nivTotalRevisions
							While nCount > -1
								If uaivRevision[nCount].nivModuleID = pnModuleID
									Set rpuRevision = uaivRevision[nCount]
									Return TRUE
								Set nCount = nCount - 1
							Return FALSE
					Function: GetRevisionIndex
						Description:
						Returns
							Number:
						Parameters
							FunctionalVar: puRevision
								Class: cfcTMProjectModuleRevision
						Static Variables
						Local variables
							Number: nCount
						Actions
							Set nCount = 0
							While nCount < nivTotalRevisions
								If uaivRevision[nCount].nivModuleID = puRevision.nivModuleID AND uaivRevision[nCount].nivRevisionNo = puRevision.nivRevisionNo
									Return nCount
								Set nCount = nCount + 1
							Return -1
					Function: GetFirstRevision
						Description:
						Returns
							Boolean:
						Parameters
							FunctionalVar: rpuRevision
								Class: cfcTMProjectModuleRevision
						Static Variables
						Local variables
						Actions
							If nivTotalRevisions > 0
								Set rpuRevision = uaivRevision[0]
								Return TRUE
							Else
								Return FALSE
					Function: FillSortObject
						Description:
						Returns
						Parameters
							Number: pnProjectIndex
							FunctionalVar: rpuHistorySort
								Class: cfcTMHistorySortADODB
							Boolean: pbUseADODB
						Static Variables
						Local variables
							Number: nCount
						Actions
							Set nCount = 0
							While nCount < nivTotalRevisions
								Call rpuHistorySort.AddToADODBRecordSet( pnProjectIndex, nCount, uaivRevision[nCount].dtivRevisionDateTime, pbUseADODB )
								Set nCount = nCount + 1
							Return FALSE
					Function: SetStartDateCommits
						Description:
						Returns
						Parameters
							Date/Time: pdtStartDate
						Static Variables
						Local variables
						Actions
							Set dtivStartDateCommits = pdtStartDate
							Set bivSnapshotModeEnabled = TRUE
					Function: ResetSnapshots
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							Number: nCount
						Actions
							Set bivSnapshotIsCreated = FALSE
							Set nCount = 0
							While nCount < nivTotalRevisions
								Set uaivRevision[nCount].bivDoNotExport = FALSE
								Set nCount = nCount + 1
					Function: __ClearRevisions
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Call SalArraySetUpperBound( uaivRevision, 1, -1 )
							Set nivTotalRevisions = 0
							Set bivRevisionsLoaded = FALSE
					Function: __ConstructDeltaMasterFile
						Description: Boolean __ConstructDeltaMasterFile( pnRevisionIndex, puRevisionDelta )
								Constructs the original file based on the master/delta revisions.
								
								Parameter		Type			Description
								pnRevisionIndex	Number			Starting index position of the revision to reconstruct
								puRevisionDelta	cfcTMProjectModuleRevision	The revision to reconstruct
								
								Return value :
								Boolean = TRUE if the function was ok, FALSE otherwise
						Returns
							Boolean:
						Parameters
							Number: pnRevisionIndex
							FunctionalVar: puRevisionDelta
								Class: cfcTMProjectModuleRevision
						Static Variables
						Local variables
							FunctionalVar: uRevisionPrev
								Class: cfcTMProjectModuleRevision
							FunctionalVar: uRevisionMaster
								Class: cfcTMProjectModuleRevision
							Number: nMasterIndex
							Boolean: bMasterFound
							Number: nCount
							Number: nModuleID
							String: sMasterFile
							String: sDeltaFile
							String: sTargetFile
							String: sErrorMsg
							Number: nRet
						Actions
							If puRevisionDelta.bivIsDelta		! Delta revisions can be reconstructed
								Call guGlobals.Trace( EVENT_INFORMATION, "(ConstructDeltaMasterFile) Revision is a delta. Construct the contents using the master revision..." )
								Call guGlobals.SetStatusTextDetailPrefix( "DELTA", puRevisionDelta.sivFileName )
								Set nModuleID = puRevisionDelta.nivModuleID
								! First find the master file which is a revision in future which is not a delta
								Set nCount = pnRevisionIndex + 1
								While nCount < nivTotalRevisions
									If uaivRevision[nCount].nivModuleID = nModuleID AND NOT uaivRevision[nCount].bivIsDelta
										! The found master is a full source file and wil be used to start the reconstruction
										Set bMasterFound = TRUE
										Set nMasterIndex = nCount
										Break
									Set nCount = nCount + 1
								If bMasterFound
									Set uRevisionMaster = uaivRevision[nMasterIndex]
									! First extract the master revision to file
									Set sMasterFile = guGlobals.GetTom2GitTempFolder(  ) || "Master" || SalNumberToStrX( uRevisionMaster.nivRevisionNo, 0 ) || ".dat"
									If uRevisionMaster.ExportTomToTempFile( sMasterFile, sErrorMsg )
										! Now traverse back in time and for each delta available, reconstruct the original file. This is done up until the curent revision is processed.
										While GetPreviousRevisionByRevisionNr( uRevisionMaster, uRevisionPrev ) AND uRevisionPrev.nivRevisionNo >= puRevisionDelta.nivRevisionNo
											Set sDeltaFile = guGlobals.GetTom2GitTempFolder(  ) || "Delta" || SalNumberToStrX( uRevisionPrev.nivRevisionNo, 0 ) || ".dat"
											! Extract the delta file
											If uRevisionPrev.ExportTomToTempFile( sDeltaFile, sErrorMsg )
												! Now we have a delta file and a master file. Reconstruct the original file using original TOM dll method
												Set sTargetFile = guGlobals.GetTom2GitTempFolder(  ) || "Target" || SalNumberToStrX( uRevisionPrev.nivRevisionNo, 0 ) || ".dat"
												Set nRet = DIF_Apply( sMasterFile, sDeltaFile, sTargetFile, hWndNULL, 0 )
												If nRet = 0
													Call guGlobals.Trace( EVENT_INFORMATION, "(ConstructDeltaMasterFile) Reconstruction target file OK : " ||  sTargetFile )
												Else
													Call guGlobals.Trace( EVENT_ERROR, "(ConstructDeltaMasterFile) Error reconstructing target file : " ||  sTargetFile )
												! Now we have a target file. The master file and the delta file are not needed anymore
												Call VisFileDelete( sDeltaFile )
												Call VisFileDelete( sMasterFile )
												! Now the target will become the master and we continue using the previous delta when available
												Set sMasterFile = sTargetFile
												Set uRevisionMaster = uRevisionPrev
											Else
												Return FALSE
											Set nCount = nCount - 1
										! Hold the master file in the revision object to later on it will be used to be copied to the temp file prior to export to GIT
										Set puRevisionDelta.sivDeltaMasterFile = sMasterFile
										Return TRUE
									Else
										! No master no delta reconstruction possible
										Return FALSE
								Else
									! Eh, no master? This means that all delta's can not be reconstructed and this must fail here. DB corruption?
									Call guGlobals.Trace( EVENT_ERROR, "(ConstructDeltaMasterFile) Master file not found. Delta construction is not possible" )
									Return FALSE
							Else
								Return TRUE
					Function: __GetFolderOnID
						Description:
						Returns
							Boolean:
						Parameters
							Number: pnID
							FunctionalVar: rpuFolder
								Class: cfcTMProjectFolder
						Static Variables
						Local variables
							Number: nCount
						Actions
							Set nCount = 0
							While nCount < nivTotalFolders
								If uaivFolder[nCount].nivFolderID = pnID
									Set rpuFolder = uaivFolder[nCount]
									Return TRUE
								Set nCount = nCount + 1
							Return FALSE
					Function: __GetFolderOnName
						Description:
						Returns
							Boolean:
						Parameters
							String: psFolder
							FunctionalVar: rpuFolder
								Class: cfcTMProjectFolder
						Static Variables
						Local variables
							Number: nCount
						Actions
							Set psFolder = SalStrUpperX( psFolder )
							Set nCount = 0
							While nCount < nivTotalFolders
								If SalStrUpperX( uaivFolder[nCount].sivFolderName ) = psFolder
									Set rpuFolder = uaivFolder[nCount]
									Return TRUE
								Set nCount = nCount + 1
							Return FALSE
					Function: __LoadProjectModules
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							String: sSql
							Boolean: bReturn
							Number: nRet
						Actions
							Call SalArraySetUpperBound( uaivModule, 1, -1 )
							Set nivTotalModules = 0
							If guGlobals.GetSqlHandle(  )
								Set sSql = "
										SELECT	PM.MODULE_ID, M.FILENAME, PM.FOLDER_ID, M.STORE_DELTA, M.COMPRESS_SOURCE, M.MODIFIED_BY, M.LAST_REVISION_NO
										FROM	TMADM.PROJECT_MODULES PM,
											TMADM.MODULE M
										WHERE	PM.PROJECT_CODE = :sivProjectCode
										AND	M.MODULE_ID = PM.MODULE_ID
										AND	M.IS_STARTER = 0 AND M.IS_MODEL = 0
										INTO	:uaivModule[nivTotalModules].nivModuleID,
											:uaivModule[nivTotalModules].sivFileName,
											:uaivModule[nivTotalModules].nivFolderID,
											:uaivModule[nivTotalModules].bivStoreDelta,
											:uaivModule[nivTotalModules].bivCompressSource,
											:uaivModule[nivTotalModules].sivModifiedBy,
											:uaivModule[nivTotalModules].nivLastRevisionNo
										ORDER BY M.FILENAME
										"
								If SqlPrepareAndExecute( guGlobals.GetSqlHandle(  ), sSql )
									While SqlFetchNext( guGlobals.GetSqlHandle(  ), nRet )
										Set nivTotalModules = nivTotalModules + 1
									Set bReturn = TRUE
							Return bReturn
					Function: __LoadProjectFolders
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							String: sSql
							Boolean: bReturn
							Number: nRet
						Actions
							Call SalArraySetUpperBound( uaivFolder, 1, -1 )
							Set nivTotalFolders = 0
							If guGlobals.GetSqlHandle(  )
								Set sSql = "
										SELECT	FOLDER_ID, PARENT_FOLDER_ID, FOLDER_NAME
										FROM	TMADM.FOLDERS
										WHERE	PROJECT_CODE =  :sivProjectCode
										INTO	:uaivFolder[nivTotalFolders].nivFolderID,
											:uaivFolder[nivTotalFolders].nivParentFolderID,
											:uaivFolder[nivTotalFolders].sivFolderName
										"
								If SqlPrepareAndExecute( guGlobals.GetSqlHandle(  ), sSql )
									While SqlFetchNext( guGlobals.GetSqlHandle(  ), nRet )
										If uaivFolder[nivTotalFolders].nivFolderID = 0
											Set uaivFolder[nivTotalFolders].sivFolderName = ""
										Set nivTotalFolders = nivTotalFolders + 1
									Set bReturn = TRUE
							Return bReturn
			Functional Class: cfcTMProjectFolder
				Description:
				Derived From
				Class Variables
				Instance Variables
					Number: nivFolderID
					Number: nivParentFolderID
					String: sivFolderName
				Constructor/Destructor
				Functions
			Functional Class: cfcTMStaffMember
				Description:
				Derived From
				Class Variables
				Instance Variables
					String: sivStaffCode
					String: sivFirstname
					String: sivSurname
					String: sivEmail
					String: sivFullName
					Boolean: bivActive
					String: sivExportName
					String: sivExportEmail
				Constructor/Destructor
				Functions
					Function: SetSignature
						Description:
						Returns
						Parameters
							Number: pnMode		! 0=reset all/initial, 1=CodeToName, 2=force email, 3=code2email, 4=name 2 email
							String: psEmailBase
						Static Variables
						Local variables
						Actions
							Select Case pnMode
								Case ncSIG_RESET_INIT
									Set sivExportName = sivFullName
									Set sivExportEmail = ""
									Break
								Case ncSIG_CODE2NAME
									If NOT sivExportName
										Set sivExportName = sivStaffCode
									Break
								Case ncSIG_FORCE_EMAIL
									If NOT sivExportEmail
										Set sivExportEmail = psEmailBase
									Break
								Case ncSIG_CODE2EMAIL
									If NOT sivExportEmail
										Set sivExportEmail = sivStaffCode || psEmailBase
									Break
								Case ncSIG_NAME2EMAIL
									If sivExportName
										Set sivExportEmail = VisStrSubstitute( sivExportName, " ", "" ) || psEmailBase
									Break
					Function: GetValidationMsg
						Description:
						Returns
							String:
						Parameters
						Static Variables
						Local variables
							String: sMsg
						Actions
							If NOT sivExportName OR NOT sivExportEmail
								Set sMsg = sivStaffCode || ": missing  "
								If NOT sivExportName
									Set sMsg = sMsg || "<NAME> "
								If NOT sivExportEmail
									Set sMsg = sMsg || "<EMAIL> "
							Return sMsg
			Functional Class: cfcTMModule
				Description:
				Derived From
				Class Variables
				Instance Variables
					Number: nivModuleID
					Number: nivFolderID
					Number: nivLastRevisionNo
					String: sivOwnerProjectCode
					String: sivFileName
					String: sivDescription
					String: sivModifiedBy
					Boolean: bivCompressSource
					Boolean: bivStoreDelta
					Boolean: bivIsStarter
				Constructor/Destructor
				Functions
			Functional Class: cfcTMProjectModuleRevision
				Description: ;
				Derived From
				Class Variables
				Instance Variables
					Date/Time: dtivRevisionDateTime		! TOM checkin datetime
					Number: nivRevisionNo
					Number: nivModuleID
					Number: nivFolderID
					String: sivRevisionLabel
					String: sivFileName
					String: sivRelativePath
					String: sivFullPath
					String: sivFullFilePath
					String: sivDescription
					Number: nivSourceID
					Boolean: bivIsDeleted
					Boolean: bivIsDelta
					Boolean: bivIsCompressed
					Number: nivUncompressedSize
					Number: nivCompressedSize
					String: sivModifiedBy
					String: sivStaffMember
					String: sivBlobBuffer
					Date/Time: dtivSourceDateTime		! This is the original filedatetime
					Number: nivBlobID
					String: sivStorageMethod
					String: sivProjectFileLocation
					String: sivDeltaMasterFile
					Boolean: bivDoNotExport
					Boolean: bivIsLastRevision
				Constructor/Destructor
				Functions
					Function: GetMsgText
						Description: Uses the message template and puts in the requested items for a commit.
						Returns
							String:
						Parameters
							FunctionalVar: puProject
								Class: cfcTMProject
						Static Variables
						Local variables
							String: sMsg
							String: sCurrentDate
							String: sRevisionDate
							String: sFileDate
							FunctionalVar: uSettings
								Class: cfcTMSettings
						Actions
							Call guGlobals.GetSettings( uSettings )
							Set sMsg = uSettings.GetMessageText(  )
							Call SalDateToStr( SalDateCurrent(  ), sCurrentDate )
							Call SalDateToStr( dtivRevisionDateTime, sRevisionDate )
							If dtivSourceDateTime
								Call SalDateToStr( dtivSourceDateTime, sFileDate )
							Set sMsg = VisStrSubstitute( sMsg, "{BLOBID}", SalNumberToStrX( nivBlobID, 0 ) )
							Set sMsg = VisStrSubstitute( sMsg, "{CURRENTDATETIME}", sCurrentDate )
							Set sMsg = VisStrSubstitute( sMsg, "{DATABASE}", SqlDatabase )
							Set sMsg = VisStrSubstitute( sMsg, "{DESCRIPTION}", sivDescription )
							Set sMsg = VisStrSubstitute( sMsg, "{FILE}", sivFileName )
							Set sMsg = VisStrSubstitute( sMsg, "{FILEPATH}", sivFullFilePath )
							Set sMsg = VisStrSubstitute( sMsg, "{FILESIZE}", SalNumberToStrX( nivUncompressedSize, 0 ) )
							Set sMsg = VisStrSubstitute( sMsg, "{ISCOMPRESSED}", SalNumberToStrX( bivIsCompressed, 0 ) )
							Set sMsg = VisStrSubstitute( sMsg, "{LABEL}", sivRevisionLabel )
							Set sMsg = VisStrSubstitute( sMsg, "{MODIFIEDBY}", sivModifiedBy )
							Set sMsg = VisStrSubstitute( sMsg, "{MODIFIEDBYNAME}", sivStaffMember )
							Set sMsg = VisStrSubstitute( sMsg, "{MODIFIEDDATETIME}", sRevisionDate )
							Set sMsg = VisStrSubstitute( sMsg, "{MODULEID}", SalNumberToStrX( nivModuleID, 0 ) )
							Set sMsg = VisStrSubstitute( sMsg, "{ORIGINALFILEDATETIME}", sFileDate )
							Set sMsg = VisStrSubstitute( sMsg, "{PATH}", sivFullPath )
							Set sMsg = VisStrSubstitute( sMsg, "{PROJECTCODE}", puProject.sivProjectCode )
							Set sMsg = VisStrSubstitute( sMsg, "{PROJECTNAME}", puProject.sivProjectName )
							Set sMsg = VisStrSubstitute( sMsg, "{PROJECTPATH}", puProject.sivProjectPath )
							Set sMsg = VisStrSubstitute( sMsg, "{REVISIONNUMBER}", SalNumberToStrX( nivRevisionNo, 0 ) )
							Set sMsg = VisStrSubstitute( sMsg, "{SOURCEID}", SalNumberToStrX( nivSourceID, 0 ) )
							Set sMsg = VisStrSubstitute( sMsg, "{STORAGEMETHOD}", sivStorageMethod )
							Return sMsg
					Function: ExportToGit
						Description:
						Returns
							Boolean:
						Parameters
							FunctionalVar: puProject
								Class: cfcTMProject
							Number: pnRepoPtr
							String: psGitRepoRootModePath
							Boolean: pbHasPreviousRevision
							FunctionalVar: puPreviousRevision
								Class: cfcTMProjectModuleRevision
							Boolean: pbNeedsCommit
						Static Variables
						Local variables
							String: sTomTempFile
							String: sCurrentRepoPath
							String: sCurrentRepoFilePath
							String: sPreviousRepoPath
							String: sPreviousRepoFilePath
							String: sErrorMsg
							String: sDate
							Boolean: bFileCasingChanged
							Boolean: bPathCasingChanged
							Boolean: bPathLocationChanged
						Actions
							If ExportTomToTempFile( guGlobals.GetTempTomFile(  ), sErrorMsg )
								Call guGlobals.SetStatusTextDetailPrefix( "COPY", sivFileName )
								! Here we have a temp file to be copied
								Set sCurrentRepoPath	= psGitRepoRootModePath || sivFullPath
								Set sCurrentRepoFilePath	= psGitRepoRootModePath || sivFullFilePath
								! First create the destination folder
								If NOT VisDosExist( sCurrentRepoPath )
									Call VisDosMakeAllDir( sCurrentRepoPath )
									If VisDosExist( sCurrentRepoPath )
										Call guGlobals.Trace( EVENT_INFORMATION, "(ExportToGit) Folder created: " || sCurrentRepoPath )
									Else
										Call guGlobals.Trace( EVENT_ERROR, "(ExportToGit) Failed to create folder: " || sCurrentRepoPath )
										Return FALSE
								!
								! Check if the new revision was moved or renamed by comparing the previous revision location
								If pbHasPreviousRevision
									! Check if the file was moved and/or renamed by comparing the previous revision
									If sivFullFilePath != puPreviousRevision.sivFullFilePath		! The file has been moved and/or renamed
										Set sPreviousRepoPath	= psGitRepoRootModePath || puPreviousRevision.sivFullPath
										Set sPreviousRepoFilePath	= psGitRepoRootModePath || puPreviousRevision.sivFullFilePath
										! First check if the filename got different casing. Then we need to rename the file instead of copy
										Set bFileCasingChanged = SalStrUpperX( sivFileName ) = SalStrUpperX( puPreviousRevision.sivFileName ) AND sivFileName != puPreviousRevision.sivFileName
										Set bPathCasingChanged = SalStrUpperX( sivFullPath ) = SalStrUpperX( puPreviousRevision.sivFullPath ) AND sivFullPath != puPreviousRevision.sivFullPath
										If bPathCasingChanged
											Set bPathLocationChanged = FALSE
										Else
											Set bPathLocationChanged = SalStrUpperX( sivFullPath ) != SalStrUpperX( puPreviousRevision.sivFullPath )
										!
										If NOT bPathLocationChanged AND bFileCasingChanged
											Call VisFileRename( sPreviousRepoFilePath, sCurrentRepoFilePath )
											Call guGlobals.Trace( EVENT_INFORMATION, "(ExportToGit) Revision was renamed or moved in TOM. " || sPreviousRepoFilePath || "->" || sCurrentRepoFilePath  )
											! The file is moved/renamed so do a commit
											!
											Call __GitCommit( puProject, pnRepoPtr, "File was renamed.
													Previous name: " || puPreviousRevision.sivFileName || "
													New name: " || sivFileName, pbNeedsCommit )
										Else
											If VisDosExist( sCurrentRepoPath || puPreviousRevision.sivFullFilePath )		! Here the file is already in the destination. This is an issue/error.
												Call guGlobals.Trace( EVENT_INFORMATION, "(ExportToGit) Revision is already in the destination. This could be an issue/error: " ||  sCurrentRepoPath || puPreviousRevision.sivFullFilePath)
											If VisDosExist( sPreviousRepoFilePath )
												! First mark the move or rename as separate commit in Git. So we first have to move the previous revision to the new location
												If SalFileCopy( sPreviousRepoFilePath, sCurrentRepoFilePath, TRUE ) = FILE_CopyOK
													Call guGlobals.Trace( EVENT_INFORMATION, "(ExportToGit) Revision moved/renamed. " ||  sPreviousRepoFilePath || "->" || sCurrentRepoFilePath )
													Call VisFileDelete( sPreviousRepoFilePath )
													If VisDosExist( sPreviousRepoFilePath )
														Call guGlobals.Trace( EVENT_ERROR, "(ExportToGit) Failed to delete previous revision. " ||  sPreviousRepoFilePath )
														Return FALSE
												Else
													Call guGlobals.Trace( EVENT_ERROR, "(ExportToGit) Failed to move/rename revision. " ||  sPreviousRepoFilePath || "->" || sCurrentRepoFilePath )
													Return FALSE
												!
												! The file is moved/renamed so do a commit
												!
												Call __GitCommit( puProject, pnRepoPtr, "File was moved and/or renamed
														Previous location: " || puPreviousRevision.sivFullFilePath || "
														New location: " || puPreviousRevision.sivFullFilePath, pbNeedsCommit )
											Else
												! Hey. That is strange. We expect the previous revision to be there. What to do here?
												Call guGlobals.Trace( EVENT_INFORMATION, "(ExportToGit) Revision is not present in the destination. This could be an issue/error: " ||  sPreviousRepoFilePath )
									Else
										Call guGlobals.Trace( EVENT_INFORMATION, "(ExportToGit) Previous revision is available but was not moved or renamed in TOM" )
								Else
									Call guGlobals.Trace( EVENT_INFORMATION, "(ExportToGit) No previous revision available" )
								!
								Set sTomTempFile = guGlobals.GetTempTomFile(  )
								If SalFileCopy( sTomTempFile, sCurrentRepoFilePath, TRUE ) = FILE_CopyOK
									Call guGlobals.Trace( EVENT_INFORMATION, "(ExportToGit) Copy temp file to revision. " ||  sTomTempFile || "->" || sCurrentRepoFilePath )
									Call SalFileSetDateTime(sCurrentRepoFilePath, dtivSourceDateTime )
									Call SalDateToStr( dtivSourceDateTime, sDate )
									Call guGlobals.Trace( EVENT_INFORMATION, "(ExportToGit) Revision file date/time set to: " ||  sDate )
									! The file is copied to repo location. Now git add all and commit
									If __GitCommit( puProject, pnRepoPtr, "", pbNeedsCommit )
										Return TRUE
									Else
										Return FALSE
								Else
									Call guGlobals.Trace( EVENT_ERROR, "(ExportToGit) Failed to copy temp file to revision. " ||  sTomTempFile || "->" || sCurrentRepoFilePath )
									Return FALSE
							Else
								! Trace already done
								Return FALSE
					Function: Snapshot
						Description:
						Returns
							Boolean:
						Parameters
							FunctionalVar: puProject
								Class: cfcTMProject
							Number: pnRepoPtr
							String: psGitRepoRootModePath
							Boolean: pbHasPreviousRevision
							FunctionalVar: puPreviousRevision
								Class: cfcTMProjectModuleRevision
							Boolean: pbDoNotCommit
						Static Variables
						Local variables
							String: sTomTempFile
							String: sCurrentRepoPath
							String: sCurrentRepoFilePath
							String: sErrorMsg
							String: sDate
						Actions
							Call guGlobals.SetStatusTextDetailPrefix( "SNAPSHOT", sivFileName )
							! Here we have a temp file to be copied
							Set sCurrentRepoPath	= psGitRepoRootModePath || sivFullPath
							Set sCurrentRepoFilePath	= psGitRepoRootModePath || sivFullFilePath
							! First create the destination folder
							If NOT bivDoNotExport
								If NOT VisDosExist( sCurrentRepoPath )
									Call VisDosMakeAllDir( sCurrentRepoPath )
									If VisDosExist( sCurrentRepoPath )
										Call guGlobals.Trace( EVENT_INFORMATION, "(Snapshot) Folder created: " || sCurrentRepoPath )
									Else
										Call guGlobals.Trace( EVENT_ERROR, "(Snapshot) Failed to create folder: " || sCurrentRepoPath )
										Return FALSE
							!
							! Check if the new revision was moved or renamed by comparing the previous revision location
							If pbHasPreviousRevision
								Set puPreviousRevision.bivDoNotExport = TRUE
							!
							If bivDoNotExport
								Return TRUE
							Else
								If VisDosExist( sCurrentRepoFilePath )
									Return TRUE
								Else
									If ExportTomToTempFile( guGlobals.GetTempTomFile(  ), sErrorMsg )
										Call guGlobals.SetStatusTextDetailPrefix( "COPY", sivFileName )
										Set sTomTempFile = guGlobals.GetTempTomFile(  )
										If SalFileCopy( sTomTempFile, sCurrentRepoFilePath, TRUE ) = FILE_CopyOK
											Call guGlobals.Trace( EVENT_INFORMATION, "(Snapshot) Copy temp file to revision. " ||  sTomTempFile || "->" || sCurrentRepoFilePath )
											! The file is copied to repo location. Now git add all and commit
											Call SalFileSetDateTime(sCurrentRepoFilePath, dtivSourceDateTime )
											Call SalDateToStr( dtivSourceDateTime, sDate )
											Call guGlobals.Trace( EVENT_INFORMATION, "(Snapshot) Revision file date/time set to: " ||  sDate )
											Set bivDoNotExport = TRUE
											Return TRUE
										Else
											Call guGlobals.Trace( EVENT_ERROR, "(Snapshot) Failed to copy temp file to revision. " ||  sTomTempFile || "->" || sCurrentRepoFilePath )
											Return FALSE
									Else
										! Trace already done
										Return FALSE
					Function: ExportTomToTempFile
						Description:
						Returns
							Boolean:
						Parameters
							String: psTempFile
							Receive String: rpsErrorMsg
						Static Variables
						Local variables
							String: sTomFile
							Number: nFileSize
							Number: nBytesRead
							Number: nBytesToWrite
							File Handle: hFile
							String: sTempTomFile
						Actions
							Set rpsErrorMsg = ""
							Set sTempTomFile = psTempFile
							If VisDosExist( sTempTomFile )
								Call VisFileDelete( sTempTomFile )
							!
							If sivDeltaMasterFile		! Ah, this revision is a delta revision so earlier the master file was created
								! The delta file is ready to be used so copy it to the temp file
								If SalFileCopy( sivDeltaMasterFile, sTempTomFile, TRUE ) = FILE_CopyOK
									Call guGlobals.Trace( EVENT_INFORMATION, "(ExportTomToTempFile) Master file copied from: " || sivDeltaMasterFile || " to temp : " || sTempTomFile )
									Call VisFileSetAttribute( sTempTomFile, FA_ReadOnly, FALSE ) 
									! We do not need the master file anymore so delete
									Call VisFileDelete( sivDeltaMasterFile )
									Set sivDeltaMasterFile = ""
									Return TRUE
								Else
									Set rpsErrorMsg = "(ExportTomToTempFile) Failed to copy master file from: " || sivDeltaMasterFile || " to temp : " || sTempTomFile
									Call guGlobals.Trace( EVENT_ERROR, rpsErrorMsg )
									Return FALSE
							Else
								If sivStorageMethod = "F"
									Call guGlobals.SetStatusTextDetailPrefix( "COPY", sivFileName )
									Call PALPathAddBackslash( sivProjectFileLocation )
									Set sTomFile = SalNumberToStrX( nivSourceID, 0 )
									Set sTomFile = SalStrRepeatX( "0", 8 - SalStrLength( sTomFile ) ) || sTomFile || "._pf"
									Set sTomFile = sivProjectFileLocation || sTomFile 
									If NOT VisDosExist( sTomFile )
										Set rpsErrorMsg = "(ExportTomToTempFile) File does not exist: " || sTomFile
										Call guGlobals.Trace( EVENT_ERROR, rpsErrorMsg )
										Return FALSE
									!
									If bivIsCompressed
										Set nFileSize = VisFileGetSize( sTomFile )
										If NOT SalFileOpen( hFile, sTomFile, 0 | 65536 )
											Set rpsErrorMsg = "(ExportTomToTempFile) Failed to open compressed file: " || sTomFile
											Call guGlobals.Trace( EVENT_ERROR, rpsErrorMsg )
											Return FALSE
										Set sivBlobBuffer = ""
										Call SalSetBufferLength( sivBlobBuffer, nFileSize )
										Set nBytesRead = SalFileRead( hFile, sivBlobBuffer, nFileSize )
										Call SalFileClose( hFile )
										If nBytesRead != nFileSize
											Call guGlobals.Trace( EVENT_ERROR, "(ExportTomToTempFile) Uncompressed size is invalid of file: " || sTomFile )
											Return FALSE
										Call SalStrUncompress( sivBlobBuffer )
										Call guGlobals.Trace( EVENT_INFORMATION, "(ExportTomToTempFile) Uncompressed file: " || sTomFile )
										!
										! We have the blob now, continue next to write it to file
									Else
										! This is the simplest situation. Only copy the TOM file
										If SalFileCopy( sTomFile, sTempTomFile, TRUE ) = FILE_CopyOK
											! Finished. Just return
											Call VisFileSetAttribute( sTempTomFile, FA_ReadOnly, FALSE ) 
											Call guGlobals.Trace( EVENT_INFORMATION, "(ExportTomToTempFile) Copied delta file from: " || sTomFile || " to temp : " || sTempTomFile )
											Return TRUE
										Else
											Call guGlobals.Trace( EVENT_ERROR, "(ExportTomToTempFile) Failed to copy delta file from: " || sTomFile || " to temp : " || sTempTomFile )
											Return FALSE
								Else
									Call guGlobals.SetStatusTextDetailPrefix( "EXTRACT", sivFileName )
									! Get blob en save to temp file
									If NOT __GetBlobBufferFromDB( )
										Return FALSE
								!
								! We have a blob to be saved to temp file here
								!
								Call guGlobals.SetStatusTextDetailPrefix( "SAVE", sivFileName )
								Set nBytesToWrite = SalGetBufferLength( sivBlobBuffer ) - 1
								If SalFileOpen( hFile, sTempTomFile, 4096 | 1 | 65536 )
									Set nFileSize = SalFileWrite( hFile, sivBlobBuffer, nBytesToWrite )
									Call SalFileClose( hFile )
									Set sivBlobBuffer = ""
									Call guGlobals.Trace( EVENT_INFORMATION, "(ExportTomToTempFile) File saved to disk: " || sTempTomFile )
									Return TRUE
								Else
									Call guGlobals.Trace( EVENT_ERROR, "(ExportTomToTempFile) Failed to save file to disk: " || sTempTomFile )
									Set sivBlobBuffer = ""
									Return FALSE
					Function: __GetBlobBufferFromDB
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							String: sSql
							Binary: binBuffer
							Boolean: bReturn
							Number: nRet
							Number: nLongBufferSize
							Number: nHandle
						Actions
							Set sivBlobBuffer = ""
							If nivBlobID > 0 AND guGlobals.GetSqlHandle(  )
								If bivIsCompressed
									Set nLongBufferSize = nivCompressedSize
								Else
									Set nLongBufferSize = nivUncompressedSize
								If PALSqlSetLongBuffer( nLongBufferSize )
									Set sSql = "
											SELECT	BLOB_COLUMN
											FROM	TMADM.BLOB_TABLE
											WHERE	BLOB_ID = :nivBlobID
											INTO	:binBuffer
											"
									If SqlPrepareAndExecute( guGlobals.GetSqlHandle(  ), sSql )
										If SqlFetchNext( guGlobals.GetSqlHandle(  ), nRet )
											Set nHandle = SalHBinaryToNumber( binBuffer )
											Set sivBlobBuffer = SalNumberToHString( nHandle )
											Set binBuffer = BINARY_Null
											Call PALSqlResetLongBuffer(  )
											If bivIsCompressed
												Call SalStrUncompress( sivBlobBuffer )
												Call guGlobals.Trace( EVENT_INFORMATION, "(GetBlobBufferFromDB) Blob fetched from from DB -> blob uncompressed OK" )
											Else
												Call guGlobals.Trace( EVENT_INFORMATION, "(GetBlobBufferFromDB) Blob fetched from from DB -> OK" )
											Set bReturn = TRUE
										Else
											Call guGlobals.Trace( EVENT_ERROR, "(GetBlobBufferFromDB) Failed to select blob from DB -> FetchNext error" )
									Else
										Call guGlobals.Trace( EVENT_ERROR, "(GetBlobBufferFromDB) Failed to select blob from DB -> PrepareAndExecute error" )
								Else
									Call guGlobals.Trace( EVENT_ERROR, "(GetBlobBufferFromDB) Failed to set DB parameter DBP_LONGBUFFER")
							Return bReturn
					Function: __GitCommit
						Description:
						Returns
							Boolean:
						Parameters
							FunctionalVar: puProject
								Class: cfcTMProject
							Number: pnRepoPtr
							String: psExtraCommitMsg
							Boolean: pbNeedsCommit
						Static Variables
						Local variables
							FunctionalVar: uGit
								Class: cfcLibGit2TDExt
							Number: nIndexPtr
							Number: nRet
							String: sOIDTree
							String: sMsg
							Boolean: bOk
							FunctionalVar: uSettings
								Class: cfcTMSettings
							String: sSigAuthorName
							String: sSigAuthorEmail
							Date/Time: dtAuthorDate
							String: sSigCommitterName
							String: sSigCommitterEmail
							Date/Time: dtCommitterDate
							FunctionalVar: uStaffMember
								Class: cfcTMStaffMember
							String: sTraceMsg
							String: sDate
						Actions
							If pbNeedsCommit AND NOT guGlobals.bivDryRun
								Call guGlobals.SetStatusTextDetailPrefix( "COMMIT", sivFileName )
								Call guGlobals.GetSettings( uSettings )
								If uGit.GIT_repository_index( pnRepoPtr, nIndexPtr, nRet )
									If uGit.GIT_index_add_all( nIndexPtr, ".", nRet )
										If uGit.GIT_index_write( nIndexPtr, nRet )
											If uGit.GIT_index_write_tree( nIndexPtr, sOIDTree, nRet )
												! Author >>>
												If NOT guRepo.GetStaffMember( sivModifiedBy, uStaffMember )
													Set uStaffMember.sivExportName = sivModifiedBy
													Set uStaffMember.sivExportEmail = sivModifiedBy || "@company.com"
												If uSettings.bivSignatureAuthorOverrule
													Set sSigAuthorName = uSettings.sivSignatureAuthorName
													Set sSigAuthorEmail = uSettings.sivSignatureAuthorEmail
												Else
													If uSettings.bivSignatureAuthorCode
														Set sSigAuthorName = sivModifiedBy
													Else
														Set sSigAuthorName = uStaffMember.sivExportName
													Set sSigAuthorEmail = uStaffMember.sivExportEmail
												If uSettings.bivSignatureAuthorCurrentDate
													Set dtAuthorDate = SalDateCurrent(  )
												Else
													Set dtAuthorDate = dtivRevisionDateTime
												! Committer >>>
												If uSettings.bivSignatureCommitterOverrule
													Set sSigCommitterName = uSettings.sivSignatureCommitterName
													Set sSigCommitterEmail = uSettings.sivSignatureCommitterEmail
												Else
													If uSettings.bivSignatureCommitterCode
														Set sSigCommitterName = sivModifiedBy
													Else
														Set sSigCommitterName = uStaffMember.sivExportName
													Set sSigCommitterEmail = uStaffMember.sivExportEmail
												If uSettings.bivSignatureCommitterCurrentDate
													Set dtCommitterDate = SalDateCurrent(  )
												Else
													Set dtCommitterDate = dtivRevisionDateTime
												! Message
												If psExtraCommitMsg
													Set sMsg = psExtraCommitMsg
												Else
													Set sMsg = GetMsgText( puProject )
												!
												Call SalDateToStr( dtAuthorDate, sDate )
												Set sTraceMsg = "Git commit:" || scNEWLINE || "Author=" || sSigAuthorName || "," || sSigAuthorEmail || "," || sDate || scNEWLINE
												Call SalDateToStr( dtCommitterDate, sDate )
												Set sTraceMsg = sTraceMsg || "Committer=" || sSigCommitterName || "," || sSigCommitterEmail || "," || sDate || scNEWLINE
												Set sTraceMsg = sTraceMsg || "Msg=" || sMsg
												Set bOk = uGit.TD_Commit( pnRepoPtr , sOIDTree, sSigAuthorName, sSigAuthorEmail, dtAuthorDate, sSigCommitterName, sSigCommitterEmail, dtCommitterDate, sMsg )
												If bOk
													Call guGlobals.Trace( EVENT_INFORMATION, "(GitCommit) " || sTraceMsg)
												Else
													Call guGlobals.Trace( EVENT_ERROR,  "(GitCommit) " || sTraceMsg)
											Else
												Call guGlobals.Trace( EVENT_ERROR, "(GitCommit) git_index_write_tree( ) failed")
										Else
											Call guGlobals.Trace( EVENT_ERROR, "(GitCommit) git_index_write( ) failed")
									Else
										Call guGlobals.Trace( EVENT_ERROR, "(GitCommit) git_index_add_all( ) failed")
										Return FALSE
									Call uGit.GIT_index_free( nIndexPtr )
									Return bOk
								Else
									Call guGlobals.Trace( EVENT_ERROR, "(GitCommit) git_repository_index( ) failed")
									Return FALSE
							Else
								Return TRUE
					! Function: SetDummyData
						Description: 
						Returns 
						Parameters 
						Static Variables 
						Local variables 
						Actions 
							Set dtivRevisionDateTime = SalDateCurrent(  ) - 365*2
							Set nivRevisionNo = 1
							Set nivModuleID = 666
							Set nivFolderID = 1
							Set sivRevisionLabel = "Rev 1.1"
							Set sivFileName = "MyApplication.apt"
							Set sivRelativePath = "Applications"
							Set sivFullPath = "Applications"
							Set sivFullFilePath = "Applications\\MyApplication.apt"
							Set sivDescription = "Some fixes for rev 1.1:
									- TestA
									-TestB"
							Set nivSourceID = 123
							Set nivUncompressedSize = 1028
							Set sivModifiedBy = "AM53218"
							Set sivStaffMember = "Dave Rabelink"
							Set dtivSourceDateTime = dtivRevisionDateTime - 1
							Set sivStorageMethod = "F"
							Set sivProjectFileLocation = "W:\\TOM\\REPO\\"
			Functional Class: cfcTMHistorySortADODB
				Description: Helper class to sort revisions on revisiondatetime collected for all selected projects.
						It uses ADODB recordset to store sorting info and sorts the set which is much faster than using TD sorting.
				Derived From
				Class Variables
				Instance Variables
					Number: naivProjectIndex[*]
					Number: naivRevisionIndex[*]
					Number: nivTotal
					Boolean: bivLoaded
					!
					ComProxyVar: uivRecordSet
						Class: ADODB_Recordset
					FunctionalVar: uivFields
						Class: ADODB_Fields
				Constructor/Destructor
				Functions
					Function: GetRevInfo
						Description:
						Returns
							Boolean:
						Parameters
							Number: pnIndex
							Receive Number: rpnProjectIndex
							Receive Number: rpnRevisionIndex
						Static Variables
						Local variables
						Actions
							If pnIndex > -1 AND pnIndex < nivTotal
								Set rpnProjectIndex = naivProjectIndex[pnIndex]
								Set rpnRevisionIndex = naivRevisionIndex[pnIndex]
								Return TRUE
							Else
								Return FALSE
					Function: CreateADODBRecordSet
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
							FunctionalVar: uOpt
								Class: Variant
							Boolean: bOk
						Actions
							Call uOpt.MakeOptional(  )
							If uivRecordSet.Create(  )
								If uivRecordSet.PropGetFields( uivFields )
									Call uivFields.Append( "SORTITEM", ADODB_DataTypeEnum_adVarWChar, 100, ADODB_FieldAttributeEnum_adFldUnspecified, uOpt )
									Call uivRecordSet.PropSetCursorType( ADODB_CursorTypeEnum_adOpenKeyset )
									Call uivRecordSet.PropSetCursorLocation( ADODB_CursorLocationEnum_adUseClient )
									Call uivRecordSet.PropSetLockType( ADODB_LockTypeEnum_adLockReadOnly )
									Set bOk = uivRecordSet.Open( uOpt, uOpt, ADODB_CursorTypeEnum_adOpenKeyset, ADODB_LockTypeEnum_adLockPessimistic, 1 )
									If NOT bOk
										Call uivFields.Detach(  )
								If NOT bOk
									Call uivRecordSet.Release(  )
									Call uivRecordSet.Detach(  )
							Return bOk
					Function: AddToADODBRecordSet
						Description:
						Returns
						Parameters
							Number: pnIndexProject
							Number: pnIndexRev
							Date/Time: pdtDateTime
							Boolean: pbUseADODB
						Static Variables
						Local variables
							String: sElement
							String: sSortLine
							FunctionalVar: uOpt
								Class: Variant
							FunctionalVar: uIndex
								Class: Variant
							FunctionalVar: uString
								Class: Variant
							FunctionalVar: uField
								Class: ADODB_Field
						Actions
							If pbUseADODB
								Call uOpt.MakeOptional(  )
								Call SalDateToStr( pdtDateTime, sElement )
								Set sSortLine = sElement || "#" || SalFmtFormatNumber( pnIndexProject, "000" ) || "#" || SalFmtFormatNumber( pnIndexRev, "000000" )
								If uivRecordSet.AddNew( uOpt, uOpt )
									Call uIndex.SetNumber( 0, VT_I4 )
									If uivFields.PropGetItem( uIndex, uField )
										Call uString.SetString( sSortLine )
										Call uField.PropSetValue( uString )
										Set nivTotal = nivTotal + 1
							Else
								Set naivProjectIndex[nivTotal] = pnIndexProject
								Set naivRevisionIndex[nivTotal] = pnIndexRev
								Set nivTotal = nivTotal + 1
					Function: SortADODBRecordSet
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							Number: nCount
							FunctionalVar: uIndex
								Class: Variant
							FunctionalVar: uString
								Class: Variant
							String: sValue
							FunctionalVar: uField
								Class: ADODB_Field
						Actions
							Call uivRecordSet.PropSetSort( "SORTITEM ASC" )
							Call uivRecordSet.MoveFirst(  )
							Call uIndex.SetNumber( 0, VT_I4 )
							Set nCount = 0
							While nCount < nivTotal
								If uivFields.PropGetItem( uIndex, uField )
									Call uField.PropGetValue( uString )
									Call uString.GetString( sValue )
									Set naivProjectIndex[nCount] = SalStrToNumber( SalStrMidX( sValue, 27, 3 ) )
									Set naivRevisionIndex[nCount] = SalStrToNumber( SalStrRightX( sValue, 6 ) )
								Call uivRecordSet.MoveNext(  )
								Set nCount = nCount + 1
					Function: CloseADODBRecordSet
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Call uivRecordSet.Close(  )
							Call uivFields.Detach(  )
							Call uivRecordSet.Release(  )
							Call uivRecordSet.Detach(  )
			Functional Class: cfcTMRootModeSettings
				Description: Holds rootmode setting used by projects.
						Rootmode determines the name and level of root folders in the GIT repository
				Derived From
				Class Variables
				Instance Variables
					Number: nivRootMode
					String: sivCustomFolder
				Constructor/Destructor
				Functions
					Function: GetRootModeNameFromID
						Description:
						Returns
							String:
						Parameters
							Number: pnRootMode
						Static Variables
						Local variables
						Actions
							Select Case pnRootMode
								Case ncTOM2GIT_ROOTMODE_CODE
									Return "Project code"
									Break
								Case ncTOM2GIT_ROOTMODE_NAME
									Return "Project name"
									Break
								Case ncTOM2GIT_ROOTMODE_CUSTOM
									Return "Custom name"
									Break
								Default
									Return ""
									Break
					Function: GetRootModeIDFromName
						Description:
						Returns
							Number:
						Parameters
							String: psName
						Static Variables
						Local variables
						Actions
							If psName = "Project code"
								Return ncTOM2GIT_ROOTMODE_CODE
							Else If psName = "Project name"
								Return ncTOM2GIT_ROOTMODE_NAME
							Else If psName = "Custom name"
								Return ncTOM2GIT_ROOTMODE_CUSTOM
							Else
								Return ncTOM2GIT_ROOTMODE_CODE
					Function: GetRootMode
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Return nivRootMode
					Function: SetRootMode
						Description:
						Returns
						Parameters
							Number: pnRootMode
						Static Variables
						Local variables
						Actions
							Set nivRootMode = pnRootMode
					Function: GetRootModeName
						Description:
						Returns
							String:
						Parameters
						Static Variables
						Local variables
						Actions
							Return GetRootModeNameFromID( nivRootMode )
					Function: GetCustomFolder
						Description:
						Returns
							String:
						Parameters
						Static Variables
						Local variables
						Actions
							Return sivCustomFolder
					Function: SetCustomFolder
						Description:
						Returns
						Parameters
							String: psFolder
						Static Variables
						Local variables
						Actions
							Set sivCustomFolder = psFolder
			Functional Class: cfcTMSettings
				Description: Holds general and specific settings for this application.
						They are saved and loaded from a cfg file.
				Derived From
				Class Variables
				Instance Variables
					String: sivTom2GitWorkFolder
					String: sivEmailBase
					Number: nivDestination		! 1=one repo, 2=multiple repos
					Boolean: bivShowFrozenProjects
					Boolean: bivProcessDeltaFiles
					!
					Boolean: bivSignatureAuthorCode		! 0=Name, 1=code
					Boolean: bivSignatureAuthorCurrentDate	! 0=Original, 1=Today
					Boolean: bivSignatureAuthorOverrule
					String: sivSignatureAuthorName		! Overruled name
					String: sivSignatureAuthorEmail		! Overruled email
					Boolean: bivSignatureCommitterCode		! 0=Name, 1=code
					Boolean: bivSignatureCommitterCurrentDate	! 0=Original, 1=Today
					Boolean: bivSignatureCommitterOverrule
					String: sivSignatureCommitterName		! Overruled name
					String: sivSignatureCommitterEmail		! Overruled email
					!
					String: sivGitIgnoreTemplate			! Full file incl path to template file
					String: sivGitAttributesTemplate		! Full file incl path to template file
					String: sivMessageTextTemplate		! Full file incl path to template file
					String: sivTeamMembersTemplate		! Full file incl path to template file
					!
					String: sivMessageText
					String: sivBranchName			! Initial branch name (eg master or main)
					!
					Number: nivIntervalMode			! Secs, min, hours etc
					Number: nivIntervalValue			! value of interval
					!
					Number: nivLogMode			! Disabled, errors or full
					!
					Boolean: bivPauseOnInit
					Boolean: bivAbortOnError
					String: sivUser
					String: sivDatabase
					String: sivPassword
				Constructor/Destructor
				Functions
					Function: Init
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Call LoadSettings( )
					Function: GetEmailBase
						Description:
						Returns
							String:
						Parameters
						Static Variables
						Local variables
						Actions
							Return sivEmailBase
					Function: GetDestination
						Description:
						Returns
							Number:
						Parameters
						Static Variables
						Local variables
						Actions
							Return nivDestination
					Function: GetMessageText
						Description:
						Returns
							String:
						Parameters
						Static Variables
						Local variables
						Actions
							Return sivMessageText
					Function: GetWorkFolder
						Description:
						Returns
							String:
						Parameters
						Static Variables
						Local variables
						Actions
							Return sivTom2GitWorkFolder
					Function: SetWorkFolder
						Description:
						Returns
						Parameters
							String: psWorkFolder
						Static Variables
						Local variables
						Actions
							Set sivTom2GitWorkFolder = psWorkFolder
							Call SalUseRegistry( TRUE, scREG_COMPANY )
							Call SalSetProfileString( scREG_KEY, "Workfolder", sivTom2GitWorkFolder, scREG_APPLICATION )
							Call SalUseRegistry( FALSE, "" )
					Function: SetLogMode
						Description:
						Returns
						Parameters
							Number: pnLogMode
						Static Variables
						Local variables
						Actions
							Set nivLogMode = pnLogMode
					Function: SetEmailBase
						Description:
						Returns
						Parameters
							String: psEmailBase
						Static Variables
						Local variables
						Actions
							Set sivEmailBase = psEmailBase
					Function: SetDestination
						Description:
						Returns
						Parameters
							Number: pnDestination
						Static Variables
						Local variables
						Actions
							Set nivDestination = pnDestination
					Function: SaveSettings
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							String: sIniFile
						Actions
							Set sIniFile = PALGetRuntimeDirectory( ) || scINIFILE
							Call SalSetProfileString( "CONNECT", "User", sivUser, sIniFile )
							Call SalSetProfileString( "CONNECT", "Database", sivDatabase, sIniFile )
							Call SalSetProfileString( "CONNECT", "Password", sivPassword, sIniFile )
							Call SalSetProfileString( "SETTINGS", "Workfolder", sivTom2GitWorkFolder, sIniFile )
							Call SalSetProfileString( "SETTINGS", "Destination", SalNumberToStrX( nivDestination, 0 ), sIniFile )
							Call SalSetProfileString( "SETTINGS", "PauseAfterRepoInit", SalNumberToStrX( bivPauseOnInit, 0 ), sIniFile )
							Call SalSetProfileString( "SETTINGS", "ShowFrozenProjects", SalNumberToStrX( bivShowFrozenProjects, 0 ), sIniFile )
							Call SalSetProfileString( "SETTINGS", "ProcessDeltaFiles", SalNumberToStrX( bivProcessDeltaFiles, 0 ), sIniFile )
							If NOT sivBranchName
								Set sivBranchName = "main"
							Call SalSetProfileString( "SETTINGS", "BranchName", sivBranchName, sIniFile )
							Call SalSetProfileString( "SETTINGS", "IntervalMode", SalNumberToStrX( nivIntervalMode, 0 ), sIniFile )
							Call SalSetProfileString( "SETTINGS", "IntervalValue", SalNumberToStrX( nivIntervalValue, 0 ), sIniFile )
							Call SalSetProfileString( "SETTINGS", "LogMode", SalNumberToStrX( nivLogMode, 0 ), sIniFile )
							Call SalSetProfileString( "SETTINGS", "AbortOnError", SalNumberToStrX( bivAbortOnError, 0 ), sIniFile )
							!
							Call SalSetProfileString( "TEMPLATES", "GitIgnore", sivGitIgnoreTemplate, sIniFile )
							Call SalSetProfileString( "TEMPLATES", "GitAttributes", sivGitAttributesTemplate, sIniFile )
							Call SalSetProfileString( "TEMPLATES", "MessageText", sivMessageTextTemplate, sIniFile )
							Call SalSetProfileString( "TEMPLATES", "TeamMembers", sivTeamMembersTemplate, sIniFile )
							!
							Call SalSetProfileString( "SIGNATURES", "EmailBase", sivEmailBase, sIniFile )
							Call SalSetProfileString( "SIGNATURES", "AuthorCode", SalNumberToStrX( bivSignatureAuthorCode, 0 ), sIniFile )
							Call SalSetProfileString( "SIGNATURES", "AuthorCurrentDate", SalNumberToStrX( bivSignatureAuthorCurrentDate, 0 ), sIniFile )
							Call SalSetProfileString( "SIGNATURES", "AuthorOverrule", SalNumberToStrX( bivSignatureAuthorOverrule, 0 ), sIniFile )
							Call SalSetProfileString( "SIGNATURES", "AuthorOverruleName", sivSignatureAuthorName, sIniFile )
							Call SalSetProfileString( "SIGNATURES", "AuthorOverruleEmail", sivSignatureAuthorEmail, sIniFile )
							Call SalSetProfileString( "SIGNATURES", "CommitterCode", SalNumberToStrX( bivSignatureCommitterCode, 0 ), sIniFile )
							Call SalSetProfileString( "SIGNATURES", "CommitterCurrentDate", SalNumberToStrX( bivSignatureCommitterCurrentDate, 0 ), sIniFile )
							Call SalSetProfileString( "SIGNATURES", "CommitterOverrule", SalNumberToStrX( bivSignatureCommitterOverrule, 0 ), sIniFile )
							Call SalSetProfileString( "SIGNATURES", "CommitterOverruleName", sivSignatureCommitterName, sIniFile )
							Call SalSetProfileString( "SIGNATURES", "CommitterOverruleEmail", sivSignatureCommitterEmail, sIniFile )
					Function: SetDefaultSettings
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Set sivTom2GitWorkFolder = ""
							Set nivDestination = ncTOM2GIT_DEST_MONO
							Set bivPauseOnInit = FALSE
							Set bivShowFrozenProjects = FALSE
							Set bivProcessDeltaFiles = TRUE
							Set sivEmailBase = "@mycompany.com"
							Set sivBranchName = "main"
							Set sivGitAttributesTemplate = ".gitattributes"
							Set sivGitIgnoreTemplate = ".gitignore"
							Set sivMessageTextTemplate = "CommitMessage.txt"
							Set sivTeamMembersTemplate = "TeamMembers.txt"
							Set bivSignatureAuthorCode = FALSE
							Set bivSignatureAuthorCurrentDate = FALSE
							Set bivSignatureAuthorOverrule = 0
							Set sivSignatureAuthorName = ""
							Set sivSignatureAuthorEmail = ""
							Set bivSignatureCommitterCode = FALSE
							Set bivSignatureCommitterCurrentDate = FALSE
							Set bivSignatureCommitterOverrule = 0
							Set sivSignatureCommitterName = ""
							Set sivSignatureCommitterEmail = ""
							Set sivUser = ""
							Set sivDatabase = ""
							Set sivPassword = ""
							Set nivIntervalMode = ncINTERVAL_NONE
							Set nivIntervalValue = 1
							Set nivLogMode = ncTOM2GIT_LOGMODE_FULL
							Set bivAbortOnError = 0
					Function: SetAbortOnError
						Description:
						Returns
						Parameters
							Boolean: pbAbortOnError
						Static Variables
						Local variables
						Actions
							Set bivAbortOnError = pbAbortOnError
					Function: LoadSettings
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							String: sIniFile
							String: sValue
						Actions
							Set sIniFile = PALGetRuntimeDirectory( ) || scINIFILE
							If VisDosExist( sIniFile)
								Call SalGetProfileString( "CONNECT", "User", "", sivUser, sIniFile )
								Call SalGetProfileString( "CONNECT", "Database", "", sivDatabase, sIniFile )
								Call SalGetProfileString( "CONNECT", "Password", "", sivPassword, sIniFile )
								Call SalGetProfileString( "SETTINGS", "Workfolder", "", sivTom2GitWorkFolder, sIniFile )
								Call SalGetProfileString( "SETTINGS", "Destination", "0", sValue, sIniFile )
								Set nivDestination = SalStrToNumber( sValue)
								Call SalGetProfileString( "SETTINGS", "PauseAfterRepoInit", "0", sValue, sIniFile )
								Set bivPauseOnInit = SalStrToNumber( sValue)
								Call SalGetProfileString( "SETTINGS", "ShowFrozenProjects", "0", sValue, sIniFile )
								Set bivShowFrozenProjects = SalStrToNumber( sValue)
								Call SalGetProfileString( "SETTINGS", "ProcessDeltaFiles", "1", sValue, sIniFile )
								Set bivProcessDeltaFiles = SalStrToNumber( sValue)
								Call SalGetProfileString( "SETTINGS", "BranchName", "", sivBranchName, sIniFile )
								If NOT sivBranchName
									Set sivBranchName = "main"
								Call SalGetProfileString( "SETTINGS", "IntervalMode", SalNumberToStrX( ncINTERVAL_NONE, 0 ), sValue, sIniFile )
								Set nivIntervalMode = SalStrToNumber( sValue)
								Call SalGetProfileString( "SETTINGS", "IntervalValue", "1", sValue, sIniFile )
								Set nivIntervalValue = SalStrToNumber( sValue)
								Call SalGetProfileString( "SETTINGS", "LogMode", SalNumberToStrX( ncTOM2GIT_LOGMODE_FULL, 0 ), sValue, sIniFile )
								Set nivLogMode = SalStrToNumber( sValue)
								Call SalGetProfileString( "SETTINGS", "AbortOnError", "0", sValue, sIniFile )
								Set bivAbortOnError = SalStrToNumber( sValue)
								!
								Call SalGetProfileString( "TEMPLATES", "GitIgnore", "", sivGitIgnoreTemplate, sIniFile )
								Call SalGetProfileString( "TEMPLATES", "GitAttributes", "", sivGitAttributesTemplate, sIniFile )
								Call SalGetProfileString( "TEMPLATES", "MessageText", "", sivMessageTextTemplate, sIniFile )
								Call SalGetProfileString( "TEMPLATES", "TeamMembers", "", sivTeamMembersTemplate, sIniFile )
								!
								Call SalGetProfileString( "SIGNATURES", "EmailBase", "", sivEmailBase, sIniFile )
								Call SalGetProfileString( "SIGNATURES", "AuthorCode", "0", sValue, sIniFile )
								Set bivSignatureAuthorCode = SalStrToNumber( sValue)
								Call SalGetProfileString( "SIGNATURES", "AuthorCurrentDate", "0", sValue, sIniFile )
								Set bivSignatureAuthorCurrentDate = SalStrToNumber( sValue)
								Call SalGetProfileString( "SIGNATURES", "AuthorOverrule", "0", sValue, sIniFile )
								Set bivSignatureAuthorOverrule = SalStrToNumber( sValue)
								Call SalGetProfileString( "SIGNATURES", "AuthorOverruleName", "", sivSignatureAuthorName, sIniFile )
								Call SalGetProfileString( "SIGNATURES", "AuthorOverruleEmail", "", sivSignatureAuthorEmail, sIniFile )
								Call SalGetProfileString( "SIGNATURES", "CommitterCode", "0", sValue, sIniFile )
								Set bivSignatureCommitterCode = SalStrToNumber( sValue)
								Call SalGetProfileString( "SIGNATURES", "CommitterCurrentDate", "0", sValue, sIniFile )
								Set bivSignatureCommitterCurrentDate = SalStrToNumber( sValue)
								Call SalGetProfileString( "SIGNATURES", "CommitterOverrule", "0", sValue, sIniFile )
								Set bivSignatureCommitterOverrule = SalStrToNumber( sValue)
								Call SalGetProfileString( "SIGNATURES", "CommitterOverruleName", "", sivSignatureCommitterName, sIniFile )
								Call SalGetProfileString( "SIGNATURES", "CommitterOverruleEmail", "", sivSignatureCommitterEmail, sIniFile )
							Else
								Call SetDefaultSettings( )
					Function: LoadMessageText
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							File Handle: hFile
						Actions
							Set sivMessageText = ""
							If SalFileOpen( hFile, guGlobals.GetTemplatesFolder(  ) || sivMessageTextTemplate, OF_Read | OF_Text )
								Call SalFileRead( hFile, sivMessageText, VisFileGetSize( guGlobals.GetTemplatesFolder(  ) || sivMessageTextTemplate ) )
								Call SalFileClose( hFile )
								Call guGlobals.Trace( EVENT_INFORMATION, "MessageText loaded from : " || guGlobals.GetTemplatesFolder(  ) || sivMessageTextTemplate || " :
										" || sivMessageText )
							Else
								Call guGlobals.Trace( EVENT_ERROR, "Loading MessageText failed from :" || guGlobals.GetTemplatesFolder(  ) || sivMessageTextTemplate )
			!
			Functional Class: cfcDMShellDlg
				Description: Class to hold several WinApi Shell dialog features
				Derived From
				Class Variables
				Instance Variables
					String: sivPreselectFolder
					String: sivPreselectFilePath
				Constructor/Destructor
				Functions
					Function: DlgBrowseFolder
						Description: Boolean DlgBrowseFolder( phWndOwner, psTitle, pnFlags, rpsFolder )
								OPens windows folder browser dialog
								
								Parameter	Type		Description
								phWndOwner	Window Handle	Parent window
								psTitle		String		Title of the browser window
								pnFlags		Number		Flags of the browser window
								rpsFolder		Receive String	OUTPUT: The selected folder in the browser
								
								Return value :
								Boolean = TRUE if the function was ok, FALSE otherwise
						Returns
							Boolean:
						Parameters
							Window Handle: phWndOwner
							String: psTitle
							Number: pnFlags
							Receive String: rpsFolder
						Static Variables
						Local variables
							Number: pProc
							Number: nPathID
							Number: npLProc
							Number: nhLProc
							String: sHelp
							Number: nHelp
						Actions
							Set sivPreselectFolder = rpsFolder
							Set sHelp = rpsFolder
							Call SalStrSetBufferLength( sHelp, 254*2+2 )
							Call SalStrSetBufferLength( psTitle, 254*2+2 )
							Set nHelp = 0
							If pnFlags = 0
								Set pnFlags = BIF_NEWDIALOGSTYLE
							Call SetCallback( "__SHBrowseForFolderCallback", 4, FALSE, npLProc, nhLProc )
							If npLProc
								Set pProc = npLProc
							Set nPathID = SHBrowseForFolderA( phWndOwner, 0, sHelp, psTitle, pnFlags, pProc, 0, nHelp )
							If nPathID != 0
								! User chose a path, get it
								Call SalStrSetBufferLength( rpsFolder, 254+2 )
								Call SHGetPathFromIDListA( nPathID, rpsFolder )
								If SalStrRightX( rpsFolder, 1 ) != "\\"
									Set rpsFolder = rpsFolder || "\\"
								! this row was inserted after the article was printed and avoids memory leaks
								Call GlobalFree ( nPathID )
								Return TRUE
							Return FALSE
					Function: DlgBrowseOpenFile
						Description:
						Returns
							Boolean:
						Parameters
							Window Handle: phWndOwner
							Receive String: rpsFile
						Static Variables
						Local variables
							String: saFilter[*]
							String: sFile
							String: sPath
							Number: nIndex
						Actions
							Set sPath = rpsFile
							If sPath
								Call PathRemoveFileSpecW( sPath )
							Else
								Set sPath = PALGetRuntimeDirectory(  )
							Set saFilter[1] = "*.*"
							Set saFilter[0] = "(All files)"
							If SalDlgOpenFile( phWndOwner, "Select file", saFilter, 2, nIndex, sFile, sPath )
								Set rpsFile = sPath
								Return TRUE
							Return FALSE
					Function: DlgBrowseNewFile
						Description:
						Returns
							Boolean:
						Parameters
							Window Handle: phWndOwner
							Receive String: rpsFile
						Static Variables
						Local variables
							String: saFilter[*]
							String: sFile
							String: sPath
							Number: nIndex
						Actions
							Set sPath = sivPreselectFilePath
							Set sFile = rpsFile
							If sPath
								Call PathRemoveFileSpecW( sPath )
							Else
								Set sPath = PALGetRuntimeDirectory(  )
							Set saFilter[1] = "*.*"
							Set saFilter[0] = "(All files)"
							If SalDlgSaveFile( phWndOwner, "Destination file", saFilter, 2, nIndex, sFile, sPath )
								Set rpsFile = sPath
								Call PathRemoveFileSpecW( sPath )
								Set sivPreselectFilePath = sPath
								Return TRUE
							Return FALSE
					Function: __SHBrowseForFolderCallback
						Description: Number __SHBrowseForFolderCallback( pnWindowHandle, pnMsg, pnLParam, pnData )
								WIndows callback function to be able to change the browser GUI settings.
								Here is sets the folder to preselect in the browser when started
								
								Parameter	Type	Description
								pnWindowHandle	Number	Window of the browser
								pnMsg		Number	Msg
								pnLParam	Number	LParam
								pnData		Number	Data
								
								Return value :
								Number = return value of the callback
						Returns
							Number:
						Parameters
							Number: pnWindowHandle
							Number: pnMsg
							Number: pnLParam
							Number: pnData
						Static Variables
						Local variables
							Number: nFarMem
							String: sTemp
						Actions
							Select Case pnMsg
								Case BFFM_INITIALIZED
									If sivPreselectFolder
										Call SalStrToMultiByte( sivPreselectFolder, sTemp, ENC_ANSI )
										Set nFarMem = CStructAllocFarMem( SalStrGetBufferLength( sTemp ) )
										If nFarMem > 0
											Call CStructCopyToFarMem( nFarMem, sTemp, SalStrGetBufferLength( sTemp ) )
											Call SalSendMsg( SalNumberToWindowHandle( pnWindowHandle ), BFFM_SETSELECTION, TRUE, nFarMem )
											! The next two lines fixes an issue in Win7 64bit: it does not scroll to the selected browser
											Call SalPause( 250 )
											Call SalSendMsg( SalNumberToWindowHandle( pnWindowHandle ), BFFM_SETSELECTION, TRUE, nFarMem )
											Call CStructFreeFarMem( nFarMem )
											Set nFarMem = 0
									Break
								Default
									Break
							Return 0
			!
			Combo Box Class: cmbcValueBase
				Window Location and Size
					Left:
					Top:
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Editable? No
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? No
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List in Tool Palette? Yes
				Property Template:
				Class DLL Name:
				ToolTip:
				AutoFill? No
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Class Default
				Hint Text:
				IME Mode: Class Default
				Vertical Anchor: Class Default
				Horizontal Anchor: Class Default
				Minimum Width: Class Default
				Minimum Height: Class Default
				Description:
				Derived From
				Class Variables
				Instance Variables
				Constructor/Destructor
				Functions
					Function: SelectValue
						Description:
						Returns
						Parameters
							Number: pnValue
						Static Variables
						Local variables
							Number: nIndex
						Actions
							Set nIndex = VisListFindValue( hWndItem, -1, pnValue )
							If nIndex > -1
								Call SalListSetSelect( hWndItem, nIndex )
							Else
								Call SalListSetSelect( hWndItem, -1 )
					Function: GetValue
						Description:
						Returns
							Number:
						Parameters
						Static Variables
						Local variables
							Number: nIndex
						Actions
							Set nIndex = SalListQuerySelection( hWndItem )
							If nIndex > -1
								Return VisListGetValue( hWndItem, nIndex )
							Else
								Return -1
				List Initialization
				Message Actions
			Combo Box Class: cmbcTemplate
				Window Location and Size
					Left:
					Top:
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Editable? No
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? No
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List in Tool Palette? Yes
				Property Template:
				Class DLL Name:
				ToolTip:
				AutoFill? No
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Class Default
				Hint Text:
				IME Mode: Class Default
				Vertical Anchor: Class Default
				Horizontal Anchor: Class Default
				Minimum Width: Class Default
				Minimum Height: Class Default
				Description:
				Derived From
					Class: cmbcValueBase
				Class Variables
				Instance Variables
					String: sivTemplatePrefix
					String: sivSelectedTemplate
				Constructor/Destructor
				Functions
					Function: SetTemplatePrefix
						Description:
						Returns
						Parameters
							String: psPrefix
						Static Variables
						Local variables
						Actions
							Set sivTemplatePrefix = psPrefix
					Function: GetTemplates
						Description:
						Returns
						Parameters
							Boolean: pbSelectValue
						Static Variables
						Local variables
							Number: nCount
							String: saTemplate[*]
							Number: nTotalTemplates
						Actions
							Call SalListClear( hWndItem )
							Call VisListAddValue( hWndItem, scNOTEMPLATE, 0 )
							Set nTotalTemplates = VisDosEnumFiles( guGlobals.GetTemplatesFolder(  ) || sivTemplatePrefix || "*", FA_Standard, saTemplate )
							Set nCount = 0
							While nCount < nTotalTemplates
								Call VisListAddValue( hWndItem, saTemplate[nCount], 1 )
								Set nCount = nCount + 1
							If pbSelectValue
								Call SelectTemplate( sivSelectedTemplate )
					Function: SelectTemplate
						Description:
						Returns
						Parameters
							String: psTemplate
						Static Variables
						Local variables
						Actions
							If psTemplate AND psTemplate != scNOTEMPLATE AND VisDosExist( guGlobals.GetTemplatesFolder(  ) || psTemplate)
								Set MyValue = psTemplate
								Set sivSelectedTemplate = psTemplate
							Else
								Call SalListSetSelect( hWndItem, 0 )
								Set sivSelectedTemplate = ""
				List Initialization
				Message Actions
					On SAM_Create
						Call GetTemplates( TRUE )
					On SAM_DropDown
						Call GetTemplates( TRUE )
					On SAM_Click
						Call SelectTemplate( MyValue )
		Default Classes
			MDI Window: cBaseMDI
			Form Window:
			Dialog Box:
			Table Window:
			Grid Window:
			Quest Window:
			Data Field:
			Spin Field:
			Multiline Field:
			Pushbutton:
			Radio Button:
			Option Button:
			Child Grid:
			Rich Text Control:
			Separator:
			Tree Control:
			Navigation Bar:
			Pane Separator:
			Progress Bar:
			Check Box:
			Child Table:
			Quest Child Window: cQuickDatabase
			List Box:
			Combo Box: cmbcTemplate
			Picture:
			Vertical Scroll Bar:
			Horizontal Scroll Bar:
			Column:
			Background Text:
			Group Box:
			Line:
			Frame:
			Custom Control:
			ActiveX:
			Date Picker:
			Date Time Picker:
			Tab Bar:
		Application Actions
			On SAM_AppStartup
				Call PALStartupApplication(  )
	Form Window: frmTom2Git
		Class:
		Property Template:
		Class DLL Name:
		Title: Tom 2 Git
		Icon File: .\Resources\Git.ico
.data RESOURCE 2 0 1 2730273360
0000: BE1000007B070000 0000000000000000 0200A20001000120 1C000000A8100000
0020: 0016000000280008 0000200000400078 0000010027100038 ECBC000000FFFFFF
0040: FFFFFF83354CDD00 35FF1103354C0135 4CDF03FD00F30000 FFFFFFFFFFFFFFFF
0060: FFBF35FB351F0235 4C1D0008354CD109 354C00DD030028DE 0035DD0000FFFFFF
0080: FFFFFFFFFFFFBB35 35FFD104354C0011 43354CE2354C11E7 354C4D354C1D0004
00A0: 364CEEDEDEF0DD00 0000FFFFFFFFFFFF FFBF35FB359F0435 1D0046354C11F735
00C0: 4CFF354C1FFC354C D151354C00C10535 4BDE000EDEDD0000 00FFFFFFFFFFFFFF
00E0: 3B35354D7CDD004C DD0400DD46F7DDFF FC1FFE354CDDFC51 DD000560DF00354B
0100: DE4CF1000000FFFF FFFFFFBF35FB35DF 04DD0046DDF7FF01 FD364DDDFF364D3B
0120: 35354CDDFEFCDD51 00D5054C003F0000 FFFFFFFFFFBB3535 FFDD0400DD46F71D
0140: FFFD374E00DDFF31 48DCFF3048B2DC37 4E35DB35FEDDFC51 1D0005344CFCDD00
0160: F30000FFFFFFBF35 FB35DF04DD0046DD F7FF39FD362B4300 DBFF465BE0FD4A5E
0180: 80E0FD2C44DBFF35 99FF35FD35DDFEFC DD5100DD05003F00 00FFFFFFBB3535FF
01A0: DD0400DD46F79DFF FD373B2B859300EA FCFAFBFEFDFEFE00 FFFD98A4EEFC2D45
01C0: B0DCFE374E35DB35 FEDDFC51DD0005D8 DC003500F30000FF BF35FB359F0535DD
01E0: 0046D1F8354CFF39 FD36314900DCFF44 59DFFDF1F3E0FDFD FFFFFF03FDFEFFFE
0200: 546700E2FD2E46DC FF374DBADD3535DD FEFCDD5100010534 4DDB00344D1CDC00
0220: 000000FFBB3535FF D9053500DD46F8DD FFFD39FF36314823 455BE0F3F52CFDFD
0240: FFFEFE19FFFFFE56 6A80E3FD2E45DCFF 37FB35DDFDFE1DFC 50354C9D000534BE
0260: DB35B100000035FB 359F05351D004735 4CDDF8FFDDFDFF3F 374E3B2B909D80EC
0280: FCFFFFFFFEFF82FF A6B0F0FC2DB5FE4D 35FB37DB35FDDDFE FCDD5000ED05DCFC
02A0: DD00FFDD0400DD46 F8DDFFFDFDFFFF3B 36253E00DAFED0D6 F7FEFEFE00FFFE3B
02C0: 51DEFD3048BF3503 2A42DBFF2C44B8DC FF3635DDFDFEDDFC 51DD0004FD00DF03
02E0: DD0047DDF8FFDDFD FFFFFF3B372D4541 FFCFD4F7FEFE02FF 4359DFFE324AE0DD
0300: FF334ADD01FE697A E6FC5E7098E4FD2E FE35DB35FDD9FE35 FCDD5000DD0300DD
0320: 0300D145354CF8DD FFFDFDFFFFFFB337 4D2C40DBFFCFD5F7 FEFE02FF4258DFFE
0340: 314903344BDDFEC1 C808F4FCFFFFFEFF FF20FFFE99A4EE2B 43B3374E359DFDFE
0360: 351DFC4E354CDD00 031D0006354CD1DD 354CFFDDFCFFFFFF FFB3374D2C7BCFFE
0380: 30FFFE4459294282 DB6274E5FDFF10FF FEFAFBFFFFFF03F0 F2FDFD4157A0DFFD
03A0: 3249DC36DB35FC1D FFE0354CD107354C 00DF07DDE0FFDDFC FFFFFFFFBB372C7B
03C0: CFFE30FFFE465B23 3C80DAFF6375E5FC FF00FFFEFCFCFEFF FFFF03E4E7FBFD3A
03E0: 5180DEFE334BDDFF 36DB35FC1DFFDC35 4CDD0600DD0300DD 4EFCDDFEFDFDFFFF
0400: FFBB372DB9FFCFFF 00FFFE3A50DEFE3E 5480DFFDDCE0F9FD FF02FFEFF0FCFDE8
0420: EB00FBFD6D7DE6FC 2C44B3374E35DDFD FFDDF845DD0003DD 0003DD0050DDFCFE
0440: DDFDFFFFFF23384E DD2A4302DBCED3F7 FEF9FA00FEFE5064 E2FBD6DB28F8FDFF
0460: FFA5AF10F0FC3A51 FD384FA0DEFE2C44 DC36DB35FDDDFFF7 DD4600DD0300FFDD
0480: 0400DD50FCDDFEFD FDFFBF36DB33FF01 FDDDE0F9FEFCFD80 FFFEE0E3FAFCFF3A
04A0: FFA62941B0DBFE32 4935BB3735D9FD35 FFDDF746DD0004FD 00FFDF05DD0050DD
04C0: FCFEDDFDFFBF3603 3047DCFEBDC42CF4 FCFFFBFC36FEFFA7 B13CF0FC364DBB37
04E0: 35DFFDDDFFF7DD46 00DD04003F0000BB 3535FFDD0500DD50 FCDDFEFD39FF3632
0500: 4903485DE0FDF6F7 20FDFDFFFFFFFBFB 16FEFFFE5669B8E3 FC2C38FB35DDFDFF
0520: DDF746DD0004FD00 F30000BF35FB35CE DCDD05DD0050DDFC FE81FD394FDEFF2B
0540: 034D61E1FDF8F9E8 FEFEFFFF23F2F3FD 4A5FB0E1FD314836 BF35DDFFF7DD4600
0560: DD04003F0000FFFF BB353566DC4DDC4C DCDD05001D51FC37 4E11FE2D45FE4055
0580: C0DFFDDADEF9FD22 FFD9DEF9D2D7E0F7 FD6C7DE6DB37FFDD FDFFDDF746DD0004
05A0: FD00F30000FFFFBF 35EB35DC0FDD0536 4D1100394F503148 11FC4157FCD8DC20
05C0: F8FBFFFFFFA9B3B8 F1FC2D2DBB2C36DD FFFDDDFFF79D4600 35DD04003F0000FF
05E0: FFFFFFBB35352FDE 4B6010E105344B00 31488150CED4F7FB FF00FFFEA8B2F0FA
0600: 2A4289FE35DDFF37 BF35DDFDFFDDF746 D9003504FD00F300 00FFFFFFFFBF3523
0620: 344CDD000000BA00 96A2ED05FFFF00FF 00FFFFFF51A9B2F0 F0FB2941F9FD369D
0640: FFFD35DDFFF79D46 0035DD04003F0000 FFFFFFFFFFFF3B35 192700CA00040BBC
0660: 002C4400DB05253E DB001D3618D95135 FC364DB9FE3535DF FFDDF746D9003504
0680: FD00F30000FFFFFF FFFFFF3FF6F7C900 FFFF0000FF009AA5 EE052A43D9003551
06A0: DDFCFFDFF79D4600 35DD04003F0000FF FFFFFFFFFFFFFF03 B8C1F300000000B0
06C0: 0000009D003B5290 DE04364D0035DD4D E71DE244354CDD00 04FD00F30000FFFF
06E0: FFFFFFFFFFFFBF35 E3364CDDDB3503DD 0009DD0800DD0200 3F0000FFFFFFFFFF
0700: FFFFFFFFFFBB3536 FB35DD0301DF03FD 00F30000FFFFFFFF 3FFFE40027FFFFCA
0720: 53FFFF940029FFFF 2814FFFE50000A7F FCA0053FF9400002 9FF280014FE50000
0740: 00A7CA0000539400 1000292800145000 00000AA000000540 0001028000000180
0760: 001101400002A000 110550000A280011 14940029CA001153 E500A7F28033F940
0780: FCA033FE50FF2873 FF94CA37E4
.enddata
		Accessories Enabled? Yes
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? No
			Minimizable? Yes
			Allow Child Docking? No
			Docking Orientation: All
			System Menu? Yes
			Resizable? No
			Window Location and Size
				Left: 2.838"
				Top: 1.094"
				Width:  18.967"
				Width Editable? Yes
				Height: 8.964"
				Height Editable? Yes
			Form Size
				Width:  0.01"
				Height: 0.01"
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		XAML Style:
		Background Brush:
		Ribbon Bar Enabled? No
		Anchoring Enabled? No
		Vertical Anchor: Top
		Horizontal Anchor: Left
		Minimum Width: Default
		Minimum Height: Default
		Anchor Maximum Width: Default
		Anchor Maximum Height: Default
		Description: Main Tom2Git screen
		Ribbon
		Named Menus
			Menu: namedpopupRepositoryTable
				Resource Id: 39606
				Picture File Name:
				Title:
				Status Text:
				Description:
				Enabled when:
				Menu Item Name:
				Menu Item: nmitemSelectAll
					Resource Id: 39607
					Title: Select all
					Picture File Name:
					Status Text:
					ToolTip:
					Keyboard Accelerator: (none)
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call tblRepository.SelectAll(  )
					Menu Item Name:
				Menu Item: nmitemSelectNone
					Resource Id: 39608
					Title: Select none
					Picture File Name:
					Status Text:
					ToolTip:
					Keyboard Accelerator: (none)
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call tblRepository.SelectNone( )
					Menu Item Name:
			Menu: namedMenuWorkfolder
				Resource Id: 22958
				Picture File Name:
				Title:
				Status Text:
				Description:
				Enabled when:
				Menu Item Name:
				Menu Item: nmitemSelect
					Resource Id: 22959
					Title: Select workfolder
					Picture File Name:
					Status Text:
					ToolTip:
					Keyboard Accelerator: (none)
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SetWorkFolder( TRUE )
					Menu Item Name:
				Menu Item: nmitemOpen
					Resource Id: 22960
					Title: Open workfolder
					Picture File Name:
					Status Text:
					ToolTip:
					Keyboard Accelerator: (none)
					Menu Settings
						Enabled when: dfWorkfolder
						Checked when:
					Menu Actions
						Call SetWorkFolder( FALSE )
					Menu Item Name:
			Menu: namedMenuRevision
				Resource Id: 31625
				Picture File Name:
				Title:
				Status Text:
				Description:
				Enabled when:
				Menu Item Name:
				Popup Menu: nmPopupSnapshot
					Resource Id: 49603
					Title: Snapshot
					Picture File Name:
					Status Text:
					ToolTip:
					Enabled when:
					Menu Item Name:
					Menu Item: nmitemSnapshot
						Resource Id: 49605
						Title: Set snapshot
						Picture File Name:
						Status Text:
						ToolTip:
						Keyboard Accelerator: (none)
						Menu Settings
							Enabled when:
							Checked when:
						Menu Actions
							Call SalSendMsg( whWndMenuParent, PAM_SetSnapshot, FALSE, 0 )
						Menu Item Name:
					Menu Item: nmitemClear
						Resource Id: 49604
						Title: Clear
						Picture File Name:
						Status Text:
						ToolTip:
						Keyboard Accelerator: (none)
						Menu Settings
							Enabled when:
							Checked when:
						Menu Actions
							Call SalSendMsg( whWndMenuParent, PAM_SetSnapshot, TRUE, 0 )
						Menu Item Name:
				Menu Item: nmExtract
					Resource Id: 49606
					Title: Extract revision
					Picture File Name:
					Status Text:
					ToolTip:
					Keyboard Accelerator: (none)
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SalSendMsg( whWndMenuParent, PAM_ExtractRevision, 0, 0 )
					Menu Item Name:
		Menu
			Windows Menu: menuTools
				Resource Id: 29288
				Title: Tools
				Picture File Name:
				Status Text:
				ToolTip:
				Enabled when:
				Menu Item Name:
				Menu Item: menuTDAppTools
					Resource Id: 29289
					Title: TDAppTools
					Picture File Name:
					Status Text:
					ToolTip:
					Keyboard Accelerator: (none)
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call PALTDAppTools_Start( hWndNULL, FALSE )
					Menu Item Name:
				Menu Separator
				Menu Item: menuWorkFolder
					Resource Id: 29291
					Title: Open work folder
					Picture File Name:
					Status Text:
					ToolTip:
					Keyboard Accelerator: (none)
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SetWorkFolder( FALSE )
					Menu Item Name:
				Menu Item: menuTemplatesFolder
					Resource Id: 29292
					Title: Open templates folder
					Picture File Name:
					Status Text:
					ToolTip:
					Keyboard Accelerator: (none)
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call OpenTemplatesFolder( )
					Menu Item Name:
				Menu Item: menuOpenTemp
					Resource Id: 29290
					Title: Open temp/log folder
					Picture File Name:
					Status Text:
					ToolTip:
					Keyboard Accelerator: (none)
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call OpenTempFolder( )
					Menu Item Name:
				Menu Separator
				Menu Item: menuGitHub
					Resource Id: 40660
					Title: Tom2Git GitHub Page
					Picture File Name: .\Resources\github.png
					Status Text:
					ToolTip:
					Keyboard Accelerator: (none)
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call OpenGitHubPage( )
					Menu Item Name:
				Menu Separator
				Menu Item: menuDonate
					Resource Id: 29293
					Title: Make a donation
					Picture File Name: .\Resources\Heart.png
					Status Text:
					ToolTip:
					Keyboard Accelerator: (none)
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call ShellExecuteA( hWndNULL, "open" , "https://www.paypal.com/donate/?hosted_button_id=AQEAQURMJQX42", STRING_Null, STRING_Null, SHOW_Normal )
					Menu Item Name:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: 0.726"
				Size Editable? Yes
				Docking Toolbar? No
				Toolbar Docking Orientation: Top | Bottom
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Resizable? No
			XAML Style:
			Background Brush:
			Anchoring Enabled? No
			Minimum Width: Default
			Minimum Height: Default
			Anchor Maximum Width: Default
			Anchor Maximum Height: Default
			Contents
				Pushbutton: pbConnectTOM
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Connect TOM
					Window Location and Size
						Left: 0.25"
						Top: 0.167"
						Width:  1.983"
						Width Editable? Yes
						Height: 0.369"
						Height Editable? Yes
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: .\Resources\TomRepoOff.png
					Picture Transparent Color: None
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Button Appearance: Standard
					ToolTip: Connect or disconnect TOM database
					Image Alignment: Default
					Text Alignment: Center Right
					Text Image Relation: Image Before
					XAML Style:
					Background Brush:
					Text Brush:
					Vertical Anchor: Top
					Horizontal Anchor: Left
					Minimum Width: Default
					Minimum Height: Default
					Message Actions
						On SAM_Click
							Call ConnectTOM( )
				Pushbutton: pbDisconnectTOM
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Disconnect TOM
					Window Location and Size
						Left: 0.25"
						Top: 0.167"
						Width:  1.983"
						Width Editable? Yes
						Height: 0.369"
						Height Editable? Yes
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: .\Resources\TomRepo.png
					Picture Transparent Color: None
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Button Appearance: Standard
					ToolTip:
					Image Alignment: Default
					Text Alignment: Center Right
					Text Image Relation: Image Before
					XAML Style:
					Background Brush:
					Text Brush:
					Vertical Anchor: Top
					Horizontal Anchor: Left
					Minimum Width: Default
					Minimum Height: Default
					Message Actions
						On SAM_Click
							Call DisconnectTOM( )
				Pushbutton: pbExportToGit
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Start export
					Window Location and Size
						Left: 2.433"
						Top: 0.167"
						Width:  1.983"
						Width Editable? Yes
						Height: 0.369"
						Height Editable? Yes
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: .\Resources\Git.png
					Picture Transparent Color: None
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Button Appearance: Standard
					ToolTip: Start exporting selection to Git
					Image Alignment: Default
					Text Alignment: Default
					Text Image Relation: Image Before
					XAML Style:
					Background Brush:
					Text Brush:
					Vertical Anchor: Top
					Horizontal Anchor: Left
					Minimum Width: Default
					Minimum Height: Default
					Message Actions
						On SAM_Click
							Call ExportToGit( )
				Pushbutton: pbCreateSnapshot
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Create snapshot
					Window Location and Size
						Left: 4.617"
						Top: 0.167"
						Width:  1.983"
						Width Editable? Yes
						Height: 0.369"
						Height Editable? Yes
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: .\Resources\screenshot-16.ico
					Picture Transparent Color: None
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Button Appearance: Standard
					ToolTip: Create snapshot of the selection
					Image Alignment: Default
					Text Alignment: Center Right
					Text Image Relation: Image Before
					XAML Style:
					Background Brush:
					Text Brush:
					Vertical Anchor: Top
					Horizontal Anchor: Left
					Minimum Width: Default
					Minimum Height: Default
					Message Actions
						On SAM_Click
							Call Snapshot( )
				Background Text: bkgdWorkfolder
					Resource Id: 19382
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left: 7.017"
						Top: 0.143"
						Width:  1.25"
						Width Editable? Yes
						Height: 0.214"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Title: Work folder
					XAML Style:
					Background Brush:
					Text Brush:
					Flow Direction: Default
					Vertical Anchor: Top
					Horizontal Anchor: Left
					Minimum Width: Default
					Minimum Height: Default
				Data Field: dfWorkfolder
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left: 8.383"
							Top: 0.095"
							Width:  4.3"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					ToolTip:
					XAML Style:
					Background Brush:
					Text Brush:
					Flow Direction: Default
					Spell Check? No
					Hint Text: Destination workfolder
					IME Mode: Auto
					Vertical Anchor: Top
					Horizontal Anchor: Left
					Minimum Width: Default
					Minimum Height: Default
					Message Actions
						On SAM_Create
							Call VisWinSetFlags( hWndItem, WF_DisplayOnly, TRUE )
				Pushbutton: pbTom2GitWorkFolder
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Workfolder
					Window Location and Size
						Left: 12.75"
						Top: 0.083"
						Width:  1.467"
						Width Editable? Yes
						Height: 0.274"
						Height Editable? Yes
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name:
					Picture Transparent Color: None
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Button Appearance: Standard
					ToolTip: Select or open workfolder
					Image Alignment: Default
					Text Alignment: Default
					Text Image Relation: Default
					XAML Style:
					Background Brush:
					Text Brush:
					Vertical Anchor: Top
					Horizontal Anchor: Left
					Minimum Width: Default
					Minimum Height: Default
					Message Actions
						On SAM_Click
							Call SalTrackPopupMenu( hWndItem, "namedMenuWorkfolder", TPM_CursorX | TPM_CursorY, 0, 0 )
				Pushbutton: pbCANCEL
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: CANCEL
					Window Location and Size
						Left: 16.733"
						Top: 0.179"
						Width:  1.883"
						Width Editable? Yes
						Height: 0.369"
						Height Editable? Yes
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: 12
					Font Enhancement: Bold
					Picture File Name:
					Picture Transparent Color: None
					Image Style: Single
					Text Color: #e0eff
					Background Color: Default
					Button Appearance: Standard
					ToolTip:
					Image Alignment: Default
					Text Alignment: Default
					Text Image Relation: Default
					XAML Style:
					Background Brush:
					Text Brush:
					Vertical Anchor: Top
					Horizontal Anchor: Left
					Minimum Width: Default
					Minimum Height: Default
					Message Actions
						On SAM_Click
							If guGlobals.ActionIsOngoing(  )
								If SalMessageBox( "Cancel action?", "Message", MB_YesNo | MB_IconExclamation ) = IDYES
									Call guGlobals.CancelAction(  )
				Background Text: bkgdGitRepoDestination
					Resource Id: 19379
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left: 6.8"
						Top: 0.429"
						Width:  1.467"
						Width Editable? Yes
						Height: 0.214"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Title: Destination
					XAML Style:
					Background Brush:
					Text Brush:
					Flow Direction: Default
					Vertical Anchor: Top
					Horizontal Anchor: Left
					Minimum Width: Default
					Minimum Height: Default
				Combo Box: cmbGitRepoDestination
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cmbcValueBase
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left: 8.4"
						Top: 0.393"
						Width:  4.283"
						Width Editable? Class Default
						Height: 1.048"
						Height Editable? Class Default
					Visible? Class Default
					Editable? Class Default
					String Type: Class Default
					Maximum Data Length: Class Default
					Sorted? Class Default
					Always Show List? Class Default
					Vertical Scroll? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
					ToolTip:
					AutoFill? Class Default
					XAML Style:
					Background Brush:
					Text Brush:
					Flow Direction: Class Default
					Hint Text:
					IME Mode: Class Default
					Vertical Anchor: Class Default
					Horizontal Anchor: Class Default
					Minimum Width: Class Default
					Minimum Height: Class Default
					List Initialization
					Message Actions
						On SAM_Click
							Call guRepo.ClearHistorySort(  )
							Call tblRepoRevisions.ForceReset(  )
							Call tblRepository.UpdateGitExportSettingsDestination( )
							If SalTabGetActivePage( tabMain ) = 3
								Call tblRepoRevisions.Populate(  )
				Combo Box: cmbLogMode
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cmbcValueBase
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left: 12.75"
						Top: 0.393"
						Width:  1.833"
						Width Editable? Class Default
						Height: 1.512"
						Height Editable? Class Default
					Visible? Class Default
					Editable? Class Default
					String Type: Class Default
					Maximum Data Length: Class Default
					Sorted? Class Default
					Always Show List? Class Default
					Vertical Scroll? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
					ToolTip:
					AutoFill? Class Default
					XAML Style:
					Background Brush:
					Text Brush:
					Flow Direction: Class Default
					Hint Text:
					IME Mode: Class Default
					Vertical Anchor: Class Default
					Horizontal Anchor: Class Default
					Minimum Width: Class Default
					Minimum Height: Class Default
					List Initialization
					Message Actions
						On SAM_Click
							Call guGlobals.SetLogMode( GetValue(  ) )
				Pushbutton: pbOpenTemp
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Open log folder
					Window Location and Size
						Left: 14.667"
						Top: 0.381"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.274"
						Height Editable? Yes
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name:
					Picture Transparent Color: None
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Button Appearance: Standard
					ToolTip:
					Image Alignment: Default
					Text Alignment: Default
					Text Image Relation: Default
					XAML Style:
					Background Brush:
					Text Brush:
					Vertical Anchor: Top
					Horizontal Anchor: Left
					Minimum Width: Default
					Minimum Height: Default
					Message Actions
						On SAM_Click
							Call OpenTempFolder( )
				Check Box: cbAbortOnError
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Abort on error
					Window Location and Size
						Left: 14.383"
						Top: 0.095"
						Width:  1.767"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					ToolTip: Stop processing on error
					XAML Style:
					Background Brush:
					Text Brush:
					Flow Direction: Default
					Vertical Anchor: Top
					Horizontal Anchor: Left
					Minimum Width: Default
					Minimum Height: Default
					Message Actions
						On SAM_Click
							Call guGlobals.SetAbortOnError( MyValue )
				! Pushbutton: pbTest		! Use for quick tests
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: TDAppTools
					Window Location and Size
						Left: 14.417"
						Top: 0.083"
						Width:  1.467"
						Width Editable? Yes
						Height: 0.274"
						Height Editable? Yes
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name:
					Picture Transparent Color: None
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Button Appearance: Standard
					ToolTip:
					Image Alignment: Default
					Text Alignment: Default
					Text Image Relation: Default
					XAML Style:
					Background Brush:
					Text Brush:
					Vertical Anchor: Top
					Horizontal Anchor: Left
					Minimum Width: Default
					Minimum Height: Default
.end
					Message Actions 
						On SAM_Click
							Call Test( )
				Line: line4
					Resource Id: 43988
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  -0.25"
						Begin Y:  0.0"
						End X:  20.0"
						End Y:  0.0"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: Default
					XAML Style:
					Background Brush:
					Vertical Anchor: Top
					Horizontal Anchor: Left
					Minimum Width: Default
					Minimum Height: Default
		Contents
			Tab Bar: tabMain
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left: 0.1"
						Top: 0.06"
						Width:  18.417"
						Width Editable? Yes
						Height: 3.571"
						Height Editable? Yes
					Visible? Yes
					Orientation? Top
					Style? Standard
					Enable Scroll? No
					Tile To Parent? No
					Left Margin:  Default
					Right Margin:  Default
					Top Margin:  Default
					Bottom Margin:  Default
					Border? No
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Invert Vertical Font? No
					Multi Row: No
					Show Close Buttons: No
				XAML Style:
				Background Brush:
				Anchoring Enabled? No
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Anchor Maximum Width: Default
				Anchor Maximum Height: Default
				Contents
					Tab: pageTOM
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Title: TOM repository
						Visible? Yes
						Background Color: Default
						ToolTip:
						Picture File Name: Resources\TomRepo.ico
						Child Window:
						XAML Style:
						Background Brush:
						Picture Transparent Color: None
						Tab Child: cbShowFrozenProjects
						Tab Child: bkgdGlobalRootMode
						Tab Child: cmbGlobalGitRootMode
						Tab Child: tblRepository
						Tab Child: cbDeltaRevisions
					Tab: pageTOMMembers
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Title: TOM team members
						Visible? Yes
						Background Color: Default
						ToolTip:
						Picture File Name: Resources\TomStaff.ico
						Child Window:
						XAML Style:
						Background Brush:
						Picture Transparent Color: None
						Tab Child: tblTeamMembers
						Tab Child: pbSetNamesToCode
						Tab Child: pbSetNamesToEmail
						Tab Child: pbSetCodesToEmail
						Tab Child: pbForceCustomEmail
						Tab Child: dfEmailSpec
						Tab Child: pbForceResetSig
						Tab Child: grp3
						Tab Child: bkgdEmailBase
						Tab Child: pbLoadMembersTemplate
						Tab Child: pbSaveMembersTemplate
					Tab: pageGIT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Title: GIT repo settings
						Visible? Yes
						Background Color: Default
						ToolTip:
						Picture File Name: Resources\Git.png
						Child Window:
						XAML Style:
						Background Brush:
						Picture Transparent Color: None
						Tab Child: cmbGitMessageTemplate
						Tab Child: cmbGitIgnoreTemplate
						Tab Child: cmbCommitInterval
						Tab Child: dfGitGlobalAuthorEmail
						Tab Child: rbGitAuthorDateOrig
						Tab Child: rbGitAuthorDateNow
						Tab Child: rbGitCommitterDateOrig
						Tab Child: rbGitCommitterDateNow
						Tab Child: pbGitGlobalAttributes
						Tab Child: pbGitGlobalIgnore
						Tab Child: pbGitGlobalMessage
						Tab Child: grpAuthorGlobalSettings
						Tab Child: dfGitGlobalAuthorName
						Tab Child: bkgdGitGlobalAuthorName
						Tab Child: cbGitGlobalAuthorOverrule
						Tab Child: bkgdGitGlobalAuthorEmail
						Tab Child: grpCommitterGlobalSettings
						Tab Child: dfGitGlobalCommitterName
						Tab Child: bkgdGitGlobalCommitterName
						Tab Child: dfGitGlobalCommitterEmail
						Tab Child: bkgdGitGlobalCommitterEmail
						Tab Child: cbGitGlobalCommitterOverrule
						Tab Child: cbPauseAfterInit
						Tab Child: rbGitAuthorUseName
						Tab Child: rbGitAuthorUseCode
						Tab Child: rbGitCommitterUseName
						Tab Child: rbGitCommitterUseCode
						Tab Child: dfGitBranchName
						Tab Child: bkgdBranchName
						Tab Child: bkgdInterval
						Tab Child: dfCommitInterval
						Tab Child: cmbGitAttributesTemplate
					Tab: pageFullHistory
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Title: Export revision list
						Visible? Yes
						Background Color: Default
						ToolTip:
						Picture File Name: Resources\TomProjectRevs.ico
						Child Window:
						XAML Style:
						Background Brush:
						Picture Transparent Color: None
						Tab Child: tblRepoRevisions
				Message Actions
					On SAM_Create
					On SAM_TabChange
						If lParam = 3
							Call tblRepoRevisions.Populate(  )
			!
			! TAB TOM repository	>>>>
			Check Box: cbShowFrozenProjects
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Show frozen projects
				Window Location and Size
					Left: 0.367"
					Top: 0.488"
					Width:  2.383"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				ToolTip: Show frozen TOM projects
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call SalWaitCursor( TRUE )
						Call guRepo.SetShowFrozenProjects( MyValue  )
						Call tblRepository.Populate(  )
						Call tblProjectModules.ForceReset(  )
						Call tblProjectRevisions.ForceReset(  )
						Call tblRepoRevisions.ForceReset(  )
						Call SalWaitCursor( FALSE )
			Check Box: cbDeltaRevisions
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Process delta revisions
				Window Location and Size
					Left: 3.133"
					Top: 0.488"
					Width:  2.683"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				ToolTip: When not checked only master files are processed
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call SalWaitCursor( TRUE )
						Call guRepo.ClearHistorySort(  )
						Call tblProjectModules.ForceReset(  )
						Call tblProjectRevisions.ForceReset(  )
						Call tblRepoRevisions.ForceReset(  )
						Call guRepo.SetProcessDeltaFiles( MyValue )
						Call tblRepository.ForceReset(  )
						Call tblRepository.Populate(  )
						If guRepo.HasSelection(  )
							Call tblRepoRevisions.Populate(  )
						Call ManageGUI(  )
						Call SalWaitCursor( FALSE )
			Background Text: bkgdGlobalRootMode
				Resource Id: 7628
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 14.467"
					Top: 0.512"
					Width:  1.9"
					Width Editable? Yes
					Height: 0.214"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Title: Global root mode
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
			Combo Box: cmbGlobalGitRootMode
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cmbcValueBase
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left: 16.483"
					Top: 0.476"
					Width:  1.867"
					Width Editable? Class Default
					Height: 1.048"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				ToolTip: Configure Project level folder
				AutoFill? Class Default
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Class Default
				Hint Text:
				IME Mode: Class Default
				Vertical Anchor: Class Default
				Horizontal Anchor: Class Default
				Minimum Width: Class Default
				Minimum Height: Class Default
				List Initialization
				Message Actions
					On SAM_Click
						Call tblRepository.UpdateGitExportSettingsRootMode( )
			!
			Child Table: tblRepository
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left: 0.25"
						Top: 0.81"
						Width:  18.117"
						Width Editable? Yes
						Height: 2.857"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
					Hide Column Headers? No
					Hide Row Headers? No
				Memory Settings
					Maximum Rows in Memory: 16000
					Discardable? No
				XAML Style:
				Summary Bar Enabled? No
				Background Brush:
				Text Brush:
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Contents
					Column: colSelect
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Center
						Width:  0.45"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
							On SAM_AnyEdit
								Call OnProjectSelect( MyValue )
							On SAM_ColumnHeaderClick
								Call SalTrackPopupMenu( hWndItem, "namedpopupRepositoryTable", TPM_CursorX | TPM_CursorY, 0, 0 )
					Column: colProjectCode
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Projectcode
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.283"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colProjectName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Projectname
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  2.6"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colProjectFrozen
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Frozen
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Center
						Width:  0.75"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colProjectStorageMethod
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Storage
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Center
						Width:  0.95"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colProjectDescription
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Description
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  3.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colProjectModules
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Modules
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.933"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colProjectRevisions
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Revisions
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.983"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colProjectSize
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Size
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  0.967"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					!
					Column: colIndex
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: INDEX
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colGitRootFolder
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Root folder
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  4.317"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
							On 0x0102
								If cmbGlobalGitRootMode != "Custom name"
									Return FALSE
							On SAM_AnyEdit
								Call OnEditRootFolder( )
				Functions
					Function: Populate
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							FunctionalVar: uSettings
								Class: cfcTMSettings
							Number: nCount
							Number: nRow
						Actions
							Call guGlobals.SetStatusTextDetail( "Populating projects..." )
							Call guGlobals.GetSettings( uSettings )
							Set wnSelectedProjectIndex = -1
							Call SalTblReset( hWndForm )
							Set nCount = 0
							While nCount < guRepo.nivTotalProjects
								If uSettings.bivShowFrozenProjects OR NOT guRepo.uaivProject[nCount].bivIsFrozen
									Set nRow = SalTblInsertRow( hWndForm, TBL_MaxRow )
									Call SalTblSetContext( hWndForm, nRow )
									Set colIndex = nCount
									Set colSelect = guRepo.uaivProject[nCount].bivIsSelected
									Set colProjectCode = guRepo.uaivProject[nCount].sivProjectCode
									Set colProjectName = guRepo.uaivProject[nCount].sivProjectName
									Set colProjectStorageMethod = guRepo.uaivProject[nCount].GetStorageMethodDescription(  )
									Set colProjectDescription = guRepo.uaivProject[nCount].sivProjectDescription
									Set colProjectModules = guRepo.uaivProject[nCount].nivTotalModules
									If guRepo.uaivProject[nCount].bivRevisionsLoaded
										Set colProjectRevisions = guRepo.uaivProject[nCount].nivTotalRevisions
										Set colProjectSize = PALConvertBytesToStr( guRepo.uaivProject[nCount].nivTotalSize )
									If guRepo.uaivProject[nCount].bivIsFrozen
										Set colProjectFrozen = "Yes"
									Select Case guRepo.uaivProject[nCount].uivRootModeSettings.GetRootMode(  )
										Case ncTOM2GIT_ROOTMODE_CODE
											Set colGitRootFolder = guRepo.uaivProject[nCount].sivProjectCode
											Break
										Case ncTOM2GIT_ROOTMODE_NAME
											Set colGitRootFolder = guRepo.uaivProject[nCount].sivProjectName
											Break
										Case ncTOM2GIT_ROOTMODE_CUSTOM
											Set colGitRootFolder = guRepo.uaivProject[nCount].uivRootModeSettings.GetCustomFolder(  )
											Break
								Set nCount = nCount + 1
							Call SalTblSortRows( hWndForm, 2, TBL_SortIncreasing )
							Call guGlobals.SetStatusTextFinished( )
					Function: UpdateRevisionsInfo
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							Number: nCount
							Number: nCurrentContext
						Actions
							Set nCurrentContext = SalTblQueryContext( hWndForm )
							Set nCount = 0
							While SalTblSetContext( hWndForm, nCount )
								If guRepo.uaivProject[colIndex].bivRevisionsLoaded
									Set colSelect = guRepo.uaivProject[colIndex].bivIsSelected
									Set colProjectRevisions = guRepo.uaivProject[colIndex].nivTotalRevisions
									Set colProjectSize = PALConvertBytesToStr( guRepo.uaivProject[colIndex].nivTotalSize )
								Set nCount = nCount + 1
							Call SalTblSetContext( hWndForm, nCurrentContext )
					Function: SelectNone
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Call guRepo.UnselectAllProjects(  )
							Call tblRepoRevisions.ForceReset(  )
							Call UpdateRevisionsInfo( )
					Function: UpdateGitExportSettingsDestination
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							Number: nCount
							Number: nCurrentContext
							Number: nDestination
						Actions
							Set nDestination = cmbGitRepoDestination.GetValue( )
							Call guGlobals.SetDestination( nDestination )
							!
							Set nCurrentContext = SalTblQueryContext( hWndForm )
							Set nCount = 0
							While SalTblSetContext( hWndForm, nCount )
								Set nCount = nCount + 1
							Call SalTblSetContext( hWndForm, nCurrentContext )
					Function: UpdateGitExportSettingsRootMode
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							Number: nCount
							Number: nCurrentContext
							Number: nRootMode
						Actions
							Set nRootMode = cmbGlobalGitRootMode.GetValue( )
							!
							Call guRepo.AppyGitExportSettingsToAll( nRootMode )
							!
							Set nCurrentContext = SalTblQueryContext( hWndForm )
							Set nCount = 0
							While SalTblSetContext( hWndForm, nCount )
								Call guRepo.uaivProject[colIndex].uivRootModeSettings.SetRootMode( nRootMode )
								!
								If nRootMode = ncTOM2GIT_ROOTMODE_CODE
									Set colGitRootFolder = colProjectCode
								Else If nRootMode = ncTOM2GIT_ROOTMODE_NAME
									Set colGitRootFolder = colProjectName
								Else If nRootMode = ncTOM2GIT_ROOTMODE_CUSTOM
									Set colGitRootFolder = guRepo.uaivProject[colIndex].uivRootModeSettings.GetCustomFolder(  )
								Set nCount = nCount + 1
							Call SalTblSetContext( hWndForm, nCurrentContext )
					Function: ForceReset
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Call SalTblReset( hWndForm )
							Call SalUpdateWindow( hWndForm  )
					Function: OnProjectSelect
						Description:
						Returns
						Parameters
							Boolean: pbSelect
						Static Variables
						Local variables
						Actions
							Set guRepo.uaivProject[colIndex].bivIsSelected = pbSelect
							Call guRepo.ClearHistorySort(  )
							Call tblRepoRevisions.ForceReset(  )
							Call ManageGUI(  )
					Function: GetSelectedProject
						Description:
						Returns
							Boolean:
						Parameters
							FunctionalVar: rpuProject
								Class: cfcTMProject
						Static Variables
						Local variables
						Actions
							If wnSelectedProjectIndex > -1
								Set rpuProject = guRepo.uaivProject[wnSelectedProjectIndex]
								Return TRUE
							Else
								Return FALSE
					Function: OnRootModeSelect
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							FunctionalVar: uProject
								Class: cfcTMProject
							Number: nRootMode
						Actions
							If guRepo.GetProjectOnIndex( colIndex, uProject )
								Set nRootMode = uProject.uivRootModeSettings.GetRootModeIDFromName( cmbGlobalGitRootMode )
								Call uProject.uivRootModeSettings.SetRootMode( nRootMode )
								If nRootMode = ncTOM2GIT_ROOTMODE_CODE
									Set colGitRootFolder = colProjectCode
								Else If nRootMode = ncTOM2GIT_ROOTMODE_NAME
									Set colGitRootFolder = colProjectName
								Else If nRootMode = ncTOM2GIT_ROOTMODE_CUSTOM
									Set colGitRootFolder = ""
					Function: OnEditRootFolder
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							FunctionalVar: uProject
								Class: cfcTMProject
						Actions
							If guRepo.GetProjectOnIndex( colIndex, uProject )
								Call uProject.uivRootModeSettings.SetRootMode( ncTOM2GIT_ROOTMODE_CUSTOM )
								Call uProject.uivRootModeSettings.SetCustomFolder( colGitRootFolder )
					Function: SelectAll
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Call ManageYield( TRUE )
							Call guRepo.SelectAllRepoRevisions(  )
							Call UpdateRevisionsInfo(  )
							Call tblRepoRevisions.ForceReset(  )
							Call ManageYield( FALSE )
				Window Variables
					Boolean: wbProjectSelected
					Number: wnSelectedProjectIndex
				Message Actions
					On SAM_Create
						Call SalTblSetColumnTitle( colSelect, "" )
						Call SalTblDefineRowHeader( hWndForm, '', 0, 0, hWndNULL )
						Call SalTblSetTableFlags( hWndForm, TBL_Flag_MovableCols , FALSE )
						Call SalTblSetTableFlags( hWndForm, TBL_Flag_SingleSelection , TRUE )
						Call SalTblSetTableFlags( hWndForm, TBL_Flag_SuppressLastColLine , TRUE )
					On WM_VSCROLL
						! His message is handled for realtime update while scrolling the thumbnail
						If SalNumberLow( wParam ) = SB_THUMBTRACK
							Call SalTblScroll( hWndForm, SalNumberHigh( wParam ), hWndNULL, TBL_ScrollTop )
					On SAM_Click
						Set wnSelectedProjectIndex = colIndex
						Call OnProjectClick( colIndex )
			!
			! TAB TeamMembers	>>>>
			Pushbutton: pbForceResetSig
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Reset
				Window Location and Size
					Left: 0.25"
					Top: 0.512"
					Width:  1.15"
					Width Editable? Yes
					Height: 0.238"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Button Appearance: Standard
				ToolTip: Original settings for name and email
				Image Alignment: Default
				Text Alignment: Default
				Text Image Relation: Default
				XAML Style:
				Background Brush:
				Text Brush:
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call guRepo.SetStaffMembersSignature( ncSIG_RESET_INIT, dfEmailSpec )
						Call tblTeamMembers.Refresh(  )
			Pushbutton: pbLoadMembersTemplate
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Load template
				Window Location and Size
					Left: 1.533"
					Top: 0.512"
					Width:  1.583"
					Width Editable? Yes
					Height: 0.238"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Button Appearance: Standard
				ToolTip: Apply teammembers template settings
				Image Alignment: Default
				Text Alignment: Default
				Text Image Relation: Default
				XAML Style:
				Background Brush:
				Text Brush:
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call guRepo.LoadStaffMembersFromTemplate(  )
						Call tblTeamMembers.Refresh(  )
			Pushbutton: pbSaveMembersTemplate
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Save template
				Window Location and Size
					Left: 3.25"
					Top: 0.512"
					Width:  1.583"
					Width Editable? Yes
					Height: 0.238"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Button Appearance: Standard
				ToolTip: Save current settings to teammembers template
				Image Alignment: Default
				Text Alignment: Default
				Text Image Relation: Default
				XAML Style:
				Background Brush:
				Text Brush:
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call guRepo.SaveStaffMembersToTemplate(  )
						Call tblTeamMembers.Refresh(  )
			Child Table: tblTeamMembers
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left: 0.25"
						Top: 0.81"
						Width:  8.467"
						Width Editable? Yes
						Height: 2.833"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
					Hide Column Headers? No
					Hide Row Headers? No
				Memory Settings
					Maximum Rows in Memory: 16000
					Discardable? No
				XAML Style:
				Summary Bar Enabled? No
				Background Brush:
				Text Brush:
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Contents
					Column: colActive
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Active
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Center
						Width:  0.767"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colCode
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Code
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.4"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colExportName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Name
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  2.7"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
							On SAM_AnyEdit
								Call OnEditSignature( )
					Column: colIndex
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: INDEX
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colExportEmail
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Email
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  3.117"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
							On SAM_AnyEdit
								Call OnEditSignature( )
					!
				Functions
					Function: Populate
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							Number: nCount
							Number: nRow
						Actions
							Call guGlobals.SetStatusTextDetail( "Populating teammembers..." )
							Call SalTblReset( hWndForm )
							Set nCount = 0
							While nCount < guRepo.nivTotalStaff
								Set nRow = SalTblInsertRow( hWndForm, TBL_MaxRow )
								Call SalTblSetContext( hWndForm, nRow )
								Set colIndex = nCount
								Set colCode = guRepo.uaivStaffMember[nCount].sivStaffCode
								Set colExportName = guRepo.uaivStaffMember[nCount].sivExportName
								Set colExportEmail = guRepo.uaivStaffMember[nCount].sivExportEmail
								If guRepo.uaivStaffMember[nCount].bivActive
									Set colActive = "Yes"
								Set nCount = nCount + 1
							Call SalTblSortRows( hWndForm, 2, TBL_SortIncreasing )
							Set dfEmailSpec = guGlobals.GetEmailBase(  )
							Call guGlobals.SetStatusTextFinished( )
					Function: Refresh
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							Number: nCount
							Number: nCurrentContext
						Actions
							Set nCurrentContext = SalTblQueryContext( hWndForm )
							Set nCount = 0
							While SalTblSetContext( hWndForm, nCount )
								Set colExportName= guRepo.uaivStaffMember[colIndex].sivExportName
								Set colExportEmail = guRepo.uaivStaffMember[colIndex].sivExportEmail
								Set nCount = nCount + 1
							Call SalTblSetContext( hWndForm, nCurrentContext )
					Function: ForceReset
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Call SalTblReset( hWndForm )
							Call SalUpdateWindow( hWndForm  )
					Function: OnEditSignature
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Set guRepo.uaivStaffMember[colIndex].sivExportName = colExportName
							Set guRepo.uaivStaffMember[colIndex].sivExportEmail = colExportEmail
				Window Variables
				Message Actions
					On SAM_Create
						Call SalTblDefineRowHeader( hWndForm, '', 0, 0, hWndNULL )
						Call SalTblSetTableFlags( hWndForm, TBL_Flag_MovableCols , FALSE )
						Call SalTblSetTableFlags( hWndForm, TBL_Flag_SingleSelection , TRUE )
						Call SalTblSetTableFlags( hWndForm, TBL_Flag_SuppressLastColLine , TRUE )
					On WM_VSCROLL
						! His message is handled for realtime update while scrolling the thumbnail
						If SalNumberLow( wParam ) = SB_THUMBTRACK
							Call SalTblScroll( hWndForm, SalNumberHigh( wParam ), hWndNULL, TBL_ScrollTop )
			Pushbutton: pbSetNamesToCode
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Copy code to name
				Window Location and Size
					Left: 8.9"
					Top: 0.821"
					Width:  1.883"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Button Appearance: Standard
				ToolTip: Use member code as name for all empty name fields
				Image Alignment: Default
				Text Alignment: Default
				Text Image Relation: Default
				XAML Style:
				Background Brush:
				Text Brush:
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call guRepo.SetStaffMembersSignature( ncSIG_CODE2NAME, dfEmailSpec )
						Call tblTeamMembers.Refresh(  )
			Group Box: grp3
				Resource Id: 19380
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 8.9"
					Top: 1.286"
					Width:  5.733"
					Width Editable? Yes
					Height: 1.369"
					Height Editable? Yes
				Visible? Yes
				GroupBox Style: Etched
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Title: Email signatures
				Line Thickness: 1
				Line Color: Default
				XAML Style:
				Background Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
			Pushbutton: pbSetNamesToEmail
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Names as email
				Window Location and Size
					Left: 9.167"
					Top: 2.012"
					Width:  1.6"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Button Appearance: Standard
				ToolTip: Set namefield as email for all empty email fields
				Image Alignment: Default
				Text Alignment: Default
				Text Image Relation: Default
				XAML Style:
				Background Brush:
				Text Brush:
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call guRepo.SetStaffMembersSignature( ncSIG_NAME2EMAIL, dfEmailSpec )
						Call tblTeamMembers.Refresh(  )
			Pushbutton: pbSetCodesToEmail
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Codes as email
				Window Location and Size
					Left: 10.933"
					Top: 2.012"
					Width:  1.6"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Button Appearance: Standard
				ToolTip: Set codefield as email for all empty email fields
				Image Alignment: Default
				Text Alignment: Default
				Text Image Relation: Default
				XAML Style:
				Background Brush:
				Text Brush:
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call guRepo.SetStaffMembersSignature( ncSIG_CODE2EMAIL, dfEmailSpec )
						Call tblTeamMembers.Refresh(  )
			Pushbutton: pbForceCustomEmail
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Force fixed
				Window Location and Size
					Left: 12.7"
					Top: 2.012"
					Width:  1.6"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Button Appearance: Standard
				ToolTip: Set all members email to fixed email address
				Image Alignment: Default
				Text Alignment: Default
				Text Image Relation: Default
				XAML Style:
				Background Brush:
				Text Brush:
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call guRepo.SetStaffMembersSignature( ncSIG_FORCE_EMAIL, dfEmailSpec )
						Call tblTeamMembers.Refresh(  )
			Background Text: bkgdEmailBase
				Resource Id: 19381
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 9.283"
					Top: 1.643"
					Width:  1.183"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Title: Email spec.
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
			Data Field: dfEmailSpec
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left: 10.6"
						Top: 1.595"
						Width:  3.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				ToolTip: Specify a fixed email address for all members
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Spell Check? No
				Hint Text:
				IME Mode: Auto
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_AnyEdit
						Call guGlobals.SetEmailBase( MyValue )
			!
			! TAB GIT		>>>>
			Group Box: grpAuthorGlobalSettings
				Resource Id: 40647
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.567"
					Top: 0.786"
					Width:  4.783"
					Width Editable? Yes
					Height: 2.25"
					Height Editable? Yes
				Visible? Yes
				GroupBox Style: Etched
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Title: Author global settings
				Line Thickness: 1
				Line Color: Default
				XAML Style:
				Background Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
			Radio Button: rbGitAuthorUseName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Staff name
				Window Location and Size
					Left: 0.95"
					Top: 1.024"
					Width:  1.633"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				ToolTip: Use staff name as author in commit
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call ScreenToGitSettings(  )
			Radio Button: rbGitAuthorUseCode
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Staff code
				Window Location and Size
					Left: 2.733"
					Top: 1.024"
					Width:  1.283"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				ToolTip: Use staff code as author in commit
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call ScreenToGitSettings(  )
			Line: lineDummy1
				Resource Id: 4909
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Coordinates
					Begin X:  Default
					Begin Y:  Default
					End X:  Default
					End Y:  Default
				Visible? No
				Line Style: Solid
				Line Thickness: 1
				Line Color: Default
				XAML Style:
				Background Brush:
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
			Radio Button: rbGitAuthorDateOrig
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Original date
				Window Location and Size
					Left: 0.95"
					Top: 1.321"
					Width:  1.633"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				ToolTip: Use original checkin date as author commit date
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call ScreenToGitSettings(  )
			Radio Button: rbGitAuthorDateNow
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Today
				Window Location and Size
					Left: 2.733"
					Top: 1.321"
					Width:  1.283"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				ToolTip: Use current date as author commit date
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call ScreenToGitSettings(  )
			Check Box: cbGitGlobalAuthorOverrule
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Overrule signature
				Window Location and Size
					Left: 0.95"
					Top: 1.655"
					Width:  2.367"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				ToolTip: Use a fixed  author
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call ScreenToGitSettings(  )
			Background Text: bkgdGitGlobalAuthorName
				Resource Id: 40648
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.9"
					Top: 2.083"
					Width:  0.833"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Title: Name
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
			Data Field: dfGitGlobalAuthorName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left: 1.85"
						Top: 2.048"
						Width:  2.967"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				ToolTip: Fixed name for author
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Spell Check? No
				Hint Text:
				IME Mode: Auto
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_AnyEdit
						Call ScreenToGitSettings(  )
			Background Text: bkgdGitGlobalAuthorEmail
				Resource Id: 40649
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.9"
					Top: 2.44"
					Width:  0.833"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Title: Email
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
			Data Field: dfGitGlobalAuthorEmail
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left: 1.85"
						Top: 2.405"
						Width:  2.967"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				ToolTip: Fixed email for author
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Spell Check? No
				Hint Text:
				IME Mode: Auto
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_AnyEdit
						Call ScreenToGitSettings(  )
			!
			Group Box: grpCommitterGlobalSettings
				Resource Id: 40650
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 5.633"
					Top: 0.786"
					Width:  4.783"
					Width Editable? Yes
					Height: 2.25"
					Height Editable? Yes
				Visible? Yes
				GroupBox Style: Etched
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Title: Committer global settings
				Line Thickness: 1
				Line Color: Default
				XAML Style:
				Background Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
			Radio Button: rbGitCommitterUseName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Staff name
				Window Location and Size
					Left: 6.05"
					Top: 1.024"
					Width:  1.633"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				ToolTip: Use staff name as committer in commit
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call ScreenToGitSettings(  )
			Radio Button: rbGitCommitterUseCode
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Staff code
				Window Location and Size
					Left: 7.983"
					Top: 1.024"
					Width:  1.283"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				ToolTip: Use staff code as committer in commit
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call ScreenToGitSettings(  )
			Line: lineDummy2
				Resource Id: 25513
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Coordinates
					Begin X:  Default
					Begin Y:  Default
					End X:  Default
					End Y:  Default
				Visible? No
				Line Style: Solid
				Line Thickness: 1
				Line Color: Default
				XAML Style:
				Background Brush:
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
			Radio Button: rbGitCommitterDateOrig
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Original date
				Window Location and Size
					Left: 6.05"
					Top: 1.321"
					Width:  1.7"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				ToolTip: Use original checkin date as committer commit date
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call ScreenToGitSettings(  )
			Radio Button: rbGitCommitterDateNow
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Today
				Window Location and Size
					Left: 7.983"
					Top: 1.321"
					Width:  1.183"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				ToolTip: Use current date as committer commit date
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call ScreenToGitSettings(  )
			Check Box: cbGitGlobalCommitterOverrule
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Overrule signature
				Window Location and Size
					Left: 6.05"
					Top: 1.655"
					Width:  2.367"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				ToolTip: Use a fixed  committer
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call ScreenToGitSettings(  )
			Background Text: bkgdGitGlobalCommitterName
				Resource Id: 40652
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 6.1"
					Top: 2.083"
					Width:  0.833"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Title: Name
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
			Data Field: dfGitGlobalCommitterName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left: 7.05"
						Top: 2.048"
						Width:  2.967"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				ToolTip: Fixed name for committer
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Spell Check? No
				Hint Text:
				IME Mode: Auto
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_AnyEdit
						Call ScreenToGitSettings(  )
			Background Text: bkgdGitGlobalCommitterEmail
				Resource Id: 40651
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 6.1"
					Top: 2.44"
					Width:  0.833"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Title: Email
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
			Data Field: dfGitGlobalCommitterEmail
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left: 7.05"
						Top: 2.405"
						Width:  2.967"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				ToolTip: Fixed email for committer
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Spell Check? No
				Hint Text:
				IME Mode: Auto
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_AnyEdit
						Call ScreenToGitSettings(  )
			!
			Pushbutton: pbGitGlobalAttributes
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: .gitattributes
				Window Location and Size
					Left: 10.817"
					Top: 0.845"
					Width:  1.45"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Button Appearance: Standard
				ToolTip: Open template in notepad
				Image Alignment: Default
				Text Alignment: Default
				Text Image Relation: Default
				XAML Style:
				Background Brush:
				Text Brush:
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call OpenTemplate( 1 )
			Combo Box: cmbGitAttributesTemplate
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cmbcTemplate
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left: 12.383"
					Top: 0.869"
					Width:  4.25"
					Width Editable? Class Default
					Height: 2.286"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Yes
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				ToolTip:
				AutoFill? Class Default
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Class Default
				Hint Text:
				IME Mode: Class Default
				Vertical Anchor: Class Default
				Horizontal Anchor: Class Default
				Minimum Width: Class Default
				Minimum Height: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call SetTemplatePrefix( ".gitattributes" )
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Click
						Call SalSendClassMessage( SAM_Click, wParam, lParam )
						Call ScreenToGitSettings( )
			Pushbutton: pbGitGlobalIgnore
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: .gitignore
				Window Location and Size
					Left: 10.817"
					Top: 1.25"
					Width:  1.45"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Button Appearance: Standard
				ToolTip: Open template in notepad
				Image Alignment: Default
				Text Alignment: Default
				Text Image Relation: Default
				XAML Style:
				Background Brush:
				Text Brush:
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call OpenTemplate( 2 )
			Combo Box: cmbGitIgnoreTemplate
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cmbcTemplate
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left: 12.383"
					Top: 1.274"
					Width:  4.25"
					Width Editable? Class Default
					Height: 2.44"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Yes
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				ToolTip:
				AutoFill? Class Default
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Class Default
				Hint Text:
				IME Mode: Class Default
				Vertical Anchor: Class Default
				Horizontal Anchor: Class Default
				Minimum Width: Class Default
				Minimum Height: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call SetTemplatePrefix( ".gitignore" )
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Click
						Call SalSendClassMessage( SAM_Click, wParam, lParam )
						Call ScreenToGitSettings( )
			Pushbutton: pbGitGlobalMessage
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Messagetext
				Window Location and Size
					Left: 10.817"
					Top: 1.655"
					Width:  1.45"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Button Appearance: Standard
				ToolTip: Open template in notepad
				Image Alignment: Default
				Text Alignment: Default
				Text Image Relation: Default
				XAML Style:
				Background Brush:
				Text Brush:
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call OpenTemplate( 3 )
			Combo Box: cmbGitMessageTemplate
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cmbcTemplate
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left: 12.383"
					Top: 1.679"
					Width:  4.25"
					Width Editable? Class Default
					Height: 2.44"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Yes
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				ToolTip:
				AutoFill? Class Default
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Class Default
				Hint Text:
				IME Mode: Class Default
				Vertical Anchor: Class Default
				Horizontal Anchor: Class Default
				Minimum Width: Class Default
				Minimum Height: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call SetTemplatePrefix( "CommitMessage" )
						Call SalSendClassMessage( SAM_Create, wParam, lParam )
					On SAM_Click
						Call SalSendClassMessage( SAM_Click, wParam, lParam )
						Call ScreenToGitSettings( )
			Background Text: bkgdBranchName
				Resource Id: 49079
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 10.65"
					Top: 2.131"
					Width:  1.633"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Title: Branch name
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
			Data Field: dfGitBranchName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left: 12.383"
						Top: 2.083"
						Width:  3.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				ToolTip: Specify the branchname for new GIT repository
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Spell Check? No
				Hint Text:
				IME Mode: Auto
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_AnyEdit
						Call ScreenToGitSettings(  )
			Background Text: bkgdInterval
				Resource Id: 58023
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 10.65"
					Top: 2.512"
					Width:  1.633"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Title: Commit interval
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
			Data Field: dfCommitInterval
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left: 12.383"
						Top: 2.476"
						Width:  1.317"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: 9999999999
				ToolTip: Time between subsequent checkins for a new commit
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Spell Check? No
				Hint Text:
				IME Mode: Auto
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_AnyEdit
						Call ScreenToGitSettings(  )
			Combo Box: cmbCommitInterval
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cmbcValueBase
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left: 13.783"
					Top: 2.476"
					Width:  1.9"
					Width Editable? Class Default
					Height: 2.595"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				ToolTip:
				AutoFill? Class Default
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Class Default
				Hint Text:
				IME Mode: Class Default
				Vertical Anchor: Class Default
				Horizontal Anchor: Class Default
				Minimum Width: Class Default
				Minimum Height: Class Default
				List Initialization
				Message Actions
					On SAM_Click
						Call ScreenToGitSettings(  )
			Check Box: cbPauseAfterInit
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Pause after GIT INIT
				Window Location and Size
					Left: 12.4"
					Top: 2.869"
					Width:  2.25"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				ToolTip: Display messagebox just after GIT repo init
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call ScreenToGitSettings(  )
			!
			! TAB: Repo revisions	>>>>
			Child Table: tblRepoRevisions
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left: 0.25"
						Top: 0.488"
						Width:  18.117"
						Width Editable? Yes
						Height: 3.06"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
					Hide Column Headers? No
					Hide Row Headers? No
				Memory Settings
					Maximum Rows in Memory: 512000
					Discardable? No
				XAML Style:
				Summary Bar Enabled? No
				Background Brush:
				Text Brush:
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Contents
					Column: colRevisionDate
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Rev. date/time
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  1.983"
						Width Editable? Yes
						Format: yyyy-MM-dd hhhh:mm:ss
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colRevisionNr
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Rev.
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.717"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colIsDelta
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Delta
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Center
						Width:  0.583"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colModifiedBy
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Modified by
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.55"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colStaffMember
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Staff member
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  2.45"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colProjectCode
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Projectcode
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.55"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colFileName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: File name
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  3.683"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colPath
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Path
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  3.683"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colIndex
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: INDEX
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colSize
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Size
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.4"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
				Functions
					Function: Populate
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							Number: nCount
							Number: nRow
							Number: nProjectIndex
							Number: nRevisionIndex
						Actions
							If guRepo.HasSelection(  )
								If wbIsPopulated AND guRepo.uivHistorySort.nivTotal > 0
									Return TRUE
								Else
									Call SalWaitCursor( TRUE )
									If NOT guRepo.uivHistorySort.nivTotal
										Call guRepo.CreateSortObject(  )
									Call SalTabSetPageTitle( tabMain, 3, "Export revision list (" || SalNumberToStrX( guRepo.uivHistorySort.nivTotal, 0 ) || ")" )
									Call guGlobals.SetStatusTextSection( "Revision history" )
									Call guGlobals.SetStatusTextDetail( "Populating revisions of selected projects..." )
									Set nCount = 0
									While nCount < guRepo.uivHistorySort.nivTotal
										Call guRepo.uivHistorySort.GetRevInfo( nCount, nProjectIndex, nRevisionIndex )
										Set nRow = SalTblInsertRow( hWndForm, TBL_MaxRow )
										Call SalTblSetContext( hWndForm, nRow )
										Set colIndex 		= nCount
										Set colProjectCode		= guRepo.uaivProject[nProjectIndex].sivProjectCode
										Set colRevisionDate	= guRepo.uaivProject[nProjectIndex].uaivRevision[nRevisionIndex].dtivRevisionDateTime
										Set colRevisionNr		= guRepo.uaivProject[nProjectIndex].uaivRevision[nRevisionIndex].nivRevisionNo
										If guRepo.uaivProject[nProjectIndex].uaivRevision[nRevisionIndex].bivIsDelta
											Set colIsDelta		= "Yes"
										Set colFileName		= guRepo.uaivProject[nProjectIndex].uaivRevision[nRevisionIndex].sivFileName
										Set colModifiedBy		= guRepo.uaivProject[nProjectIndex].uaivRevision[nRevisionIndex].sivModifiedBy
										Set colStaffMember		= guRepo.uaivProject[nProjectIndex].uaivRevision[nRevisionIndex].sivStaffMember
										Set colPath		= guRepo.uaivProject[nProjectIndex].uaivRevision[nRevisionIndex].sivFullPath
										Set colSize 		= PALConvertBytesToStr( guRepo.uaivProject[nProjectIndex].uaivRevision[nRevisionIndex].nivUncompressedSize )
										Set nCount = nCount + 1
									Call guGlobals.SetStatusTextFinished( )
									Set wbIsPopulated = TRUE
									Call SalWaitCursor( FALSE )
							Else
								Call ForceReset( )
					Function: ForceReset
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Call SalTblReset( hWndForm )
							Set wbHasSelection = FALSE
							If guRepo.bivProjectsLoaded
								Call SalTabSetPageTitle( tabMain, 3, "Export revision list (" || SalNumberToStrX( guRepo.GetSelectedProjectsRevisions( ), 0 ) || ")" )
							Else
								Call SalTabSetPageTitle( tabMain, 3, "Export revision list" )
							Set wbIsPopulated = FALSE
							Call SalUpdateWindow( hWndForm  )
					Function: SetSnapshot
						Description:
						Returns
						Parameters
							Boolean: pbReset
						Static Variables
						Local variables
							Number: nRow
							Number: nProjectIndex
							Number: nRevisionIndex
							FunctionalVar: uCurrentProject
								Class: cfcTMProject
							FunctionalVar: uCurrentRevision
								Class: cfcTMProjectModuleRevision
						Actions
							If wbHasSelection
								Call guRepo.uivHistorySort.GetRevInfo( colIndex, nProjectIndex, nRevisionIndex )
								Set uCurrentProject = guRepo.uaivProject[nProjectIndex]
								Set uCurrentRevision = uCurrentProject.uaivRevision[nRevisionIndex]
								If pbReset
									Call uCurrentProject.SetStartDateCommits( DATETIME_Null )
								Else
									Call uCurrentProject.SetStartDateCommits( uCurrentRevision.dtivRevisionDateTime )
								Set nRow = 0
								While SalTblSetContext( hWndForm, nRow )
									Call guRepo.uivHistorySort.GetRevInfo( colIndex, nProjectIndex, nRevisionIndex )
									Set uCurrentProject = guRepo.uaivProject[nProjectIndex]
									Set uCurrentRevision = uCurrentProject.uaivRevision[nRevisionIndex]
									If uCurrentProject.dtivStartDateCommits AND uCurrentRevision.dtivRevisionDateTime < uCurrentProject.dtivStartDateCommits
										Call VisTblSetRowColor( hWndForm, nRow, COLOR_DarkGray )
									Else
										Call VisTblSetRowColor( hWndForm, nRow, COLOR_Black )
									Set nRow = nRow + 1
					Function: DisplayRevInfo
						Description:
						Returns
						Parameters
							Boolean: pbCreate
						Static Variables
						Local variables
							Number: nProjectIndex
							Number: nRevisionIndex
						Actions
							Call guRepo.uivHistorySort.GetRevInfo( colIndex, nProjectIndex, nRevisionIndex )
							Call DisplayRevisionInfo( pbCreate, guRepo.uaivProject[nProjectIndex].uaivRevision[nRevisionIndex] )
					Function: OnContextMenu
						Description:
						Returns
						Parameters
							Number: pnX
							Number: pnY
						Static Variables
						Local variables
							Number: nRow
							Number: nFlags
							Window Handle: hWndCol
						Actions
							If wbHasSelection
								Call SalTblClearSelection( hWndForm)
								Set pnX = PALNumberGetSignedInteger( pnX )
								Set pnY = PALNumberGetSignedInteger( pnY )
								Call ScreenToClient( hWndForm, pnX, pnY )
								If SalTblObjectsFromPoint( hWndForm, pnX, pnY, nRow, hWndCol, nFlags ) AND nFlags & TBL_YOverNormalRows = TBL_YOverNormalRows
									Call SalTblSetFocusRow( hWndForm, nRow )
									Call SalTblSetRowFlags( hWndForm, nRow, ROW_Selected , TRUE )
									Call SalTblSetContext( hWndForm, nRow )
									Set whWndMenuParent = hWndForm
									Call SalTrackPopupMenu( hWndItem, "namedMenuRevision", TPM_CursorX | TPM_CursorY, 0, 0 )
					Function: OnExtractRevisionMenu
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							Number: nProjectIndex
							Number: nRevisionIndex
						Actions
							Call guRepo.uivHistorySort.GetRevInfo( colIndex, nProjectIndex, nRevisionIndex )
							Call ExtractRevision( guRepo.uaivProject[nProjectIndex], guRepo.uaivProject[nProjectIndex].uaivRevision[nRevisionIndex] )
				Window Variables
					Boolean: wbIsPopulated
					Boolean: wbHasSelection
				Message Actions
					On SAM_Create
						Call SalTblDefineRowHeader( hWndForm, '', 0, 0, hWndNULL )
						Call SalTblSetTableFlags( hWndForm, TBL_Flag_MovableCols , FALSE )
						Call SalTblSetTableFlags( hWndForm, TBL_Flag_SingleSelection , TRUE )
						Call SalTblSetTableFlags( hWndForm, TBL_Flag_SuppressLastColLine , TRUE )
					On SAM_Click
						Set wbHasSelection = TRUE
						Call DisplayRevInfo( FALSE )
					On SAM_DoubleClick
						Call DisplayRevInfo( TRUE )
					On SAM_ContextMenu
						Call OnContextMenu( wParam, lParam )
					On PAM_ExtractRevision
						Call OnExtractRevisionMenu( )
					On PAM_SetSnapshot
						! wParam = TRUE -> reset, wParam FALSE -> set
						Call SetSnapshot( wParam )
					On WM_VSCROLL
						! His message is handled for realtime update while scrolling the thumbnail
						If SalNumberLow( wParam ) = SB_THUMBTRACK
							Call SalTblScroll( hWndForm, SalNumberHigh( wParam ), hWndNULL, TBL_ScrollTop )
			!
			Line: lineSeparator
				Resource Id: 13488
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Coordinates
					Begin X:  -0.033"
					Begin Y:  3.786"
					End X:  19.967"
					End Y:  3.786"
				Visible? Yes
				Line Style: Etched
				Line Thickness: 1
				Line Color: Default
				XAML Style:
				Background Brush:
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
			!
			Tab Bar: tabDetails
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left: 0.1"
						Top: 3.905"
						Width:  18.417"
						Width Editable? Yes
						Height: 3.786"
						Height Editable? Yes
					Visible? Yes
					Orientation? Top
					Style? Standard
					Enable Scroll? No
					Tile To Parent? No
					Left Margin:  Default
					Right Margin:  Default
					Top Margin:  Default
					Bottom Margin:  Default
					Border? No
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Invert Vertical Font? No
					Multi Row: No
					Show Close Buttons: No
				XAML Style:
				Background Brush:
				Anchoring Enabled? No
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Anchor Maximum Width: Default
				Anchor Maximum Height: Default
				Contents
					Tab: pageProjectModules
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Title: Project modules
						Visible? Yes
						Background Color: Default
						ToolTip:
						Picture File Name: Resources\TomProjectModules.ico
						Child Window:
						XAML Style:
						Background Brush:
						Picture Transparent Color: None
						Tab Child: tblProjectModules
					Tab: pageProjectRevisions
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Title: Project revisions
						Visible? Yes
						Background Color: Default
						ToolTip:
						Picture File Name: Resources\TomProjectRevs.ico
						Child Window:
						XAML Style:
						Background Brush:
						Picture Transparent Color: None
						Tab Child: tblProjectRevisions
						Tab Child: pbRevisionInfo
						Tab Child: pbSaveRevision
						Tab Child: cmbModuleSelect
						Tab Child: bkgdModuleSelect
						Tab Child: OnDisplayRevisionInfo
						Tab Child: pbSnapshot
						Tab Child: dfSnapshot
				Message Actions
			! TAB: Project modules	>>>>
			Child Table: tblProjectModules
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left: 0.25"
						Top: 4.452"
						Width:  18.117"
						Width Editable? Yes
						Height: 3.048"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
					Hide Column Headers? No
					Hide Row Headers? No
				Memory Settings
					Maximum Rows in Memory: 512000
					Discardable? No
				XAML Style:
				Summary Bar Enabled? No
				Background Brush:
				Text Brush:
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Contents
					Column: colFileName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: File name
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  3.683"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colPath
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Path
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  3.683"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colLastRevNo
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Last revision
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.217"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colRevisionDate
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Last rev. date/time
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  1.983"
						Width Editable? Yes
						Format: yyyy-MM-dd hhhh:mm:ss
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colModifiedBy
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Last modified by
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.8"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colIndex
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: INDEX
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colStaffMember
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Staff member
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  2.45"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
				Functions
					Function: Populate
						Description:
						Returns
						Parameters
							FunctionalVar: puProject
								Class: cfcTMProject
						Static Variables
						Local variables
							Number: nCount
							Number: nRow
							FunctionalVar: uRevision
								Class: cfcTMProjectModuleRevision
						Actions
							Call SalWaitCursor( TRUE )
							Call ForceReset( )
							Call guGlobals.SetStatusTextSection( "Populating modules" )
							Call guGlobals.SetStatusTextDetail( "Project " || puProject.sivProjectCode  ||  "..." )
							Call SalTabSetPageTitle( tabDetails, 0, "Project modules: " || puProject.sivProjectCode || " (" || SalNumberToStrX( puProject.nivTotalModules, 0 ) || ")" )
							Set nCount = 0
							While nCount < puProject.nivTotalModules
								Set nRow = SalTblInsertRow( hWndForm, TBL_MaxRow )
								Call SalTblSetContext( hWndForm, nRow )
								Set colIndex 		= nCount
								Set colFileName		= puProject.uaivModule[nCount].sivFileName
								Set colPath		= puProject.GetFullPathOnFolderID( puProject.uaivModule[nCount].nivFolderID )
								If puProject.GetLatestRevisionForModule( puProject.uaivModule[nCount].nivModuleID, uRevision )
									Set colLastRevNo		= uRevision.nivRevisionNo
									Set colRevisionDate	= uRevision.dtivRevisionDateTime
									Set colModifiedBy		= uRevision.sivModifiedBy
									Set colStaffMember		= uRevision.sivStaffMember
								Set nCount = nCount + 1
							Call guGlobals.SetStatusTextFinished( )
							Call SalWaitCursor( FALSE )
					Function: ForceReset
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Call SalTblReset( hWndForm )
							Call SalTabSetPageTitle( tabDetails, 0, "Project modules" )
							Call SalUpdateWindow( hWndForm  )
				Window Variables
				Message Actions
					On SAM_Create
						Call SalTblDefineRowHeader( hWndForm, '', 0, 0, hWndNULL )
						Call SalTblSetTableFlags( hWndForm, TBL_Flag_MovableCols , FALSE )
						Call SalTblSetTableFlags( hWndForm, TBL_Flag_SingleSelection , TRUE )
						Call SalTblSetTableFlags( hWndForm, TBL_Flag_SuppressLastColLine , TRUE )
					On WM_VSCROLL
						! His message is handled for realtime update while scrolling the thumbnail
						If SalNumberLow( wParam ) = SB_THUMBTRACK
							Call SalTblScroll( hWndForm, SalNumberHigh( wParam ), hWndNULL, TBL_ScrollTop )
			!
			! TAB: Project revisions	>>>>
			Pushbutton: pbRevisionInfo
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Details
				Window Location and Size
					Left: 0.267"
					Top: 4.321"
					Width:  1.35"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: Resources\details.png
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Button Appearance: Standard
				ToolTip: Display revision details
				Image Alignment: Center Left
				Text Alignment: Center Center
				Text Image Relation: Image Before
				XAML Style:
				Background Brush:
				Text Brush:
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call tblProjectRevisions.OnDisplayRevisionInfo( )
			Pushbutton: pbSaveRevision
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Revision
				Window Location and Size
					Left: 1.817"
					Top: 4.321"
					Width:  1.35"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: Resources\Save.bmp
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Button Appearance: Standard
				ToolTip: Export revision
				Image Alignment: Center Left
				Text Alignment: Center Center
				Text Image Relation: Image Before
				XAML Style:
				Background Brush:
				Text Brush:
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call tblProjectRevisions.OnExtractRevisionMenu( )
			Pushbutton: pbSnapshot
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Snapshot  
				Window Location and Size
					Left: 3.367"
					Top: 4.321"
					Width:  1.35"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: Resources\screenshot-16.ico
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Button Appearance: Standard
				ToolTip: Set or remove snapshot date
				Image Alignment: Center Left
				Text Alignment: Center Center
				Text Image Relation: Image Before
				XAML Style:
				Background Brush:
				Text Brush:
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call SalTrackPopupMenu( hWndItem, "namedMenuRevision", TPM_CursorX | TPM_CursorY, 0, 0 )
			Data Field: dfSnapshot
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left: 4.8"
						Top: 4.357"
						Width:  2.583"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: yyyy-MM-dd hhhh:mm:ss
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				ToolTip:
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Spell Check? No
				Hint Text:
				IME Mode: Auto
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Create
						Call SalDisableWindow( hWndItem )
			Background Text: bkgdModuleSelect
				Resource Id: 52479
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 7.933"
					Top: 4.381"
					Width:  1.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Title: Filter module
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
			Combo Box: cmbModuleSelect
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cmbcValueBase
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left: 9.867"
					Top: 4.357"
					Width:  8.233"
					Width Editable? Class Default
					Height: 6.0"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				ToolTip: Filter revisions on filename
				AutoFill? Class Default
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Class Default
				Hint Text:
				IME Mode: Class Default
				Vertical Anchor: Class Default
				Horizontal Anchor: Class Default
				Minimum Width: Class Default
				Minimum Height: Class Default
				List Initialization
				Message Actions
					On SAM_Click
						Call tblProjectRevisions.FilterModule( GetValue( ) )
			Child Table: tblProjectRevisions
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left: 0.25"
						Top: 4.702"
						Width:  18.117"
						Width Editable? Yes
						Height: 2.857"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
					Hide Column Headers? No
					Hide Row Headers? No
				Memory Settings
					Maximum Rows in Memory: 512000
					Discardable? No
				XAML Style:
				Summary Bar Enabled? No
				Background Brush:
				Text Brush:
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Contents
					Column: colRevisionDate
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Rev. date/time
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  1.983"
						Width Editable? Yes
						Format: yyyy-MM-dd hhhh:mm:ss
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colRevisionNr
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Rev.
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.717"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colIsDelta
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Delta
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Center
						Width:  0.583"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colIsCompressed
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Compressed
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Center
						Width:  1.217"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colModifiedBy
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Modified by
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.55"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colStaffMember
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Staff member
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  2.45"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colFileName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: File name
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  3.683"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colPath
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Path
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  3.683"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colIndex
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: INDEX
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colSize
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Size
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.4"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
				Functions
					Function: Populate
						Description:
						Returns
						Parameters
							FunctionalVar: puProject
								Class: cfcTMProject
						Static Variables
						Local variables
							Number: nCount
							Number: nRow
						Actions
							Call SalWaitCursor( TRUE )
							Call ForceReset( )
							Call guGlobals.SetStatusTextSection( "Populating revisions" )
							Call guGlobals.SetStatusTextDetail( "Project " || puProject.sivProjectCode  ||  "..." )
							Call SalTabSetPageTitle( tabDetails, 1, "Project revisions: " || puProject.sivProjectCode || " (" || SalNumberToStrX( puProject.nivTotalRevisions, 0 ) || ")" )
							Set wuSelectedProject = puProject
							Set nCount = 0
							While nCount < puProject.nivTotalRevisions
								Set nRow = SalTblInsertRow( hWndForm, TBL_MaxRow )
								Call SalTblSetContext( hWndForm, nRow )
								Set colIndex 		= nCount
								Set colRevisionNr		= puProject.uaivRevision[nCount].nivRevisionNo
								Set colRevisionDate	= puProject.uaivRevision[nCount].dtivRevisionDateTime
								If puProject.uaivRevision[nCount].bivIsDelta
									Set colIsDelta		= "Yes"
								If puProject.uaivRevision[nCount].bivIsCompressed
									Set colIsCompressed	= "Yes"
								Set colFileName		= puProject.uaivRevision[nCount].sivFileName
								Set colModifiedBy		= puProject.uaivRevision[nCount].sivModifiedBy
								Set colStaffMember		= puProject.uaivRevision[nCount].sivStaffMember
								Set colPath		= puProject.uaivRevision[nCount].sivFullPath
								Set colSize 		= PALConvertBytesToStr( puProject.uaivRevision[nCount].nivUncompressedSize )
								If puProject.dtivStartDateCommits AND puProject.uaivRevision[nCount].dtivRevisionDateTime < puProject.dtivStartDateCommits
									Call VisTblSetRowColor( hWndForm, nRow, COLOR_DarkGray )
								Set nCount = nCount + 1
							Set wbHasSelection = FALSE
							Set dfSnapshot = wuSelectedProject.dtivStartDateCommits
							Call guGlobals.SetStatusTextFinished( )
							Call SalWaitCursor( FALSE )
					Function: FilterModule
						Description:
						Returns
						Parameters
							Number: pnModuleID
						Static Variables
						Local variables
							Number: nRow
						Actions
							Call SalWaitCursor( TRUE )
							Set nRow = 0
							While SalTblSetContext( hWndForm, nRow )
								If pnModuleID = 0 OR wuSelectedProject.uaivRevision[colIndex].nivModuleID = pnModuleID
									Call SalTblSetRowFlags( hWndForm, nRow, ROW_Hidden, FALSE )
								Else
									Call SalTblSetRowFlags( hWndForm, nRow, ROW_Hidden, TRUE )
								Set nRow = nRow + 1
							Call SalWaitCursor( FALSE )
					Function: ForceReset
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Call SalTblReset( hWndForm )
							Set wbHasSelection = FALSE
							Set dfSnapshot = DATETIME_Null
							Call SalListSetSelect( cmbModuleSelect, -1 )
							Call SalTabSetPageTitle( tabDetails, 1, "Project revisions" )
							Call SalUpdateWindow( hWndForm  )
					Function: OnContextMenu
						Description:
						Returns
						Parameters
							Number: pnX
							Number: pnY
						Static Variables
						Local variables
							Number: nRow
							Number: nFlags
							Window Handle: hWndCol
						Actions
							If wbHasSelection
								Call SalTblClearSelection( hWndForm)
								Set pnX = PALNumberGetSignedInteger( pnX )
								Set pnY = PALNumberGetSignedInteger( pnY )
								Call ScreenToClient( hWndForm, pnX, pnY )
								If SalTblObjectsFromPoint( hWndForm, pnX, pnY, nRow, hWndCol, nFlags ) AND nFlags & TBL_YOverNormalRows = TBL_YOverNormalRows
									Call SalTblSetFocusRow( hWndForm, nRow )
									Call SalTblSetRowFlags( hWndForm, nRow, ROW_Selected , TRUE )
									Call SalTblSetContext( hWndForm, nRow )
									Set whWndMenuParent = hWndForm
									Call SalTrackPopupMenu( hWndItem, "namedMenuRevision", TPM_CursorX | TPM_CursorY, 0, 0 )
					Function: SetSnapshot
						Description:
						Returns
						Parameters
							Boolean: pbReset
						Static Variables
						Local variables
							Number: nRow
						Actions
							If wbHasSelection
								If pbReset
									Call wuSelectedProject.SetStartDateCommits( DATETIME_Null )
								Else
									Call wuSelectedProject.SetStartDateCommits( wuSelectedProject.uaivRevision[colIndex].dtivRevisionDateTime )
								Set dfSnapshot = wuSelectedProject.dtivStartDateCommits
								Set nRow = 0
								While SalTblSetContext( hWndForm, nRow )
									If wuSelectedProject.dtivStartDateCommits AND wuSelectedProject.uaivRevision[colIndex].dtivRevisionDateTime < wuSelectedProject.dtivStartDateCommits
										Call VisTblSetRowColor( hWndForm, nRow, COLOR_DarkGray )
									Else
										Call VisTblSetRowColor( hWndForm, nRow, COLOR_Black )
									Set nRow = nRow + 1
							Call ManageGUI_ProjectRevisions(  )
					Function: HasSelection
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
						Actions
							Return wbHasSelection
					Function: GetSelectedProject
						Description:
						Returns
							Boolean:
						Parameters
							FunctionalVar: rpuProject
								Class: cfcTMProject
						Static Variables
						Local variables
						Actions
							If HasSelection( )
								Set rpuProject = wuSelectedProject
								Return TRUE
							Return FALSE
					Function: OnExtractRevisionMenu
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Call ExtractRevision( wuSelectedProject, wuSelectedProject.uaivRevision[colIndex] )
					Function: OnDisplayRevisionInfo
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Call DisplayRevisionInfo( TRUE, wuSelectedProject.uaivRevision[colIndex] )
				Window Variables
					FunctionalVar: wuSelectedProject
						Class: cfcTMProject
					Boolean: wbHasSelection
				Message Actions
					On SAM_Create
						Call SalTblDefineRowHeader( hWndForm, '', 0, 0, hWndNULL )
						Call SalTblSetTableFlags( hWndForm, TBL_Flag_MovableCols , FALSE )
						Call SalTblSetTableFlags( hWndForm, TBL_Flag_SingleSelection , TRUE )
						Call SalTblSetTableFlags( hWndForm, TBL_Flag_SuppressLastColLine , TRUE )
					On SAM_Click
						Set wbHasSelection = TRUE
						Call ManageGUI_ProjectRevisions(  )
						Call DisplayRevisionInfo( FALSE, wuSelectedProject.uaivRevision[colIndex] )
					On SAM_ContextMenu
						Call OnContextMenu( wParam, lParam )
					On PAM_ExtractRevision
						Call OnExtractRevisionMenu( )
					On PAM_SetSnapshot
						! wParam = TRUE -> reset, wParam FALSE -> set
						Call SetSnapshot( wParam )
					On WM_VSCROLL
						! His message is handled for realtime update while scrolling the thumbnail
						If SalNumberLow( wParam ) = SB_THUMBTRACK
							Call SalTblScroll( hWndForm, SalNumberHigh( wParam ), hWndNULL, TBL_ScrollTop )
					On SAM_DoubleClick
						Call OnDisplayRevisionInfo( )
		Background Threads:
		Functions
			Function: Init
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nID
					FunctionalVar: uSettings
						Class: cfcTMSettings
				Actions
					Call SalSetWindowText( hWndForm, "Tom2Git - v" || scTOM2GIT_VERSION )
					Call guGlobals.Init(  )
					Call guGlobals.GetSettings( uSettings )
					Set dfWorkfolder = PALPathCompactPathEx( uSettings.GetWorkFolder(  ), 35)
					Set guGlobals.hWndivStatusBar = hWndForm
					Set guGlobals.hWndivProgress = hWndForm
					Set nID = SalStatusCreateProgressBar( hWndForm, 0, 200, TEMPLATE_Null )
					Call SalStatusSetPaneVisible( hWndForm, 1, FALSE )
					Set guGlobals.nivStatusTextPane = SalStatusAddPane( hWndForm, 1, 150, TEMPLATE_Null )
					Set guGlobals.nivStatusTextPane2 = SalStatusAddPane( hWndForm, 2, 500, TEMPLATE_Null )
					Set cbShowFrozenProjects = uSettings.bivShowFrozenProjects
					Set cbDeltaRevisions = uSettings.bivProcessDeltaFiles
					Set cbAbortOnError = uSettings.bivAbortOnError
					Call guRepo.SetShowFrozenProjects( cbShowFrozenProjects  )
					Set dfEmailSpec = uSettings.sivEmailBase
					Call PopulateGitSettings(  )
					Call PopulateDestinationCombo(  )
					Call PopulateGlobalGitRootModeCombo( )
					Call PopulateCommitIntervalCombo( )
					Call PopulateLogModeCombo( )
					Call guGlobals.StopProgress(  )
					!
					Call ManageYield( FALSE )
			Function: ConnectTOM
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If SalModalDialog( dlgLogin, hWndForm )
						Call SalSetWindowText( hWndForm, "Tom2Git - v" || scTOM2GIT_VERSION || " [" || SqlDatabase || "] [" || PALGetDBBrandName( PALSqlGetDatabaseBrand(  ) ) || "]" )
						Call ManageGUI(  )
						Call LoadRepository( )
					Call ManageGUI(  )
			Function: DisconnectTOM
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call guGlobals.Disconnect(  )
					If whWndRevInfo
						Call SalDestroyWindow( whWndRevInfo )
						Set whWndRevInfo = hWndNULL
					Call SalSetWindowText( hWndForm, "Tom2Git - v" || scTOM2GIT_VERSION )
					Set guRepo = new cfcTMRepository( )
					Call ResetAllTables(  )
					Call SalSetFocus( pbConnectTOM )
			Function: SetWorkFolder
				Description:
				Returns
				Parameters
					Boolean: pbSetWorkfolder
				Static Variables
				Local variables
					String: sWorkfolder
					String: sPathParam 
				Actions
					Set sWorkfolder = guGlobals.GetWorkFolder(  )
					If pbSetWorkfolder
						If wuShellDlg.DlgBrowseFolder( hWndForm, "Select Tom2Git workfolder", 0, sWorkfolder )
							Call guGlobals.SetWorkFolder( sWorkfolder )
							Set dfWorkfolder = PALPathCompactPathEx( guGlobals.GetWorkFolder(  ), 35)
					Else
						Call PALPathAddBackslash( sWorkfolder )
						Set sPathParam = "/open,\"" || sWorkfolder || "\""
						Call ShellExecuteA( hWndNULL, "open" , "explorer.exe", sPathParam, STRING_Null, SHOW_Normal )
			Function: OpenTempFolder
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sTempFolder
					String: sPathParam 
				Actions
					Set sTempFolder = guGlobals.GetTom2GitTempFolder(  )
					Call PALPathAddBackslash( sTempFolder )
					Set sPathParam = "/open,\"" || sTempFolder || "\""
					Call ShellExecuteA( hWndNULL, "open" , "explorer.exe", sPathParam, STRING_Null, SHOW_Normal )
			Function: OpenGitHubPage
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call ShellExecuteA( hWndNULL, "open" , "https://github.com/TD-Community/Tom2Git", STRING_Null, STRING_Null, SHOW_Normal )
			Function: OpenTemplatesFolder
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sTemplatesFolder
					String: sPathParam 
				Actions
					Set sTemplatesFolder = guGlobals.GetTemplatesFolder(  )
					Call PALPathAddBackslash( sTemplatesFolder )
					Set sPathParam = "/open,\"" || sTemplatesFolder || "\""
					Call ShellExecuteA( hWndNULL, "open" , "explorer.exe", sPathParam, STRING_Null, SHOW_Normal )
			Function: OpenTemplate
				Description:
				Returns
				Parameters
					Number: pnTemplateType	! 1=attributes, 2=ignore, 3=message
				Static Variables
				Local variables
					FunctionalVar: uSettings
						Class: cfcTMSettings
					String: sFile
				Actions
					Call guGlobals.GetSettings( uSettings )
					If pnTemplateType = 1
						Set sFile = guGlobals.GetTemplatesFolder(  ) || uSettings.sivGitAttributesTemplate
					Else If pnTemplateType = 2
						Set sFile = guGlobals.GetTemplatesFolder(  ) || uSettings.sivGitIgnoreTemplate
					Else If pnTemplateType = 3
						Set sFile = guGlobals.GetTemplatesFolder(  ) || uSettings.sivMessageTextTemplate
					Call SalLoadApp( "notepad.exe", sFile )
			Function: LoadRepository
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalWaitCursor( TRUE )
					Call tblRepository.ForceReset(  )
					Call tblProjectModules.ForceReset(  )
					Call tblProjectRevisions.ForceReset(  )
					Call tblRepoRevisions.ForceReset(  )
					If guRepo.LoadRepository( )
						Call tblRepository.Populate(  )
						Call tblTeamMembers.Populate(  )
					Call SalWaitCursor( FALSE )
			Function: OnProjectClick
				Description:
				Returns
				Parameters
					Number: pnProjectIndex
				Static Variables
				Local variables
					FunctionalVar: uProject
						Class: cfcTMProject
				Actions
					Call SalWaitCursor( TRUE )
					Call tblProjectModules.ForceReset(  )
					Call tblProjectRevisions.ForceReset(  )
					If guRepo.GetProjectOnIndex( pnProjectIndex, uProject )
						If uProject.LoadProjectRevisions( FALSE )
							Call tblProjectModules.Populate( uProject )
							Call tblRepository.UpdateRevisionsInfo( )
							Call tblProjectRevisions.Populate( uProject )
							Call PopulateModuleSelectCombo( uProject )
					Call ManageGUI(  )
					Call SalWaitCursor( FALSE )
			Function: ManageGUI
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If guGlobals.bivConnected
						Call SalHideWindow( pbConnectTOM )
						Call SalDisableWindow( pbConnectTOM )
						Call SalShowWindow( pbDisconnectTOM )
						Call SalEnableWindow( pbDisconnectTOM )
						If guRepo.HasSelection(  )
							Call SalEnableWindow( pbExportToGit )
							Call SalEnableWindow( pbCreateSnapshot )
						Else
							Call SalDisableWindow( pbExportToGit )
							Call SalDisableWindow( pbCreateSnapshot )
						Call SalEnableWindow( cmbGitRepoDestination )
					Else
						Call SalHideWindow( pbDisconnectTOM )
						Call SalDisableWindow( pbDisconnectTOM )
						Call SalShowWindow( pbConnectTOM )
						Call SalEnableWindow( pbConnectTOM )
						Call SalDisableWindow( pbExportToGit )
						Call SalDisableWindow( pbCreateSnapshot )
						Call SalDisableWindow( cmbGitRepoDestination )
					Call ManageGUI_ProjectRevisions( )
					Call ManageGUI_TeamMembers( )
					Call ManageGUI_GitSettings( )
			Function: ManageGUI_ProjectRevisions
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If guGlobals.bivConnected
						Call SalEnableWindow( cmbModuleSelect )
						If tblProjectRevisions.HasSelection(  )
							Call SalEnableWindow( pbSnapshot )
							Call SalEnableWindow( pbRevisionInfo )
							Call SalEnableWindow( pbSaveRevision )
						Else
							Call SalDisableWindow( pbSnapshot )
							Call SalDisableWindow( pbRevisionInfo )
							Call SalDisableWindow( pbSaveRevision )
					Else
						Call SalDisableWindow( pbSnapshot )
						Call SalDisableWindow( cmbModuleSelect )
						Call SalDisableWindow( pbRevisionInfo )
						Call SalDisableWindow( pbSaveRevision )
			Function: ManageGUI_TeamMembers
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If guGlobals.bivConnected
						Call SalEnableWindow( pbForceResetSig )
						Call SalEnableWindow( pbLoadMembersTemplate )
						Call SalEnableWindow( pbSaveMembersTemplate )
						Call SalEnableWindow( pbSetNamesToCode )
						Call SalEnableWindow( pbSetCodesToEmail )
						Call SalEnableWindow( pbSetNamesToEmail )
						Call SalEnableWindow( pbForceCustomEmail )
						Call SalEnableWindow( dfEmailSpec )
					Else
						Call SalDisableWindow( pbForceResetSig )
						Call SalDisableWindow( pbLoadMembersTemplate )
						Call SalDisableWindow( pbSaveMembersTemplate )
						Call SalDisableWindow( pbSetNamesToCode )
						Call SalDisableWindow( pbSetCodesToEmail )
						Call SalDisableWindow( pbSetNamesToEmail )
						Call SalDisableWindow( pbForceCustomEmail )
						Call SalDisableWindow( dfEmailSpec )
			Function: ManageGUI_GitSettings
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If cbGitGlobalAuthorOverrule
						Call SalEnableWindow( dfGitGlobalAuthorName )
						Call SalEnableWindow( dfGitGlobalAuthorEmail )
					Else
						Call SalDisableWindow( dfGitGlobalAuthorName )
						Call SalDisableWindow( dfGitGlobalAuthorEmail )
					If cbGitGlobalCommitterOverrule
						Call SalEnableWindow( dfGitGlobalCommitterName )
						Call SalEnableWindow( dfGitGlobalCommitterEmail )
					Else
						Call SalDisableWindow( dfGitGlobalCommitterName )
						Call SalDisableWindow( dfGitGlobalCommitterEmail )
					If cmbCommitInterval.GetValue(  ) = ncINTERVAL_NONE
						Call SalDisableWindow( dfCommitInterval )
					Else
						Call SalEnableWindow( dfCommitInterval )
					If cmbGitAttributesTemplate.GetValue(  ) = 0
						Call SalDisableWindow( pbGitGlobalAttributes )
					Else
						Call SalEnableWindow( pbGitGlobalAttributes )
					If cmbGitIgnoreTemplate.GetValue(  ) = 0
						Call SalDisableWindow( pbGitGlobalIgnore )
					Else
						Call SalEnableWindow( pbGitGlobalIgnore )
					If cmbGitMessageTemplate.GetValue(  ) = 0
						Call SalDisableWindow( pbGitGlobalMessage )
					Else
						Call SalEnableWindow( pbGitGlobalMessage )
			Function: ManageYield
				Description:
				Returns
				Parameters
					Boolean: pbEnable
				Static Variables
				Local variables
				Actions
					Call ManageGUI( )
					If pbEnable
						Call guGlobals.StartAction(  )
						Call SalEnableWindow( pbCANCEL )
						Call SalShowWindow( pbCANCEL )
						Call SalYieldStartMessages( pbCANCEL )
					Else
						Call guGlobals.StopAction(  )
						Call SalYieldStopMessages( )
						Call SalDisableWindow( pbCANCEL )
						Call SalHideWindow( pbCANCEL )
					Call ManageGUI(  )
					Call SalInvalidateWindow( hWndForm )
					Call SalUpdateWindow( hWndForm )
			Function: PopulateModuleSelectCombo
				Description:
				Returns
				Parameters
					FunctionalVar: puProject
						Class: cfcTMProject
				Static Variables
				Local variables
					Number: nCount
					String: sFile
				Actions
					Call SalListClear( cmbModuleSelect )
					Call VisListAddValue( cmbModuleSelect, "", 0 )
					While nCount < puProject.nivTotalModules
						Set sFile = puProject.GetFullPathOnFolderID( puProject.uaivModule[nCount].nivFolderID ) || "\\" || puProject.uaivModule[nCount].sivFileName
						Call VisListAddValue( cmbModuleSelect, sFile, puProject.uaivModule[nCount].nivModuleID )
						Set nCount = nCount + 1
			Function: PopulateGlobalGitRootModeCombo
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					FunctionalVar: uRootModeSettings
						Class: cfcTMRootModeSettings
				Actions
					Call VisListAddValue( cmbGlobalGitRootMode, uRootModeSettings.GetRootModeNameFromID( ncTOM2GIT_ROOTMODE_CODE ), ncTOM2GIT_ROOTMODE_CODE )
					Call VisListAddValue( cmbGlobalGitRootMode, uRootModeSettings.GetRootModeNameFromID( ncTOM2GIT_ROOTMODE_NAME ), ncTOM2GIT_ROOTMODE_NAME )
					Call VisListAddValue( cmbGlobalGitRootMode, uRootModeSettings.GetRootModeNameFromID( ncTOM2GIT_ROOTMODE_CUSTOM ), ncTOM2GIT_ROOTMODE_CUSTOM )
					Call cmbGlobalGitRootMode.SelectValue( ncTOM2GIT_ROOTMODE_CODE )
			Function: PopulateLogModeCombo
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					FunctionalVar: uSettings
						Class: cfcTMSettings
				Actions
					Call guGlobals.GetSettings( uSettings )
					!
					Call VisListAddValue( cmbLogMode, "Log all", ncTOM2GIT_LOGMODE_FULL )
					Call VisListAddValue( cmbLogMode, "Log errors", ncTOM2GIT_LOGMODE_ERRORS )
					Call cmbLogMode.SelectValue( uSettings.nivLogMode )
			Function: PopulateDestinationCombo
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call VisListAddValue( cmbGitRepoDestination, "One single GIT repository (MonoRepo)", ncTOM2GIT_DEST_MONO )
					Call VisListAddValue( cmbGitRepoDestination, "Seperate GIT repositories (PolyRepo)", ncTOM2GIT_DEST_POLY )
					Call cmbGitRepoDestination.SelectValue( guGlobals.GetDestination(  ) )
			Function: PopulateCommitIntervalCombo
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					FunctionalVar: uSettings
						Class: cfcTMSettings
				Actions
					Call guGlobals.GetSettings( uSettings )
					!
					Call VisListAddValue( cmbCommitInterval, "No interval", ncINTERVAL_NONE )
					Call VisListAddValue( cmbCommitInterval, "Seconds", ncINTERVAL_SECONDS)
					Call VisListAddValue( cmbCommitInterval, "Minutes", ncINTERVAL_MINUTES )
					Call VisListAddValue( cmbCommitInterval, "Hours", ncINTERVAL_HOURS )
					Call VisListAddValue( cmbCommitInterval, "Days", ncINTERVAL_DAYS )
					Call VisListAddValue( cmbCommitInterval, "Weeks", ncINTERVAL_WEEKS )
					Call VisListAddValue( cmbCommitInterval, "Months", ncINTERVAL_MONTHS )
					Call VisListAddValue( cmbCommitInterval, "Years", ncINTERVAL_YEARS )
					Call cmbCommitInterval.SelectValue( uSettings.nivIntervalMode )
			Function: PopulateGitSettings
				Description: void PopulateGitSettings( )
						Populate the GIT tab section from the settings object
						
						No Parameters
						No Return value
				Returns
				Parameters
				Static Variables
				Local variables
					FunctionalVar: uSettings
						Class: cfcTMSettings
				Actions
					Call guGlobals.GetSettings( uSettings )
					!
					! Author settings
					Set rbGitAuthorDateNow = uSettings.bivSignatureAuthorCurrentDate
					Set rbGitAuthorUseCode = uSettings.bivSignatureAuthorCode
					Set cbGitGlobalAuthorOverrule = uSettings.bivSignatureAuthorOverrule
					Set dfGitGlobalAuthorName = uSettings.sivSignatureAuthorName
					Set dfGitGlobalAuthorEmail = uSettings.sivSignatureAuthorEmail
					!
					! Committer settings
					Set rbGitCommitterDateNow = uSettings.bivSignatureCommitterCurrentDate
					Set rbGitCommitterUseCode = uSettings.bivSignatureCommitterCode
					Set cbGitGlobalCommitterOverrule = uSettings.bivSignatureCommitterOverrule
					Set dfGitGlobalCommitterName = uSettings.sivSignatureCommitterName
					Set dfGitGlobalCommitterEmail = uSettings.sivSignatureCommitterEmail
					!
					! Template settings
					Call cmbGitAttributesTemplate.SelectTemplate( uSettings.sivGitAttributesTemplate )
					Call cmbGitIgnoreTemplate.SelectTemplate( uSettings.sivGitIgnoreTemplate )
					Call cmbGitMessageTemplate.SelectTemplate( uSettings.sivMessageTextTemplate )
					!
					! Misc settings
					Set dfGitBranchName = uSettings.sivBranchName
					Set cbPauseAfterInit = uSettings.bivPauseOnInit
					Set dfCommitInterval = uSettings.nivIntervalValue
			Function: ScreenToGitSettings
				Description: void ScreenToGitSettings( )
						Puts all GUI values in GIT tab section to the settings object.
						This is called every time a setting in the GUI is changed.
						
						No Parameters
						No Return value
				Returns
				Parameters
				Static Variables
				Local variables
					FunctionalVar: uSettings
						Class: cfcTMSettings
				Actions
					Call guGlobals.GetSettings( uSettings )
					!
					! Author settings
					Set uSettings.bivSignatureAuthorCurrentDate = rbGitAuthorDateNow
					Set uSettings.bivSignatureAuthorCode = rbGitAuthorUseCode
					Set uSettings.bivSignatureAuthorOverrule = cbGitGlobalAuthorOverrule
					Set uSettings.sivSignatureAuthorName = dfGitGlobalAuthorName
					Set uSettings.sivSignatureAuthorEmail = dfGitGlobalAuthorEmail
					!
					! Committer settings
					Set uSettings.bivSignatureCommitterCurrentDate = rbGitCommitterDateNow
					Set uSettings.bivSignatureCommitterCode = rbGitCommitterUseCode
					Set uSettings.bivSignatureCommitterOverrule = cbGitGlobalCommitterOverrule
					Set uSettings.sivSignatureCommitterName = dfGitGlobalCommitterName
					Set uSettings.sivSignatureCommitterEmail = dfGitGlobalCommitterEmail
					!
					! Template settings
					Set uSettings.sivGitAttributesTemplate = cmbGitAttributesTemplate
					Set uSettings.sivGitIgnoreTemplate = cmbGitIgnoreTemplate
					Set uSettings.sivMessageTextTemplate = cmbGitMessageTemplate
					!
					! Misc settings
					Set uSettings.sivBranchName = dfGitBranchName
					Set uSettings.bivPauseOnInit = cbPauseAfterInit
					Set uSettings.nivIntervalMode = cmbCommitInterval.GetValue(  )
					Set uSettings.nivIntervalValue = dfCommitInterval
					Call ManageGUI(  )
			Function: Snapshot
				Description: void Snapshot( )
						Starts creating snapshot of the selected TOM projects.
						A snapshot does not create GIT repo. It only extracts the files to the workfolder.
						
						No Parameters
						No Return value
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If guRepo.ValidateExport( FALSE )
						If SalModalDialog( dlgSnapshotDefinition, hWndForm, TRUE )
							Call ManageYield( TRUE )
							Call guRepo.CreateSnapshot( )
							Call ManageYield( FALSE )
			Function: ExportToGit
				Description: void ExportToGit( )
						Start exporting all selected projects to GIT
						
						No Parameters
						No Return value
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If guRepo.ValidateExport( TRUE )
						If SalModalDialog( dlgSnapshotDefinition, hWndForm, FALSE )
							Call ManageYield( TRUE )
							Call guRepo.ExportTomRepoToGit(  )
							Call ManageYield( FALSE )
			Function: ResetAllTables
				Description: void ResetAllTables( )
						One function to reset/clear all tables in the GUI.
						
						No Parameters
						No Return value
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call tblRepository.ForceReset(  )
					Call tblProjectModules.ForceReset(  )
					Call tblProjectRevisions.ForceReset(  )
					Call tblRepoRevisions.ForceReset(  )
					Call tblTeamMembers.ForceReset(  )
					Call ManageGUI(  )
			Function: DisplayRevisionInfo
				Description: void DisplayRevisionInfo( pbCreate, puRevision )
						Displays detail information of the revision in a separate form.
						The form is updated when selecting revisions from the revision tables while it is open.
						
						Parameter	Type			Description
						pbCreate		Boolean			TRUE will create the revision info form when not open yet. FALSE will only display the info when the form is already open.
						puRevision	cfcTMProjectModuleRevision	The revision to display
						
						No Return value
				Returns
				Parameters
					Boolean: pbCreate
					FunctionalVar: puRevision
						Class: cfcTMProjectModuleRevision
				Static Variables
				Local variables
				Actions
					! This is a trick to be able to update the form while changing the revision object when it is open
					! A single object seems not to contain the correct data when passed as param to the form.
					! But an array of objects works. So place the revision as first object in the array and pass the array to the form.
					Set wuRevisionInfoArr[0] = puRevision
					!
					If whWndRevInfo
						! If info window is already open, send message to form to update the info
						Call SalSendMsg( whWndRevInfo, PAM_DisplayRevInfo, 0, 0 )
					Else If pbCreate
						! Create the form and pass the array containing the revision object to display
						Call SalCreateWindow( frmRevisionInfo, hWndForm, whWndRevInfo, wuRevisionInfoArr )
						Call SalBringWindowToTop( hWndForm )
			Function: ExtractRevision
				Description: void ExtractRevision( puProject, puRevision )
						Extracts selected revision (in table project/repo revisions to a file.
						
						Parameter	Type			Description
						puProject		cfcTMProject		Project where revision resides in
						puRevision	cfcTMProjectModuleRevision	The revision to extract
						
						No Return value
				Returns
				Parameters
					FunctionalVar: puProject
						Class: cfcTMProject
					FunctionalVar: puRevision
						Class: cfcTMProjectModuleRevision
				Static Variables
				Local variables
					String: sFile
					String: sErrorMsg
					Boolean: bOk
				Actions
					Set sFile = puRevision.sivFileName
					If wuShellDlg.DlgBrowseNewFile( hWndForm, sFile )
						Call SalWaitCursor( TRUE )
						Call guGlobals.TraceStart( )
						Call guGlobals.Trace( EVENT_INFORMATION, "(ExtractRevision) Start single extraction from TOM for revision " || SalNumberToStrX( puRevision.nivRevisionNo, 0 ) || " of file " || puRevision.sivFileName || " to " || sFile )
						Set bOk = puProject.ExtractRevision( puRevision, sFile, sErrorMsg )
						Call SalWaitCursor( FALSE )
						If bOk
							Call SalMessageBox( "Revision extracted to:
									
									" || sFile, "Extract OK", MB_Ok | MB_IconInformation )
							Call guGlobals.Trace( EVENT_INFORMATION, "(ExtractRevision) Single extraction OK" )
						Else
							Call SalMessageBox( "Revision extract FAILED:" || scNEWLINE || scNEWLINE || sErrorMsg, "Extract ERROR", MB_Ok | MB_IconExclamation )
							Call guGlobals.Trace( EVENT_ERROR, "(ExtractRevision) Single extraction FAILED" )
						Call guGlobals.TraceStop( )
			Function: Test
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					FunctionalVar: uGit
						Class: cfcLibGit2TDExt
					Number: nError
					Number: nRepoPtr
					String: sPath
				Actions
					! If TRUE		! TDAppTools
						Call PALTDAppTools_Start( hWndNULL, FALSE )
					Call uGit.GIT_libgit2_init( nError )
					If uGit.GIT_repository_discover( "C:\\TEMP\\DELTA2\\DELTA2", sPath, nError )
						If 1
					If uGit.GIT_repository_open( sPath, nRepoPtr, nError )
						If 1
					If 1
		Window Parameters
		Window Variables
			FunctionalVar: wuShellDlg
				Class: cfcDMShellDlg
			Window Handle: whWndRevInfo
			Window Handle: whWndMenuParent
			FunctionalVar: wuRevisionInfoArr[*]		! Trick to get live reference between forms
				Class: cfcTMProjectModuleRevision
		Message Actions
			On SAM_Create
				Call SalHideWindow( hWndForm )
				Call SalWaitCursor( TRUE )
				Call Init( )
			On SAM_CreateComplete
				Call ResetAllTables(  )
				Call SalSetFocus( pbConnectTOM )
				Call SalShowWindow( hWndForm )
				Call SalWaitCursor( FALSE )
			On SAM_Close
				If guGlobals.ActionIsOngoing(  )
					Return FALSE
				Call guGlobals.Disconnect(  )
				Call guGlobals.uivSettings.SaveSettings(  )
			On SAM_Destroy
				Call guGlobals.Disconnect(  )
	Dialog Box: dlgLogin
		Class:
		Property Template:
		Class DLL Name:
		Title: TOM login
		Accessories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Allow Dock to Parent? No
			Docking Orientation: All
			Window Location and Size
				Left: 3.6"
				Top: 2.188"
				Width:  4.143"
				Width Editable? Yes
				Height: 1.88"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
			Resizable? No
			Vertical Scroll? Yes
			Horizontal Scroll? Yes
			Allow Child Docking? No
		XAML Style:
		Background Brush:
		Anchoring Enabled? No
		Vertical Anchor: Top
		Horizontal Anchor: Left
		Minimum Width: Default
		Minimum Height: Default
		Anchor Maximum Width: Default
		Anchor Maximum Height: Default
		Description: Login screen to connect TOM database
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? No
				Size: Default
				Size Editable? Yes
				Docking Toolbar? No
				Toolbar Docking Orientation: Top | Bottom
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Resizable? No
			XAML Style:
			Background Brush:
			Anchoring Enabled? No
			Minimum Width: Default
			Minimum Height: Default
			Anchor Maximum Width: Default
			Anchor Maximum Height: Default
			Contents
		Contents
			Background Text: bkgdDatabase
				Resource Id: 10378
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.614"
					Top: 0.213"
					Width:  1.083"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Title: Database:
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
			Data Field: dfDatabase
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left: 1.8"
						Top: 0.176"
						Width:  1.917"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Uppercase
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				ToolTip:
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Spell Check? No
				Hint Text:
				IME Mode: Auto
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_AnyEdit
						Call ManageGui( )
			Background Text: bkgdTomUser
				Resource Id: 51746
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.629"
					Top: 0.5"
					Width:  1.083"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Title: TOM user:
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
			Data Field: dfUser
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left: 1.8"
						Top: 0.472"
						Width:  1.917"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Uppercase
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				ToolTip:
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Spell Check? No
				Hint Text:
				IME Mode: Auto
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_AnyEdit
						Call ManageGui( )
			Background Text: bkgdTomPassword
				Resource Id: 51747
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.171"
					Top: 0.787"
					Width:  1.55"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Title: TOM password:
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
			Data Field: dfPassword
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left: 1.8"
						Top: 0.769"
						Width:  1.917"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				ToolTip:
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Spell Check? No
				Hint Text:
				IME Mode: Auto
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On VTM_Create
						Call VisWinSetStyle( hWndItem, ES_PASSWORD, TRUE )
					On SAM_AnyEdit
						Call ManageGui( )
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: OK
				Window Location and Size
					Left: 1.129"
					Top: 1.148"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.292"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Button Appearance: Standard
				ToolTip:
				Image Alignment: Default
				Text Alignment: Default
				Text Image Relation: Default
				XAML Style:
				Background Brush:
				Text Brush:
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call Login(  )
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Annuleren
				Window Location and Size
					Left: 2.514"
					Top: 1.148"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.292"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Button Appearance: Standard
				ToolTip:
				Image Alignment: Default
				Text Alignment: Default
				Text Image Relation: Default
				XAML Style:
				Background Brush:
				Text Brush:
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call SalEndDialog( hWndForm, FALSE )
		Background Threads:
		Functions
			Function: Init
				Description: void Init( )
						Get user/database settings and populate
						
						No Parameters
						No Return value
				Returns
				Parameters
				Static Variables
				Local variables
					FunctionalVar: uSettings
						Class: cfcTMSettings
				Actions
					Call guGlobals.GetSettings( uSettings )
					!
					Set dfUser = uSettings.sivUser
					Set dfDatabase = uSettings.sivDatabase
					Set dfPassword= uSettings.sivPassword
					!
					Call ManageGui( )
					!
					If NOT dfDatabase
						Call SalSetFocus( dfDatabase )
					Else If NOT dfUser
						Call SalSetFocus( dfUser )
					Else If NOT dfPassword
						Call SalSetFocus( dfPassword )
					Else
						Call SalSetFocus( pbOk )
					Call SalCenterWindow( hWndForm )
					Call SalSetDefButton( pbOk )
			Function: Login
				Description: void Login( )
						Execute login
						
						No Parameters
						No Return value
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalWaitCursor( TRUE )
					Set SqlDatabase = dfDatabase
					Set SqlUser = dfUser
					Set SqlPassword = dfPassword
					!
					Call guGlobals.SetStatusTextSection( SqlDatabase || "/" || SqlUser )
					Call guGlobals.SetStatusTextDetail( "Connecting..." )
					If guGlobals.Connect(  )
						Call guGlobals.SetStatusTextDetail( "Connected OK" )
						Call SaveSettings( )
						Call guGlobals.SetStatusTextFinished(  )
						Call SalWaitCursor( FALSE )
						Call SalEndDialog( hWndForm, TRUE )
					Else
						Call guGlobals.SetStatusTextDetail( "Connect ERROR" )
						Call SalWaitCursor( FALSE )
						Call SalMessageBox( "Login error", "SqlError", MB_Ok | MB_IconExclamation )
			Function: SaveSettings
				Description: void SaveSettings( )
						Saves user/database info to settings
						
						No Parameters
						No Return value
				Returns
				Parameters
				Static Variables
				Local variables
					FunctionalVar: uSettings
						Class: cfcTMSettings
				Actions
					Call guGlobals.GetSettings( uSettings )
					!
					Set uSettings.sivUser = dfUser
					Set uSettings.sivDatabase = dfDatabase
					! Set uSettings.sivPassword = dfPassword
			Function: ManageGui
				Description: void ManageGui( )
						Handles enable/dsiable states of GUI objects.
						
						No Parameters
						No Return value
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If dfDatabase AND dfUser AND dfPassword
						Call SalEnableWindow( pbOk )
					Else
						Call SalDisableWindow( pbOk )
		Window Parameters
		Window Variables
		Message Actions
			On SAM_Create
				Call Init( )
	Dialog Box: dlgMessageBox
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Accessories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Allow Dock to Parent? No
			Docking Orientation: All
			Window Location and Size
				Left: 4.638"
				Top: 1.771"
				Width:  9.15"
				Width Editable? Yes
				Height: 5.19"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
			Resizable? Yes
			Vertical Scroll? Yes
			Horizontal Scroll? Yes
			Allow Child Docking? No
		XAML Style:
		Background Brush:
		Anchoring Enabled? Yes
		Vertical Anchor: Top
		Horizontal Anchor: Left
		Minimum Width: Default
		Minimum Height: Default
		Anchor Maximum Width: Default
		Anchor Maximum Height: Default
		Description: Larger messagebox to hold more text
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Docking Toolbar? No
				Toolbar Docking Orientation: Top | Bottom
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Resizable? No
			XAML Style:
			Background Brush:
			Anchoring Enabled? No
			Minimum Width: Default
			Minimum Height: Default
			Anchor Maximum Width: Default
			Anchor Maximum Height: Default
			Contents
		Contents
			Multiline Field: mlMsg
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 16000
					String Type: String
					Editable? Yes
				Display Settings
					Border? No
					Word Wrap? Yes
					Vertical Scroll? No
					Window Location and Size
						Left: 0.217"
						Top: 0.179"
						Width:  8.367"
						Width Editable? Yes
						Height: 4.333"
						Height Editable? Yes
					Visible? Yes
					Font Name: Segoe UI Semibold
					Font Size: 9
					Font Enhancement: None
					Text Color: Default
					Background Color: Default
				ToolTip:
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Spell Check? No
				Hint Text:
				IME Mode: Auto
				Vertical Anchor: Both
				Horizontal Anchor: Both
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Create
						Call VisWinSetFlags( hWndItem, WF_DisplayOnly, TRUE )
						Call SalColorSet( hWndItem, COLOR_IndexWindow, SalColorGet( hWndForm, COLOR_IndexWindow ) )
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: OK
				Window Location and Size
					Left: 7.383"
					Top: 4.583"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Button Appearance: Standard
				ToolTip:
				Image Alignment: Default
				Text Alignment: Default
				Text Image Relation: Default
				XAML Style:
				Background Brush:
				Text Brush:
				Vertical Anchor: Bottom
				Horizontal Anchor: Right
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call SalEndDialog( hWndForm, 0 )
		Background Threads:
		Functions
		Window Parameters
			String: wpsTitle
			String: wpsMessage
		Window Variables
		Message Actions
			On SAM_Create
				Call SalCenterWindow( hWndForm )
				Call SalSetWindowText( hWndForm, wpsTitle )
				Set mlMsg = wpsMessage
				Call SalSetFocus( pbOk )
	Dialog Box: dlgSnapshotDefinition
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Accessories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Allow Dock to Parent? No
			Docking Orientation: All
			Window Location and Size
				Left: 3.913"
				Top: 1.198"
				Width:  11.95"
				Width Editable? Yes
				Height: 4.143"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
			Resizable? No
			Vertical Scroll? Yes
			Horizontal Scroll? Yes
			Allow Child Docking? No
		XAML Style:
		Background Brush:
		Anchoring Enabled? No
		Vertical Anchor: Top
		Horizontal Anchor: Left
		Minimum Width: Default
		Minimum Height: Default
		Anchor Maximum Width: Default
		Anchor Maximum Height: Default
		Description: Define snapshot settings
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Docking Toolbar? No
				Toolbar Docking Orientation: Top | Bottom
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Resizable? No
			XAML Style:
			Background Brush:
			Anchoring Enabled? No
			Minimum Width: Default
			Minimum Height: Default
			Anchor Maximum Width: Default
			Anchor Maximum Height: Default
			Contents
		Contents
			Pushbutton: pbAllToLatest
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: All to latest
				Window Location and Size
					Left: 0.183"
					Top: 0.071"
					Width:  1.6"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Button Appearance: Standard
				ToolTip:
				Image Alignment: Default
				Text Alignment: Default
				Text Image Relation: Default
				XAML Style:
				Background Brush:
				Text Brush:
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call tblRepository.SetAllToLatest( )
			Child Table: tblRepository
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left: 0.183"
						Top: 0.381"
						Width:  11.483"
						Width Editable? Yes
						Height: 3.071"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
					Hide Column Headers? No
					Hide Row Headers? No
				Memory Settings
					Maximum Rows in Memory: 16000
					Discardable? No
				XAML Style:
				Summary Bar Enabled? No
				Background Brush:
				Text Brush:
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Contents
					Column: colProjectCode
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Projectcode
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.283"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colProjectName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Projectname
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  2.6"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colProjectSnapshotDef
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Snapshot definition
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  1.983"
						Width Editable? Yes
						Format: yyyy-MM-dd hh:mm:ss
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					Column: colSnapshotMoment
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Snapshot moment
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  2.633"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Drop Down List
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? No
								Auto Drop Down? No
								Allow Text Editing? No
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
							On SAM_Click
								Call OnSnapshotMomentSelect( )
							On SAM_AnyEdit
								Call OnSnapshotMomentSelect( )
					Column: colUseSnapshotDate
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Effective snapshot
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  2.433"
						Width Editable? Yes
						Format: yyyy-MM-dd hh:mm:ss
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
					!
					Column: colIndex
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: INDEX
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						ToolTip:
						Column Aggregate Type: None
						Flow Direction: Default
						Allow Text Filter: No
						IME Mode: Auto
						Always Show Drop Button? No
						List Values
						Message Actions
				Functions
					Function: PopulateSnapshotMoments
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							Number: nCount
						Actions
							If NOT wpbSnapshotMode
								Call AddMomentString( -3, "All revisions" )
							Call AddMomentString( -2, "Latest revision" )
							Set nCount = 0
							While nCount < guRepo.nivTotalProjects
								If guRepo.uaivProject[nCount].bivIsSelected AND guRepo.uaivProject[nCount].nivTotalRevisions > 0
									Call AddMomentString( nCount, "Project: " || guRepo.uaivProject[nCount].sivProjectCode )
								Set nCount = nCount + 1
					Function: Populate
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							Number: nCount
							Number: nRow
							FunctionalVar: uRevision
								Class: cfcTMProjectModuleRevision
						Actions
							Set wnSelectedProjectIndex = -1
							Call guGlobals.SetStatusTextDetail( "Populating projects..." )
							Call SalTblReset( hWndForm )
							Set nCount = 0
							While nCount < guRepo.nivTotalProjects
								If guRepo.uaivProject[nCount].bivIsSelected AND guRepo.uaivProject[nCount].nivTotalRevisions > 0
									Set nRow = SalTblInsertRow( hWndForm, TBL_MaxRow )
									Call SalTblSetContext( hWndForm, nRow )
									Set colIndex = nCount
									Set colProjectCode = guRepo.uaivProject[nCount].sivProjectCode
									Set colProjectName = guRepo.uaivProject[nCount].sivProjectName
									Set colProjectSnapshotDef = guRepo.uaivProject[nCount].dtivStartDateCommits
									If guRepo.uaivProject[nCount].dtivStartDateCommits
										Set colSnapshotMoment = GetMomentStringByID( nCount )
										Set guRepo.uaivProject[nCount].dtivSnapshotDate = guRepo.uaivProject[nCount].dtivStartDateCommits
									Else
										If wpbSnapshotMode
											Set colSnapshotMoment = GetMomentStringByID( -2 )
											Call guRepo.uaivProject[nCount].GetLatestRevision( uRevision )
											Set guRepo.uaivProject[nCount].dtivSnapshotDate = uRevision.dtivRevisionDateTime
										Else
											Set colSnapshotMoment = GetMomentStringByID( -3 )
											Call guRepo.uaivProject[nCount].GetFirstRevision( uRevision )
											Set guRepo.uaivProject[nCount].dtivSnapshotDate = uRevision.dtivRevisionDateTime
											Set guRepo.uaivProject[nCount].bivSnapshotModeEnabled = FALSE
									Set colUseSnapshotDate = guRepo.uaivProject[nCount].dtivSnapshotDate
								Set nCount = nCount + 1
							Call SalTblSortRows( hWndForm, 1, TBL_SortIncreasing )
							Call guGlobals.SetStatusTextFinished( )
					Function: OnSnapshotMomentSelect
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							Number: nMomentID
							FunctionalVar: uRevision
								Class: cfcTMProjectModuleRevision
						Actions
							Set nMomentID = GetMomentIDByString( colSnapshotMoment )
							If nMomentID = -2		! Latest revision
								Call guRepo.uaivProject[colIndex].GetLatestRevision( uRevision )
								Set guRepo.uaivProject[colIndex].dtivSnapshotDate = uRevision.dtivRevisionDateTime
								Set guRepo.uaivProject[colIndex].bivSnapshotModeEnabled = TRUE
							Else If nMomentID = -3	! All revisions
								Call guRepo.uaivProject[colIndex].GetFirstRevision( uRevision )
								Set guRepo.uaivProject[colIndex].dtivSnapshotDate = uRevision.dtivRevisionDateTime
								Set guRepo.uaivProject[colIndex].bivSnapshotModeEnabled = FALSE
							Else If nMomentID > -1
								If colIndex = nMomentID
									If guRepo.uaivProject[colIndex].dtivStartDateCommits
										Set guRepo.uaivProject[colIndex].dtivSnapshotDate = guRepo.uaivProject[colIndex].dtivStartDateCommits
										Set guRepo.uaivProject[colIndex].bivSnapshotModeEnabled = TRUE
									Else
										If wpbSnapshotMode
											Call guRepo.uaivProject[colIndex].GetLatestRevision( uRevision )
											Set guRepo.uaivProject[colIndex].dtivSnapshotDate = uRevision.dtivRevisionDateTime
										Else
											Call guRepo.uaivProject[colIndex].GetFirstRevision( uRevision )
											Set guRepo.uaivProject[colIndex].dtivSnapshotDate = uRevision.dtivRevisionDateTime
											Set guRepo.uaivProject[colIndex].bivSnapshotModeEnabled = FALSE
								Else
									Set guRepo.uaivProject[colIndex].dtivSnapshotDate = guRepo.uaivProject[nMomentID].dtivSnapshotDate
									Set guRepo.uaivProject[colIndex].bivSnapshotModeEnabled = TRUE
							Call UpdateSnapshotDates( )
					Function: SetAllToLatest
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							Number: nCurrentContext
							Number: nCount
							FunctionalVar: uRevision
								Class: cfcTMProjectModuleRevision
							String: sMomentStr
						Actions
							Set nCurrentContext = SalTblQueryContext( hWndForm )
							Set sMomentStr = GetMomentStringByID( -2 )
							Set nCount = 0
							While SalTblSetContext( hWndForm, nCount )
								Call guRepo.uaivProject[colIndex].GetLatestRevision( uRevision )
								Set guRepo.uaivProject[colIndex].dtivSnapshotDate = uRevision.dtivRevisionDateTime
								Set guRepo.uaivProject[colIndex].bivSnapshotModeEnabled = TRUE
								Set colSnapshotMoment = sMomentStr
								Set colUseSnapshotDate = uRevision.dtivRevisionDateTime
								Set nCount = nCount + 1
							Call SalTblSetContext( hWndForm, nCurrentContext )
					Function: UpdateSnapshotDates
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							Number: nCount
							Number: nCurrentContext
						Actions
							Set nCurrentContext = SalTblQueryContext( hWndForm )
							Set nCount = 0
							While SalTblSetContext( hWndForm, nCount )
								Set colUseSnapshotDate = guRepo.uaivProject[colIndex].dtivSnapshotDate
								Set nCount = nCount + 1
							Call SalTblSetContext( hWndForm, nCurrentContext )
							Call SalInvalidateWindow( hWndForm )
							Call SalUpdateWindow( hWndForm )
					Function: GetMomentStringByID
						Description:
						Returns
							String:
						Parameters
							Number: pnMomentID
						Static Variables
						Local variables
							Number: nIndex
						Actions
							Set nIndex = VisArrayFindNumber( wnaMomentID, pnMomentID )
							If nIndex > -1
								Return wsaMomentString[nIndex]
							Else
								Return ""
					Function: GetMomentIDByString
						Description:
						Returns
							Number:
						Parameters
							String: psString
						Static Variables
						Local variables
							Number: nIndex
						Actions
							Set nIndex = VisArrayFindString( wsaMomentString, psString )
							If nIndex > -1
								Return wnaMomentID[nIndex]
							Else
								Return -1
					Function: AddMomentString
						Description:
						Returns
						Parameters
							Number: pnID
							String: psString
						Static Variables
						Local variables
						Actions
							Set wnaMomentID[wnTotalMoments] = pnID
							Set wsaMomentString[wnTotalMoments] = psString
							Set wnTotalMoments = wnTotalMoments+ 1
							Call SalListAdd( colSnapshotMoment, psString )
				Window Variables
					Boolean: wbProjectSelected
					Number: wnSelectedProjectIndex
					String: wsaMomentString[*]
					Number: wnaMomentID[*]
					Number: wnTotalMoments
				Message Actions
					On SAM_Create
						Call SalTblDefineRowHeader( hWndForm, '', 0, 0, hWndNULL )
						Call SalTblSetTableFlags( hWndForm, TBL_Flag_MovableCols , FALSE )
					On SAM_Click
						Set wnSelectedProjectIndex = colIndex
			Check Box: cbDryRun
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Dry run
				Window Location and Size
					Left: 7.25"
					Top: 3.631"
					Width:  1.233"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				ToolTip:
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Set guGlobals.bivDryRun = MyValue
			Pushbutton: pbStart
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Create snapshot
				Window Location and Size
					Left: 8.6"
					Top: 3.607"
					Width:  1.717"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Button Appearance: Standard
				ToolTip:
				Image Alignment: Default
				Text Alignment: Default
				Text Image Relation: Default
				XAML Style:
				Background Brush:
				Text Brush:
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call SalEndDialog( hWndForm, TRUE )
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Cancel
				Window Location and Size
					Left: 10.467"
					Top: 3.607"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Button Appearance: Standard
				ToolTip:
				Image Alignment: Default
				Text Alignment: Default
				Text Image Relation: Default
				XAML Style:
				Background Brush:
				Text Brush:
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Click
						Call SalEndDialog( hWndForm, FALSE )
		Background Threads:
		Functions
			Function: Init
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalCenterWindow( hWndForm )
					Set guGlobals.bivDryRun = FALSE
					Set cbDryRun = guGlobals.bivDryRun
					Call tblRepository.PopulateSnapshotMoments( )
					Call tblRepository.Populate(  )
					If wpbSnapshotMode
						Call SalSetWindowText( hWndForm, "Snapshot settings" )
						Call SalSetWindowText( pbStart, "Create snapshot" )
						Call SalHideWindow( cbDryRun )
					Else
						Call SalSetWindowText( hWndForm, "Commit history snapshot settings" )
						Call SalSetWindowText( pbStart, "Start export" )
		Window Parameters
			Boolean: wpbSnapshotMode
		Window Variables
		Message Actions
			On SAM_Create
				Call Init( )
	Dialog Box: frmRevisionInfo
		Class:
		Property Template:
		Class DLL Name:
		Title: Revision Info
		Accessories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modeless
			Allow Dock to Parent? No
			Docking Orientation: All
			Window Location and Size
				Left: 6.725"
				Top: 1.979"
				Width:  9.15"
				Width Editable? Yes
				Height: 3.964"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
			Resizable? No
			Vertical Scroll? Yes
			Horizontal Scroll? Yes
			Allow Child Docking? No
		XAML Style:
		Background Brush:
		Anchoring Enabled? No
		Vertical Anchor: Top
		Horizontal Anchor: Left
		Minimum Width: Default
		Minimum Height: Default
		Anchor Maximum Width: Default
		Anchor Maximum Height: Default
		Description: Form to show extra details on revision.
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Docking Toolbar? No
				Toolbar Docking Orientation: Top | Bottom
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Resizable? No
			XAML Style:
			Background Brush:
			Anchoring Enabled? No
			Minimum Width: Default
			Minimum Height: Default
			Anchor Maximum Width: Default
			Anchor Maximum Height: Default
			Contents
		Contents
			Background Text: bkgdModule
				Resource Id: 37065
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 2.667"
					Top: 0.179"
					Width:  1.1"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Title: Module ID
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
			Data Field: dfModuleID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left: 3.867"
						Top: 0.143"
						Width:  1.033"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				ToolTip:
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Spell Check? No
				Hint Text:
				IME Mode: Auto
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
			Background Text: bkgdRevision
				Resource Id: 37066
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.367"
					Top: 0.179"
					Width:  1.1"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Title: Revision nr
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
			Data Field: dfRevision
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left: 1.567"
						Top: 0.143"
						Width:  1.033"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				ToolTip:
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Spell Check? No
				Hint Text:
				IME Mode: Auto
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
			Background Text: bkgdSource
				Resource Id: 42803
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 5.0"
					Top: 0.179"
					Width:  1.05"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Title: Source ID
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
			Data Field: dfSourceID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left: 6.15"
						Top: 0.143"
						Width:  1.033"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				ToolTip:
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Spell Check? No
				Hint Text:
				IME Mode: Auto
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
			Background Text: bkgdFileName
				Resource Id: 42805
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.167"
					Top: 0.869"
					Width:  1.3"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Title: File name
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
			Data Field: dfFileName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left: 1.567"
						Top: 0.833"
						Width:  7.25"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				ToolTip:
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Spell Check? No
				Hint Text:
				IME Mode: Auto
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
			Background Text: bkgdRevDateTime
				Resource Id: 42804
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.133"
					Top: 0.536"
					Width:  1.333"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Title: Rev. date/time
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
			Data Field: dfRevisionDateTime
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left: 1.567"
						Top: 0.488"
						Width:  2.683"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				ToolTip:
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Spell Check? No
				Hint Text:
				IME Mode: Auto
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
			Background Text: bkgdFileDateTime
				Resource Id: 42806
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 4.733"
					Top: 0.536"
					Width:  1.3"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Title: File date/time
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
			Data Field: dfFileDateTime
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left: 6.15"
						Top: 0.488"
						Width:  2.667"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				ToolTip:
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Spell Check? No
				Hint Text:
				IME Mode: Auto
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
			Background Text: bkgdLabel
				Resource Id: 37067
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.367"
					Top: 1.214"
					Width:  1.1"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Title: Label
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
			Data Field: dfLabel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left: 1.567"
						Top: 1.167"
						Width:  7.25"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				ToolTip:
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Spell Check? No
				Hint Text:
				IME Mode: Auto
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
			Background Text: bkgdDescription
				Resource Id: 37068
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left: 0.367"
					Top: 1.536"
					Width:  1.1"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Title: Description
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
			Multiline Field: mlDescription
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 2048
					String Type: String
					Editable? No
				Display Settings
					Border? Yes
					Word Wrap? Yes
					Vertical Scroll? Yes
					Window Location and Size
						Left: 1.567"
						Top: 1.512"
						Width:  7.267"
						Width Editable? Yes
						Height: 1.94"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				ToolTip:
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Spell Check? No
				Hint Text:
				IME Mode: Auto
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
			Check Box: cbIsDelta
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Is delta
				Window Location and Size
					Left: 1.6"
					Top: 3.548"
					Width:  1.183"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				ToolTip:
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Create
						Call VisWinSetFlags( hWndItem, WF_DisplayOnly, TRUE )
			Check Box: cbIsCompressed
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Is compressed
				Window Location and Size
					Left: 2.9"
					Top: 3.548"
					Width:  1.9"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				ToolTip:
				XAML Style:
				Background Brush:
				Text Brush:
				Flow Direction: Default
				Vertical Anchor: Top
				Horizontal Anchor: Left
				Minimum Width: Default
				Minimum Height: Default
				Message Actions
					On SAM_Create
						Call VisWinSetFlags( hWndItem, WF_DisplayOnly, TRUE )
		Background Threads:
		Functions
			Function: Populate
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set dfModuleID = wpuRevision[0].nivModuleID
					Set dfSourceID = wpuRevision[0].nivSourceID
					Set dfRevision = wpuRevision[0].nivRevisionNo
					Set dfFileName = wpuRevision[0].sivFileName
					Call SalDateToStr( wpuRevision[0].dtivRevisionDateTime, dfRevisionDateTime )
					Call SalDateToStr( wpuRevision[0].dtivSourceDateTime, dfFileDateTime )
					Set mlDescription = wpuRevision[0].sivDescription
					Set dfLabel = wpuRevision[0].sivRevisionLabel
					Set cbIsDelta = wpuRevision[0].bivIsDelta
					Set cbIsCompressed = wpuRevision[0].bivIsCompressed
		Window Parameters
			Receive Window Handle: rwhWndRevInfo
			FunctionalVar: wpuRevision[*]
				Class: cfcTMProjectModuleRevision
		Window Variables
		Message Actions
			On SAM_Create
				Set rwhWndRevInfo = hWndForm
				Call Populate( )
			On SAM_Destroy
				Set rwhWndRevInfo = hWndNULL
			On PAM_DisplayRevInfo
				Call Populate( )
